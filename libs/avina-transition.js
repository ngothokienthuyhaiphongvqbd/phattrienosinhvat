!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.avt=e():t.avt=e()}(this,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function i(t){return document.createElement(t)}function n(t,e){var n=i("canvas");return n.width=t,n.height=e,n}function r(t,e){var n=i("div");return o(n,t,e),n}function a(t,e){var i=t.getContext("2d");return i&&i.drawImage(e,0,0),i}function s(t,e,i){t.style[e]=i}function o(t,e,i){s(t,"width",e+"px"),s(t,"height",i+"px")}function h(t,e,i){s(t,"left",e+"px"),s(t,"top",i+"px")}function c(t,e){t&&s(t,"opacity",e)}function u(t,e){s(t,"perspective",e)}function l(t,e){s(t,"perspectiveOrigin",e)}function d(t,e){s(t,"backfaceVisibility",e)}function v(t,e){s(t,"transformOrigin",e)}function x(t,e){s(t,"transformStyle",e)}function f(t,e){s(t,"transform",e)}function g(t,e){t.appendChild(e)}function p(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function m(t){return document.getElementById(t)}t.r(e),t.d(e,{Kx:()=>nt,Mx:()=>it,Window:()=>an,_base64ToArrayBuffer:()=>rt,addElements:()=>Q,addElementsArray2:()=>j,addMatrixItem:()=>R,airplane:()=>ut,appendChild:()=>g,blinds:()=>vt,box:()=>pt,bufferContainer:()=>I,checkerboard:()=>St,clock:()=>Mt,comb:()=>Lt,conveyor:()=>Vt,cover:()=>Ht,createArray2:()=>J,createArray3:()=>K,createCanvas:()=>n,createDiv:()=>r,createElement:()=>i,createFloat32Array3:()=>Z,createFloat32ArrayBuffer:()=>T,createIndexArray:()=>B,createMatrixContainer:()=>_,createMatrixContainer2:()=>O,createUint16Buffer:()=>A,crush:()=>gn,cube:()=>Jt,curtains:()=>re,cut:()=>ae,cutThroughBack:()=>sn,deleteBuffer:()=>P,disableVertexAttribArray:()=>b,dissolve:()=>se,door:()=>he,drape:()=>le,drawImage:()=>a,easeFunction:()=>z,easeInCirc:()=>U,easeInCubic:()=>X,easeInFunction:()=>k,easeInOutQuad:()=>W,fade:()=>de,fallOver:()=>ve,ferrisWheel:()=>xe,flash:()=>ge,flip:()=>pe,flyThrough:()=>Te,fracture:()=>Ae,gallery:()=>Ot,getArrayFromNormal:()=>D,getArrayFromPosition:()=>F,getArrayFromTexture:()=>G,getArrayTransform:()=>et,getAttribLocation:()=>C,getElementById:()=>m,getMatrixItem:()=>N,getUniformLocation:()=>S,glitter:()=>be,honeycomb:()=>qe,matrixContainer:()=>E,matrixItem:()=>L,newsflash:()=>fn,orbit:()=>nn,origami:()=>ci,pageCurl:()=>Ti,pan:()=>en,peelOff:()=>Ai,point2D:()=>M,point3D:()=>y,popMatrix:()=>st,prestige:()=>Ii,push:()=>Pi,pushMatrix:()=>at,randombars:()=>Ei,removeChild:()=>p,reveal:()=>hn,ripple:()=>Di,rotate:()=>rn,scaleArrays:()=>tt,setBackfaceVisibility:()=>d,setOpacity:()=>c,setPerspective:()=>u,setPerspectiveOrigin:()=>l,setPosition:()=>h,setSize:()=>o,setStyleProperty:()=>s,setTransform:()=>f,setTransformOrigin:()=>v,setTransformStyle:()=>x,shaderTransition:()=>ct,shapeCircle:()=>Vi,shapeDiamon:()=>Hi,shapePlus:()=>ki,shred:()=>Xi,split:()=>Ui,squareArrays:()=>$,subtractionArrays:()=>q,transformPMVMatrix:()=>ot,transition:()=>w,transitionController:()=>on,translateWidthTime:()=>H,ty:()=>V,uy:()=>Y,vortex:()=>Ji,wind:()=>Pn,zoom:()=>me});class w{canvasSource;divContainer;currentImage;preImage;isRevert=!1;constructor(t,e,i,r){i||(i=this.createBlack(e.width,e.height)),e||(e=this.createBlack(i.width,i.height)),this.divContainer=t,this.currentImage=e,this.preImage=i,this.revert=r,this.canvasSource=n(e.width,e.height)}initialize(){}drawBackground(){}setProgress(t){}completed(){}checkUsingTwoSlides(){return!!this.preImage}checkRevert(t){return this.revert?1-t:t}createBlack(t,e){let i=n(t,e),r=i.getContext("2d");return r.fillStyle="black",r.fillRect(0,0,t,e),i}}function C(t,e,i){var n=t.getAttribLocation(e,i);return n<0||t.enableVertexAttribArray(n),n}function S(t,e,i){return t.getUniformLocation(e,i)}function T(t,e,i){var n=t.createBuffer(),r=e.length/i;return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.DYNAMIC_DRAW),n.length=r,n.size=i,n}function A(t,e){var i=t.createBuffer(),n=e.length/1;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),t.DYNAMIC_DRAW),i.length=n,i.size=1,i}class I{vertexPosition;textureCoord;vertexNormal;elementIndecies;constructor(){this.vertexPosition=this.vertexNormal=this.textureCoord=this.elementIndecies=null}}function P(t,e){t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(e.vertexPosition),t.deleteBuffer(e.textureCoord),t.deleteBuffer(e.textureCoord),t.deleteBuffer(e.elementIndecies)}function b(t,e){t.disableVertexAttribArray(e)}class M{x=0;y=0;constructor(t,e){this.x=t,this.y=e}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}clone(){return new M(this.x,this.y)}}class y{x=0;y=0;z=0;constructor(t,e,i){this.x=t,this.y=e,this.z=i}add(t){return new y(this.x+t.x,this.y+t.y,this.z+t.z)}remove(t){return new y(this.x-t.x,this.y-t.y,this.z-t.z)}scale(t){return new y(this.x*t,this.y*t,this.z*t)}clone(){return new y(this.x,this.y,this.z)}normalize(){var t=1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);this.x*=t,this.y*=t,this.z*=t}set X(t){this.x=t}set Y(t){this.y=t}set Z(t){this.z=t}}class L{normal;position;texture;constructor(t,e,i){i||(i=new y(0,0,1)),this.position=t.clone(),this.texture=e.clone(),this.normal=i.clone()}setPosition(t){this.position=t.clone()}setNormal(t){this.normal=t.clone()}clone(){return new L(this.position,this.texture,this.normal)}}class E{container=[];length(){return this.container.length}}function R(t,e){t.container.push(e)}function N(t,e){return t.container[e]}function F(t){for(var e=[],i=0;i<t.container.length;i++){var n=t.container[i];e.push(n.position.x),e.push(n.position.y),e.push(n.position.z)}return e}function D(t){for(var e=[],i=0;i<t.container.length;i++){var n=t.container[i];e.push(n.normal.x),e.push(n.normal.y),e.push(n.normal.z)}return e}function G(t){for(var e=[],i=0;i<t.container.length;i++){var n=t.container[i];e.push(n.texture.x),e.push(n.texture.y)}return e}function _(t,e,i,n){for(var r=i/(e-1),a=n/(t-1),s=new E,o=new y(0,0,1),h=0;h<t;++h)for(var c=0;c<e;++c){R(s,new L(new y(c*r,-h*a,0),new M(c/(e-1),h/(t-1)),o))}return s}function O(t,e,i,n){for(var r=t/60,a=e/14,s=new E,o=new y(0,0,1),h=0;h<15;++h)for(var c=i;c<n;++c){R(s,new L(new y(c*r,-h*a,0),new M(c/60,h/14),o))}return s}function B(t,e){for(var i=[],n=0;n<t-1;++n)for(var r=0;r<e;++r)i.push(r+n*e),i.push(r+(n+1)*e),r==e-1&&n!=t-2&&(i.push(r+(n+1)*e),i.push((n+1)*e));return i}function z(t,e){return function(i){if(0!=t||1!=e){for(var n=i,r=0;4>r;++r){var a=3*(1-3*e+3*t)*n*n+2*(3*e-6*t)*n+3*t;if(0==a)break;n-=((((1-3*e+3*t)*n+(3*e-6*t))*n+3*t)*n-i)/a}i=n,i*=(-2*i+3)*i}return i}}var V=z(.42,.58);function H(t,e,i,n){return function(r){return e+(n-e)/(i-t)*(r-t)}}function k(t,e,i){return i<t?0:i>=e?1:(t=(i-t)/(e-t),-2*Math.pow(t,3)+3*Math.pow(t,2))}function X(t){return t*t*t}function W(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}function U(t){return 1-Math.sqrt(1-Math.pow(t,2))}function Y(t,e,i,n){return n<e?t+n/e*(1-t):(n-=e,1+(1-t)/(2*Math.PI/(1-e))/e*Math.exp(-i*n)*Math.sin(2*Math.PI/(1-e)*n))}function Z(){return new Float32Array(3)}function K(){var t=Array(3);return Q(t,0,0,0),t}function Q(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}function J(){var t=Array(2);return j(t,0,0),t}function j(t,e,i){t[0]=e,t[1]=i}function q(t,e,i){i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2]}function $(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function tt(t,e){var i=K();return i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i}function et(t,e,i){return i[0]=t[1]*e[2]-t[2]*e[1],i[1]=t[2]*e[0]-t[0]*e[2],i[2]=t[0]*e[1]-t[1]*e[0],i}function it(t,e){return e=et(t=Q(Z(),t.x,t.y,t.z),e=Q(Z(),e.x,e.y,e.z),Z()),new y(e[0],e[1],e[2])}function nt(t,e){for(var i=0,n=0;n<e.length/3;n++){var r=N(t,e[i++]),a=r.position,s=N(t,e[i++]),o=s.position,h=N(t,e[i++]),c=h.position;(a=it(o.remove(a),c.remove(a))).normalize(),r.setNormal(a),s.setNormal(a),h.setNormal(a)}}function rt(t){for(var e=window.atob(t),i=e.length,n=new Uint8Array(i),r=0;r<i;r++)n[r]=e.charCodeAt(r);return n}function at(t){var e=mat4.create();mat4.set(t.m4PMVMatrix,e),t.arrayMatrices.push(e)}function st(t){if(0==t.arrayMatrices.length)throw"Invalid popMatrix!";t.m4PMVMatrix=t.arrayMatrices.pop()}function ot(t,e,i,n){mat4.translate(t.m4PMVMatrix,[-n[0],-n[1],-n[2]]),mat4.rotate(t.m4PMVMatrix,e*Math.PI/180,i),mat4.translate(t.m4PMVMatrix,n)}function ht(t,e,i){var n=new y(0,0,0);this.Hq=t,this.gx=e,this.hx=i,this.n=n}class ct extends w{webGLContext;fragmentShader;vertexShader;shaderProgram;aVertexPosition;aTextureCoord;aVertextNormal;m4PMVMatrix;m4NMatrix;uPMVMatrix;uNMatrix;uSampler;uPhase;bufferContainer=new I;arrayMatrices=[];initialize(){}setupContext(){if(this.canvasSource&&(this.webGLContext=this.canvasSource.getContext("webgl")),!this.webGLContext)throw"Cannot get webGLContext";this.webGLContext.width=this.canvasSource.width,this.webGLContext.height=this.canvasSource.height,this.webGLContext.enable(this.webGLContext.DEPTH_TEST)}getFragmentCode(){}getVertexCode(){}setupProgram(){this.setupContext(),this.bufferData(),this.fragmentShader=this.webGLContext.createShader(this.webGLContext.FRAGMENT_SHADER),this.webGLContext.shaderSource(this.fragmentShader,this.getFragmentCode()),this.webGLContext.compileShader(this.fragmentShader);var t=this.webGLContext.getShaderParameter(this.fragmentShader,this.webGLContext.COMPILE_STATUS);if(!t)throw"Cannot compile fragment shader!";if(this.vertexShader=this.webGLContext.createShader(this.webGLContext.VERTEX_SHADER),this.webGLContext.shaderSource(this.vertexShader,this.getVertexCode()),this.webGLContext.compileShader(this.vertexShader),!(t=this.webGLContext.getShaderParameter(this.vertexShader,this.webGLContext.COMPILE_STATUS)))throw"Cannot compile vertex shader!";if(this.shaderProgram=this.webGLContext.createProgram(),this.webGLContext.attachShader(this.shaderProgram,this.vertexShader),this.webGLContext.attachShader(this.shaderProgram,this.fragmentShader),this.webGLContext.linkProgram(this.shaderProgram),!this.webGLContext.getProgramParameter(this.shaderProgram,this.webGLContext.LINK_STATUS))throw"Cannot link program!";this.webGLContext.useProgram(this.shaderProgram),this.getProperties(),this.setupData(),this.divContainer.appendChild(this.canvasSource)}bufferData(){}completed(){super.completed(),P(this.webGLContext,this.bufferContainer),b(this.webGLContext,this.aVertexPosition),b(this.webGLContext,this.aTextureCoord)}createMatrices(){this.m4PMVMatrix=mat4.create(),this.m4NMatrix=mat4.create(),this.webGLContext.viewport(0,0,this.webGLContext.width,this.webGLContext.height),this.webGLContext.clear(this.webGLContext.COLOR_BUFFER_BIT|this.webGLContext.DEPTH_BUFFER_BIT);var t=.5*this.canvasSource.height/Math.tan(22.5*Math.PI/180);mat4.perspective(45,this.webGLContext.width/this.webGLContext.height,1,1e4,this.m4NMatrix),mat4.identity(this.m4PMVMatrix),mat4.translate(this.m4PMVMatrix,[0,0,-t])}setupMatrices(){var t=mat4.create();t=mat4.multiply(this.m4NMatrix,this.m4PMVMatrix,t),this.webGLContext.uniformMatrix4fv(this.uPMVMatrix,!1,t),t=mat3.create(),mat4.toInverseMat3(this.m4PMVMatrix,t),mat3.transpose(t),this.webGLContext.uniformMatrix3fv(this.uNMatrix,!1,t)}getProperties(){this.aVertexPosition=C(this.webGLContext,this.shaderProgram,"aVertexPosition"),this.aTextureCoord=C(this.webGLContext,this.shaderProgram,"aTextureCoord"),this.aVertexNormal=C(this.webGLContext,this.shaderProgram,"aVertexNormal"),this.uPMVMatrix=S(this.webGLContext,this.shaderProgram,"uPMVMatrix"),this.uNMatrix=S(this.webGLContext,this.shaderProgram,"uNMatrix"),this.uSampler=S(this.webGLContext,this.shaderProgram,"uSampler"),this.uPhase=S(this.webGLContext,this.shaderProgram,"uPhase"),this.uSlideWidth=S(this.webGLContext,this.shaderProgram,"uSlideWidth"),this.uSlideHeight=S(this.webGLContext,this.shaderProgram,"uSlideHeight")}setupData(){}drawBackground(t,e,i,r){const a=this.webGLContext.createTexture();this.webGLContext.activeTexture(i||this.webGLContext.TEXTURE0),this.webGLContext.bindTexture(this.webGLContext.TEXTURE_2D,a);var s=n(1024,1024);return s.getContext("2d").drawImage(t||this.currentImage,0,0,1024,1024),this.webGLContext.texImage2D(this.webGLContext.TEXTURE_2D,0,this.webGLContext.RGBA,this.webGLContext.RGBA,this.webGLContext.UNSIGNED_BYTE,s),this.webGLContext.texParameteri(this.webGLContext.TEXTURE_2D,this.webGLContext.TEXTURE_MAG_FILTER,this.webGLContext.LINEAR),this.webGLContext.texParameteri(this.webGLContext.TEXTURE_2D,this.webGLContext.TEXTURE_MIN_FILTER,this.webGLContext.LINEAR_MIPMAP_LINEAR),this.webGLContext.generateMipmap(this.webGLContext.TEXTURE_2D),this.webGLContext.texParameteri(this.webGLContext.TEXTURE_2D,this.webGLContext.TEXTURE_WRAP_S,this.webGLContext.CLAMP_TO_EDGE),this.webGLContext.texParameteri(this.webGLContext.TEXTURE_2D,this.webGLContext.TEXTURE_WRAP_T,this.webGLContext.CLAMP_TO_EDGE),this.webGLContext.bindTexture(this.webGLContext.TEXTURE_2D,null),this.webGLContext.activeTexture(i||this.webGLContext.TEXTURE0),this.webGLContext.bindTexture(this.webGLContext.TEXTURE_2D,a),this.webGLContext.uniform1i(e||this.uSampler,r||0),a}drawCurrentBackground(t){var e=n(this.canvasSource.width,this.canvasSource.height);s(e,"position","absolute"),g(this.divContainer,e),e.getContext("2d").drawImage(t||this.preImage,0,0)}setProgress(t){this.webGLContext.uniform1f(this.uPhase,t),this.drawTransition(this.bufferContainer)}dataProsess(){}drawTransition(t,e=4,i,n){this.webGLContext.bindBuffer(this.webGLContext.ARRAY_BUFFER,t.vertexPosition),i&&i(this),this.webGLContext.vertexAttribPointer(this.aVertexPosition,t.vertexPosition.size,this.webGLContext.FLOAT,!1,0,0),t.vertexNormal&&(this.webGLContext.bindBuffer(this.webGLContext.ARRAY_BUFFER,t.vertexNormal),n&&n(this),this.webGLContext.vertexAttribPointer(this.aVertexNormal,t.vertexNormal.size,this.webGLContext.FLOAT,!1,0,0)),this.webGLContext.bindBuffer(this.webGLContext.ARRAY_BUFFER,t.textureCoord),this.webGLContext.vertexAttribPointer(this.aTextureCoord,t.textureCoord.size,this.webGLContext.FLOAT,!1,0,0),this.dataProsess(),this.webGLContext.bindBuffer(this.webGLContext.ELEMENT_ARRAY_BUFFER,t.elementIndecies),this.webGLContext.drawElements(e,t.elementIndecies.length,this.webGLContext.UNSIGNED_SHORT,0)}}class ut extends ct{opts=["LEFT","RIGHT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.M=this.opts.indexOf(n.dir)}initialize(){this.setupProgram(),this.createMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float; \n\n\tvarying vec2 vTextureCoord; \n\tvarying vec3 vNormal; \n\n\tuniform sampler2D uSampler; \n\n\tvoid main(void)  \n\t{ \n\t\tvec3 n = normalize(vNormal); \n\t\tvec3 lightingDirection = vec3(0.0, 0.0, 1.0); \n\t\tfloat directionalLightWeighting = dot(n, lightingDirection); \n\t\tfloat intentsity = 0.55 + 0.45 * directionalLightWeighting; \n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord); \n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a); \n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition; \n\tattribute vec3 aVertexNormal; \n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\n\tuniform mat3 uNMatrix;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tvoid main(void)\n\t{\n\t\tgl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0);\n\t\tvTextureCoord = aTextureCoord;\n\t\tvNormal = uNMatrix * aVertexNormal;\n\t}"}bufferData(){var t=this.canvasSource.width,e=this.canvasSource.height,i=t/2,r=e/2,a=.1*t,o=n(t,e);s(o,"position","absolute"),g(this.divContainer,o),o.getContext("2d").drawImage(this.preImage,0,0),this.currentBackground=o;var h=new E;R(h,new L(new y(-i,r,0),new M(0,0))),R(h,new L(new y(0,r,0),new M(.5,0))),R(h,new L(new y(-i+a,-r,0),new M(.1,1))),R(h,new L(new y(-i,-r,0),new M(0,1))),this.bufferContainer=new I;var c=T(this.webGLContext,F(h),3);this.bufferContainer.vertexPosition=c,c=T(this.webGLContext,G(h),2),this.bufferContainer.textureCoord=c,c=A(this.webGLContext,[0,1,2,0,2,3]),this.bufferContainer.elementIndecies=c,h=T(this.webGLContext,D(h),3),this.bufferContainer.vertexNormal=h,R(h=new E,new L(new y(i,r,0),new M(1,0))),R(h,new L(new y(0,r,0),new M(.5,0))),R(h,new L(new y(i-a,-r,0),new M(.9,1))),R(h,new L(new y(i,-r,0),new M(1,1))),this.bufferContainer2=new I,c=T(this.webGLContext,F(h),3),this.bufferContainer2.vertexPosition=c,c=T(this.webGLContext,G(h),2),this.bufferContainer2.textureCoord=c,c=A(this.webGLContext,[0,1,2,0,2,3]),this.bufferContainer2.elementIndecies=c,h=T(this.webGLContext,D(h),3),this.bufferContainer2.vertexNormal=h,this.matrixContainer=new E,R(this.matrixContainer,new L(new y(0,r,0),new M(.5,0))),R(this.matrixContainer,new L(new y(-i+a,-r,0),new M(.1,1))),R(this.matrixContainer,new L(new y((-i+a)/2,-r,0),new M(.3,1))),R(this.matrixContainer,new L(new y(0,r,0),new M(.5,0))),R(this.matrixContainer,new L(new y((-i+a)/2,-r,0),new M(.3,1))),R(this.matrixContainer,new L(new y(0,-r,0),new M(.5,1))),R(this.matrixContainer,new L(new y(0,r,0),new M(.5,0))),R(this.matrixContainer,new L(new y(0,-r,0),new M(.5,1))),R(this.matrixContainer,new L(new y((i-a)/2,-r,0),new M(.7,1))),R(this.matrixContainer,new L(new y(0,r,0),new M(.5,0))),R(this.matrixContainer,new L(new y((i-a)/2,-r,0),new M(.7,1))),R(this.matrixContainer,new L(new y(i-a,-r,0),new M(.9,1))),this.arIndecies=[0,1,2,3,4,5,6,7,8,9,10,11],this.matrixContainer2=new I,i=T(this.webGLContext,F(this.matrixContainer),3),this.matrixContainer2.vertexPosition=i,i=T(this.webGLContext,G(this.matrixContainer),2),this.matrixContainer2.textureCoord=i,i=A(this.webGLContext,this.arIndecies),this.matrixContainer2.elementIndecies=i,i=T(this.webGLContext,D(this.matrixContainer),3),this.matrixContainer2.vertexNormal=i}setProgress(t){if(.3>(t=super.checkRevert(t))){var e=H(0,0,.3,1)(t);this.drawTriangle(e,!0),this.drawTriangle(e,!1)}e=this.canvasSource.width;var i=this.canvasSource.height;i=Math.max(e,i);var n=this.M==lt?1:-1;at(this),.1<=t&&(.1<t&&.4>=t?(dt(this,t=H(.1,0,.4,1)(t)),mat4.translate(this.m4PMVMatrix,[0,0,-t*i/4]),ot(this,-60*t,[1,0,0],[-n*e/4,0,0]),ot(this,45*n*t,[0,0,1],[-n*e/4,0,0])):.4<t&&.5>=t?(t=H(.4,0,.5,1)(t),dt(this,1),mat4.translate(this.m4PMVMatrix,[0,0,-i/4]),mat4.translate(this.m4PMVMatrix,[n*t*i/50,-t*i/50,t*i/50]),ot(this,-60,[1,0,0],[-n*e/4,0,0]),ot(this,45*n,[0,0,1],[-n*e/4,0,0])):.5<t&&.55>t?(t=H(.5,0,.55,1)(t),dt(this,1),mat4.translate(this.m4PMVMatrix,[0,0,-i/4]),mat4.translate(this.m4PMVMatrix,[n*i/50,-i/50,i/50]),ot(this,-60,[1,0,0],[-n*e/4,0,0]),ot(this,45*n,[0,0,1],[-n*e/4,0,0]),ot(this,-1*t,[1,0,0],[0,0,0])):.55<t&&(dt(this,1),t=Math.pow(H(.55,0,1,1)(t),3),mat4.translate(this.m4PMVMatrix,[-n*t*i*3,t*i*3,t*i/2]),mat4.translate(this.m4PMVMatrix,[0,0,-i/4]),mat4.translate(this.m4PMVMatrix,[n*i/50,-i/50,i/50]),ot(this,-60,[1,0,0],[-n*e/4,0,0]),ot(this,45*n,[0,0,1],[-n*e/4,0,0]),ot(this,-1,[1,0,0],[0,0,0]))),this.setupMatrices(),this.drawTransition(this.matrixContainer2,this.webGLContext.TRIANGLES,this.bufferSubPosition,this.bufferSubNormal),st(this)}drawTriangle(t,e){var i=e?-1:1,n=Math.max(this.canvasSource.width,this.canvasSource.height);at(this),mat4.translate(this.m4PMVMatrix,[i*t*n/2,0,0]),this.setupMatrices(),this.drawTransition(e?this.bufferContainer:this.bufferContainer2),st(this)}bufferSubPosition(t){t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(F(t.matrixContainer)))}bufferSubNormal(t){nt(t.matrixContainer,t.arIndecies),t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(D(t.matrixContainer)))}}var lt=0;function dt(t,e){var i=t.canvasSource.width,n=t.canvasSource.height,r=i/2,a=n/2,s=.1*i;n=Math.max(i,n)/4;var o=H(0,-r+s,1,(-r+s)/2-(i=.1*i/2));t.matrixContainer.container[1].setPosition(new y(o(e),-a,0)),o=H(0,(-r+s)/2,1,-i),t.matrixContainer.container[2].setPosition(new y(o(e),-a,0)),t.matrixContainer.container[4].setPosition(new y(o(e),-a,0)),t.matrixContainer.container[5].setPosition(new y(0,-a,-e*n)),t.matrixContainer.container[7].setPosition(new y(0,-a,-e*n)),o=H(0,(r-s)/2,1,i),t.matrixContainer.container[8].setPosition(new y(o(e),-a,0)),t.matrixContainer.container[10].setPosition(new y(o(e),-a,0)),o=H(0,r-s,1,(r-s)/2+i),t.matrixContainer.container[11].setPosition(new y(o(e),-a,0))}class vt extends w{opts=["HORIZONTAL","VERTICAL"];constructor(t,e,i,n){super(t,i,e,n.revert),this.isVertical=this.opts.indexOf(n.dir)}initialize(){this.drawBackground()}drawBackground(){var t=this.canvasSource.width,e=this.canvasSource.height;this.divTransition=i("div"),g(this.divContainer,this.divTransition),u(this.divTransition,t+"px"),l(this.divTransition,t/2+"px "+e/2+"px"),this.isVertical?(this.itemCount=xt,t/=this.itemCount):(this.itemCount=ft,e/=this.itemCount),this.itemArray=[];for(var n=0,r=0;r<this.itemCount;r++){var a={};a.startTime=(1-gt)/(Math.ceil(this.itemCount/2)-1)*Math.floor(Math.abs(r-(this.itemCount-1)/2)),this.isVertical?(a.width=Math.round((r+1)*t)-n,a.height=e,a.position=n,n+=a.width):(a.height=Math.round((r+1)*e)-n,a.width=t,a.position=n,n+=a.height),this.isRevert&&(a.startTime=1-gt-a.startTime),this.itemArray.push(a)}if(this.itemCount%2!=0){for(r=0;r<this.itemCount/2-1;++r)this.setItemProperties(this.itemArray[r]),this.setItemProperties(this.itemArray[this.itemCount-r-1]);this.setItemProperties(this.itemArray[Math.floor(this.itemCount/2)])}else for(r=0;r<this.itemCount/2;++r)this.setItemProperties(this.itemArray[r]),this.setItemProperties(this.itemArray[this.itemCount-r-1])}setItemProperties(t){var e=r(t.width,t.height);x(e,"preserve-3d"),s(e,"position","absolute");var i=n(t.width,t.height),a=n(t.width,t.height),o=r(t.width,t.height),c=r(t.width,t.height);s(o,"backgroundColor","#000000"),s(c,"backgroundColor","#000000"),s(i,"position","absolute"),s(a,"position","absolute"),s(o,"position","absolute"),s(c,"position","absolute"),d(i,"hidden"),d(a,"hidden"),d(o,"hidden"),d(c,"hidden"),g(e,i),g(e,a),g(e,o),g(e,c),g(this.divTransition,e),t.divItem=e,t.cBefore=i,t.cAfter=a,t.dBefore=o,t.dAfter=c;var u,l=i.getContext("2d"),v=a.getContext("2d");this.isVertical?(h(e,t.position,0),l.drawImage(this.currentImage,t.position,0,t.width,t.height,0,0,t.width,t.height),v.drawImage(this.preImage,t.position,0,t.width,t.height,0,0,t.width,t.height),u="translateX("+(u=Math.round(t.width/2))+"px) rotateY(-60deg) translateX("+-u+"px) rotateZ(180deg) rotateX(180deg)"):(h(e,0,t.position),l.drawImage(this.currentImage,0,t.position,t.width,t.height,0,0,t.width,t.height),v.drawImage(this.preImage,0,t.position,t.width,t.height,0,0,t.width,t.height),u="translateY("+(u=Math.round(t.height/2))+"px) rotateX(-120deg) translateY("+u+"px)"),f(a,u),f(o,u)}setProgress(t){t=super.checkRevert(t);for(var e=0;e<this.itemCount;++e){var i=this.itemArray[e],n=Math.min(1,Math.max(0,2*(t-i.startTime)));if(n=k(0,1,n),i.currentTime!=n){i.currentTime=n,c(i.cBefore,1);var r=-120*n,a=1-2*n;if(this.isVertical){var s=i.width/2;a*=s,f(i.divItem,"translateX("+a+"px) rotateY("+r+"deg) translateX("+-s+"px)")}else{var o=i.height/2;a*=o,f(i.divItem,"translateY("+a+"px) rotateX("+-r+"deg) translateY("+-o+"px)")}var h=.5*-Math.sin(H(0,0,-120,-90)(r)*Math.PI/180);c(i.dAfter,h),h=.5*-Math.sin(H(0,-90,-120,0)(r)*Math.PI/180),c(i.dBefore,h)}}}}var xt=18,ft=14,gt=.5;class pt extends w{type;delta=10;transitionDiv;opts=["FROMBOTTOM","FROMTOP","FROMRIGHT","FROMLEFT"];constructor(t,e,i,n,r,a,s){super(t,i,e,n.revert),this.type=this.opts.indexOf(n.dir),this.isOrbit=r,this.foreground=a,this.preForeground=s}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;if(this.isOrbit){let i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.currentImage,0,0),this.cCurrentBackground=i,i=n(t,e),s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.cPreBackground=i}var i=this.createDivContainer(t,e);g(this.divContainer,i),s(i,"overflow","hidden");var r=n(t,e),a=n(t,e);r.getContext("2d").drawImage(this.isOrbit?this.preForeground:this.currentImage,0,0),a.getContext("2d").drawImage(this.isOrbit?this.foreground:this.preImage,0,0),this.transitionDiv=this.createDivContainer(t,e),this.currentImageDiv=this.createDivContainer(t,e),g(this.currentImageDiv,r),this.preImageDiv=this.createDivContainer(t,e),g(this.preImageDiv,a),g(this.transitionDiv,this.currentImageDiv),g(this.transitionDiv,this.preImageDiv),g(i,this.transitionDiv),u(i,Math.max(t,e)+"px"),l(i,this.delta+t/2+"px "+e/2+"px"),x(this.transitionDiv,"preserve-3d");var o=this.type==mt||this.type==Ct?-1:1;this.type==wt||this.type==Ct?(f(this.currentImageDiv,"translateZ(-"+(this.delta+Math.floor(t/2))+"px) rotateY(0deg)"),f(this.preImageDiv,"translateX("+o*(this.delta+Math.floor(t/2))+"px)  rotateY("+-90*o+"deg)")):(f(this.currentImageDiv,"translateZ(-"+(this.delta+Math.floor(e/2))+"px) rotateX(0deg)"),f(this.preImageDiv,"translateY("+o*(this.delta+Math.floor(e/2))+"px)  rotateX("+90*o+"deg)"))}setProgress(t){t=super.checkRevert(t),this.isOrbit&&c(this.cPreBackground,1-2*(t-0));var e=this.canvasSource.width,i=this.canvasSource.height,n=.25*(1-Math.cos(2*t*Math.PI)),r=k(0,1,t),a=this.type==mt||this.type==Ct?-1:1,s=this.type==wt||this.type==Ct,o=s?e+2*this.delta:i+2*this.delta;f(this.transitionDiv,s?"translateZ("+(-n*o+o/2)+"px) rotateY("+90*a*r+"deg)":"translateZ("+(-n*o+o/2)+"px) rotateX("+90*-a*r+"deg)")}createDivContainer(t,e){var i=r(t,e);return s(i,"position","absolute"),i}}const mt=1,wt=2,Ct=3;class St extends w{opts=["FROMTOP","FROMLEFT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.direction=this.opts.indexOf(n.dir)}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;this.scaleValue=1.25*Math.max(t,e),this.divTransition=r(t,e),g(this.divContainer,this.divTransition);try{this.drawBackground(),this.isRotate=!0}catch{this.isRotate=!1}this.xyzPoints=K(),Q(this.xyzPoints,.5*t,.5*e,this.scaleValue),this.setData()}drawBackground(){var t=.5*this.canvasSource.width+"px "+.5*this.canvasSource.height+"px";u(this.divTransition,this.scaleValue+"px"),l(this.divTransition,t)}setData(){function t(t,e){var i=1&e;return i*(t-1)+(1-2*i)*(e>>1)}var e=this.canvasSource.width,i=this.canvasSource.height,n=Math.floor(e/Pt),r=Math.floor(i/bt),a=e-(Pt-1)*n,s=i-(bt-1)*r;this.itemArrays=[];for(var o=0;o<bt;++o)for(var h=t(bt,o),c=h*r,u=bt-1==h?s:r+1,l=0;l<Pt;++l){var d=t(Pt,l),v=d*n,x=Pt-1==d?a:n+1,f=new Tt(this.currentImage,this.preImage,v,c,x,u,this.direction==It,this.xyzPoints,this.isRotate);g(this.divTransition,f.divRoot),this.itemArrays[Pt*h+d]=f}this.updateData()}updateData(){var t=.7-.15,e=this.direction==At?t/(bt-1):0,i=this.direction==It?t/(Pt-1):0;t=0;for(var n=1,r=0;bt>r;++r)for(var a=0;Pt>a;++a){var s=r*e+a*i+.15*Math.random();t=Math.max(s,t),n=Math.min(s,n),this.itemArrays[a+Pt*r].startTime=s}for(t=.7/(t-(e=n)),i=0;bt>i;++i)for(n=0;Pt>n;++n){var o=this.itemArrays[n+7*i];o.startTime=(o.startTime-e)*t}}setProgress(t){t=super.checkRevert(t);for(var e=0;e<this.itemArrays.length;++e){var i=this.itemArrays[e],n=(t-i.startTime)/.3,r=this.isRevert?0>n:1<n;n=Math.max(0,Math.min(1,n)),i.updateTransformByAngle(180*n,r)}}}class Tt{constructor(t,e,i,a,o,u,l,d,v){this.isFromTop=l,this.isRotate=v,this.xyzPoints=K(),Q(this.xyzPoints,i+.5*o,a+.5*u,0),q(this.xyzPoints,d,this.xyzPoints),this.xyzPoints2=K(),this.divRoot=r(o,u),this.divImages=r(o,u),this.divColor=r(o,u),this.cBefore=n(o,u),this.cAfter=n(o,u),s(this.divRoot,"position","absolute"),s(this.divImages,"position","absolute"),s(this.divColor,"position","absolute"),s(this.cBefore,"position","absolute"),s(this.cAfter,"position","absolute"),h(this.divRoot,i,a),g(this.divRoot,this.divImages),g(this.divRoot,this.divColor),g(this.divImages,this.cBefore),g(this.divImages,this.cAfter),this.setVisibility(!0),this.isRotate?f(this.cAfter,this.isFromTop?"rotateY(180deg)":"rotateY(180deg) rotateZ(180deg)"):f(this.cAfter,this.isFromTop?"scaleX(-1)":"scaleY(-1)"),this.cBefore.getContext("2d").drawImage(t,i,a,o,u,0,0,o,u),this.cAfter.getContext("2d").drawImage(e,i,a,o,u,0,0,o,u),s(this.divColor,"background-color","black"),c(this.divColor,0),this.updateTransformByAngle(0)}setVisibility(t){this.isVisible=t,s(t?this.cBefore:this.cAfter,"visibility","visible"),s(t?this.cAfter:this.cBefore,"visibility","hidden")}updateTransformByAngle(t,e){if(this.angle==t)this.divColor&&e&&(p(this.divColor),this.divColor=null);else{if(this.angle=t,this.isRotate){t=this.angle*Math.PI/180;var i=Math.sin(t),n=Math.cos(t);this.isFromTop?Q(this.xyzPoints2,0,i,n):Q(this.xyzPoints2,i,0,n);var r=$(this.xyzPoints2,this.xyzPoints);this.isVisible?r>=0&&this.setVisibility(!1):r<=0&&this.setVisibility(!0),f(this.divRoot,(this.isFromTop?"rotateY(":"rotateX(-")+this.angle+"deg)")}else this.isVisible?t>=90&&this.setVisibility(!1):t<=90&&this.setVisibility(!0),f(this.divRoot,(this.isFromTop?"scaleX(":"scaleY(")+Math.cos(this.angle*Math.PI/180)+")");c(this.divColor,.5*Math.sin(this.angle*Math.PI/180))}}}var At=0,It=1,Pt=7,bt=5;class Mt extends w{constructor(t,e,i,n){super(t,e,i,n.revert),this.isClockwise=n.clockwise,this.numOfElement=1}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height,i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.context=this.canvasSource.getContext("2d"),this.canvasTemp=n(t,e),this.contextTemp=this.canvasTemp.getContext("2d"),this.contextTemp.scale(1,e/t),t*=.5,this.lenght=Math.sqrt(2*t*t),s(this.canvasSource,"position","absolute"),g(this.divContainer,this.canvasSource)}setProgress(t){t=super.checkRevert(t);var e=this.canvasSource.width;this.canvasSource.height;var i=this.contextTemp,n=2/this.numOfElement,r=.2/this.numOfElement;for(this.isClockwise&&(n=-n,r=-r),i.clearRect(0,0,e,e),e=0;e<this.numOfElement;++e){var a=(1.5+e*n)*Math.PI,s=a+t*(r+n)*Math.PI,o=s-r*Math.PI;this.calculateData(o,s,a,a+n*Math.PI),s=.5*this.canvasSource.width,(this.isClockwise&&o<=a||!this.isClockwise&&o>=a)&&(i.beginPath(),i.moveTo(s,s),this.isClockwise?i.arc(s,s,this.lenght,a,o,!0):i.arc(s,s,this.lenght,a,o,!1),i.lineTo(s,s),i.fillStyle="#000",i.fill())}(i=this.context).drawImage(this.currentImage,0,0),i.save(),i.globalCompositeOperation="destination-in",i.drawImage(this.canvasTemp,0,0),i.restore()}calculateData(t,e,i,n){var r=.5*this.canvasSource.width,a=yt;e-=t;var s=t;for((this.isClockwise&&s>i||!this.isClockwise&&s<i)&&(a=(i-t)/e,s=i),i=r+this.lenght*Math.cos(s),s=r+this.lenght*Math.sin(s);1>=a;){var o=t+a*e;(this.isClockwise&&o<n||!this.isClockwise&&o>n)&&(o=n);var h=r+this.lenght*Math.cos(o),c=r+this.lenght*Math.sin(o);if(this.drawLines(r,r,i,s,h,c,1-a),a+=yt,i=h,s=c,o==n)break}}drawLines(t,e,i,n,r,a,s){var o=this.contextTemp;o.fillStyle="rgba(0,0,0,"+Math.floor(1e6*s)/1e6+")",o.beginPath(),o.moveTo(t,e),o.lineTo(i,n),o.lineTo(r,a),o.fill()}}var yt=1/15;class Lt extends w{isVertical;contstant=.33;opts=["VERTICAL","HORIZONTAL"];constructor(t,e,i,n){super(t,i,e,n.revert),this.isVertical=this.opts.indexOf(n.dir),this.isVertical?(this.contstant=(1-_t)/(Gt-1),this.contstantII=2*this.canvasSource.width/Math.pow(_t,2)):(this.contstant=.25,this.contstantII=2*this.canvasSource.height/Math.pow(_t,2))}initialize(){var t=this.isVertical?Dt:Gt,e=this.canvasSource.width,i=this.canvasSource.height,r=e/t,a=i/t;this.containerI=[],this.containerII=[];var o=0,h=n(e,i);s(h,"position","absolute"),g(this.divContainer,h),h.getContext("2d").drawImage(this.preImage,0,0);for(let n=0;n<t;++n){var c=0==n%2?this.containerI:this.containerII;if(this.isVertical){var u=Math.round((n+1)*a)-o;Rt(this.currentImage,c,0,o,e,u),o+=u}else{var l=Math.round((n+1)*r)-o;Rt(this.currentImage,c,o,0,l,i),o+=l}}this.containerI.reverse(),this.containerII.reverse(),g(this.divContainer,this.canvasSource)}setProgress(t){t=super.checkRevert(t);var e=this.canvasSource.width,i=this.canvasSource.height,n=this.canvasSource.getContext("2d");if(n.clearRect(0,0,e,i),this.isVertical){for(let e=0;e<this.containerI.length;e++){const i=this.containerI[e];var r=2*(e+1)-1;n.drawImage(i.canvas,0,0,i.width,i.height,Nt(this,r,t),i.top,i.width,i.height)}for(let e=0;e<this.containerII.length;e++){const i=this.containerII[e];r=2*(e+1),n.drawImage(i.canvas,0,0,i.width,i.height,-Nt(this,r,t),i.top,i.width,i.height)}}else{for(let e=0;e<this.containerI.length;e++){const i=this.containerI[e];r=2*(e+1)-1;n.drawImage(i.canvas,0,0,i.width,i.height,i.left,-Ft(t)*this.canvasSource.height,i.width,i.height)}for(let e=0;e<this.containerII.length;e++){const i=this.containerII[e];r=2*(e+1),n.drawImage(i.canvas,0,0,i.width,i.height,i.left,Ft(t)*this.canvasSource.height,i.width,i.height)}}}}function Et(t,e,i,n,r){this.canvas=t,this.left=e,this.top=i,this.width=n,this.height=r}function Rt(t,e,i,r,a,s){var o=n(a+1,s+1);o.getContext("2d").drawImage(t,i,r,a,s,0,0,a+1,s+1),e.push(new Et(o,i,r,a,s))}function Nt(t,e,i){return 0>=(e=i-(e-1)*t.contstant)?0:t.contstantII*Math.pow(e,2)/2}function Ft(t){return 1-Math.cos(t*Math.PI/2)}var Dt=7,Gt=10,_t=.5;class Ot extends w{Gu=!1;vD=!1;reflectionDistance=10;startTranslateTime=.3;angleY=20;originXPercents=20;translateZ=-100;translateXDistance=70;opts=["FROMRIGHT","FROMLEFT"];constructor(t,e,i,n,r,a,s){super(t,e,i,n.revert),this.preImage=i,this.direction=this.opts.indexOf(n.dir),this.isConveyor=r,this.isGallery=!r,this.foreground=a,this.preForeground=s,this.previousContentImg=s,this.currentBackground=e,this.preBackground=i}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;if(g(this.divContainer,this.createBlack(t,e)),this.isConveyor){let i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.currentImage,0,0),this.currentBackground=i,this.preImage?(i=n(t,e),s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.preBackground=i):(this.preBackground=this.createBlack(t,e),g(this.divContainer,this.preBackground)),i=n(t,e),s(i,"position","absolute"),this.foreground&&i.getContext("2d").drawImage(this.foreground,0,0),this.foreground=i,i=n(t,e),s(i,"position","absolute"),this.preForeground&&i.getContext("2d").drawImage(this.preForeground,0,0),this.preForeground=i}this.divRoot=this.createDiv(t,e),s(this.divRoot,"overflow","hidden"),g(this.divContainer,this.divRoot);var r=n(t,e),a=n(t,e),h=n(t,e/4),c=n(t,e/4);this.divTransition=i("DIV"),o(this.divTransition,t,e),this.divBefore=this.createDiv(t,e),this.divAfter=this.createDiv(t,e),this.isGallery&&(this.divBeforeBackground=this.createDiv(t,e/4),this.divAfterBackground=this.createDiv(t,e/4)),this.preImage&&g(this.divBefore,r),g(this.divAfter,a),this.isGallery&&(this.preImage&&g(this.divBeforeBackground,h),g(this.divAfterBackground,c)),g(this.divRoot,this.divTransition),g(this.divTransition,this.divBefore),g(this.divTransition,this.divAfter),this.isGallery&&(g(this.divTransition,this.divBeforeBackground),g(this.divTransition,this.divAfterBackground)),r=r.getContext("2d"),a=a.getContext("2d"),this.isConveyor?(this.previousContentImg&&r.drawImage(this.preForeground,0,0),this.foreground&&a.drawImage(this.foreground,0,0)):(this.preBackground&&r.drawImage(this.preBackground,0,0),this.currentBackground&&a.drawImage(this.currentBackground,0,0)),this.isGallery&&(this.drawReflection(h,this.preBackground),this.drawReflection(c,this.currentBackground)),u(this.divRoot,Math.max(t,e)+"px"),l(this.divRoot,t/2+"px "+e/2+"px"),x(this.divTransition,"preserve-3d"),t=this.isRevert?1:-1,e=this.canvasSource.width+this.translateXDistance,this.direction==Bt?(v(this.divTransition,100+this.originXPercents+"% 50%"),f(this.isRevert?this.divBefore:this.divAfter,"translateX("+-t*e+"px)"),this.isGallery&&f(this.isRevert?this.divBeforeBackground:this.divAfterBackground,"translate("+-t*e+"px, "+(this.canvasSource.height+this.reflectionDistance)+"px)")):(v(this.divTransition,-this.originXPercents+"% 50%"),f(this.isRevert?this.divBefore:this.divAfter,"translateX("+t*e+"px)"),this.isGallery&&f(this.isRevert?this.divBeforeBackground:this.divAfterBackground,"translate("+t*e+"px, "+(this.canvasSource.height+this.reflectionDistance)+"px)")),f(this.isRevert?this.divAfter:this.divBefore,"translateX(0px)"),this.isGallery&&f(this.isRevert?this.divAfterBackground:this.divBeforeBackground,"translateY("+(this.canvasSource.height+this.reflectionDistance)+"px)")}setProgress(t){if(t=super.checkRevert(t),this.isConveyor&&c(this.preBackground,1-2*(t-0)),t){var e=!0,i=this.direction==zt?1:-1;t<=this.startTranslateTime?(e=!1,f(this.divTransition,"translateZ("+this.translateZ*t+"px) rotateY("+i*t/this.startTranslateTime*this.angleY+"deg)"),!this.vD&&this.isRevert&&(this.vD=this.Gu=!0)):t>=1-this.startTranslateTime&&(e=!1,f(this.divTransition,"translateZ("+this.translateZ*(1-t)+"px) rotateY("+(1-t)/this.startTranslateTime*i*this.angleY+"deg)"),this.vD||this.isRevert||(this.vD=this.Gu=!0)),(e||this.Gu)&&(e=this.canvasSource.width+this.translateXDistance,t=this.Gu?this.isRevert?0:1:(t-this.startTranslateTime)/(1-2*this.startTranslateTime),this.Gu&&(this.Gu=!1),t=t*i*e,f(this.divBefore,"translateX("+t+"px)"),this.isGallery&&f(this.divBeforeBackground,"translate("+t+"px, "+(this.canvasSource.height+this.reflectionDistance)+"px)"),f(this.divAfter,"translateX("+(t-i*e)+"px)"),this.isGallery&&f(this.divAfterBackground,"translate("+(t-i*e)+"px, "+(this.canvasSource.height+this.reflectionDistance)+"px)"))}}createDiv(t,e){var i=r(t,e);return s(i,"position","absolute"),i}drawReflection(t,e){(t=t.getContext("2d")).save(),t.translate(0,this.canvasSource.height/4),t.scale(1,-1),e&&t.drawImage(e,0,.75*this.canvasSource.height,this.canvasSource.width,this.canvasSource.height/4,0,0,this.canvasSource.width,this.canvasSource.height/4),t.restore(),t.globalCompositeOperation="destination-out",(e=t.createLinearGradient(this.canvasSource.width/4,0,this.canvasSource.width/4,this.canvasSource.height/4)).addColorStop(0,"rgba(0, 255, 0, 0)"),e.addColorStop(.8,"rgba(0, 255, 0, 1)"),t.fillStyle=e,t.beginPath(),t.rect(0,0,this.canvasSource.width,this.canvasSource.height/4),t.fill()}}var Bt=0,zt=1;class Vt extends Ot{constructor(t,e,i,n,r,a){super(t,e,i,a,!0,n,r)}}class Ht extends w{opts=["FROMTOP","FROMRIGHT","FROMLEFT","FROMBOTTOM","FROMBOTTOMRIGHT","FROMTOPRIGHT","FROMBOTTOMLEFT","FROMTOPLEFT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.M=this.opts.indexOf(n.dir),this.se=!n.cover,this.Fe=!1,this.FJ(this.M)}initialize(){this.Yx(),this.Lm()}Lm(){var t=this.canvasSource.width,e=this.canvasSource.height;this.divTranstion=r(t,e),s(this.divTranstion,"position","absolute");var i=this.canvasSource;this.se?i.getContext("2d").drawImage(this.currentImage,0,0):i.getContext("2d").drawImage(this.preImage,0,0),g(this.divTranstion,i),g(this.divContainer,this.divTranstion)}Yx(){var t=n(this.canvasSource.width,this.canvasSource.height);this.se?t.getContext("2d").drawImage(this.preImage,0,0):t.getContext("2d").drawImage(this.currentImage,0,0),g(this.divContainer,t)}FJ(t){var e=this.canvasSource.width,i=this.canvasSource.height;switch(this.Ik=this.Hk=0,t){case Ut:this.Ik=i;break;case kt:this.Ik=-i;break;case Xt:this.Hk=e;break;case Wt:this.Hk=-e;break;case Zt:this.Hk=e,this.Ik=-i;break;case Yt:this.Hk=e,this.Ik=i;break;case Qt:this.Hk=-e,this.Ik=-i;break;case Kt:this.Hk=-e,this.Ik=i}this.se&&(this.Hk*=-1,this.Ik*=-1)}setProgress(t){t=super.checkRevert(t),t=V(t),this.se&&(t=1-t);var e=H(0,this.Hk,1,0),i=H(0,this.Ik,1,0);h(this.canvasSource,e(t),i(t))}}var kt=0,Xt=1,Wt=2,Ut=3,Yt=4,Zt=5,Kt=6,Qt=7;class Jt extends w{opts=["FROMBOTTOM","FROMTOP","FROMRIGHT","FROMLEFT"];constructor(t,e,i,n,r,a,s){super(t,e,i,n.revert),this.isFullContent=n.full,this.direction=this.opts.indexOf(n.dir),this.isSupport=!0,this.isRotate=r,this.foreground=a,this.preForegournd=s}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;if(this.isRotate){var r=n(t,e);s(r,"position","absolute"),g(this.divContainer,r),r.getContext("2d").drawImage(this.currentImage,0,0),this.cCurrentBackground=r,s(r=n(t,e),"position","absolute"),g(this.divContainer,r),r.getContext("2d").drawImage(this.preImage,0,0),this.cPreBackground=r}this.cBefore=n(t,e),this.preImage?this.cBefore.getContext("2d").drawImage(this.isRotate?this.preForegournd:this.preImage,0,0):s(this.cBefore,"backgroundColor","#000000"),this.cAfter=n(t,e),this.cAfter.getContext("2d").drawImage(this.isRotate?this.foreground:this.currentImage,0,0);var a=i("DIV");this.divTransition=i("DIV"),g(this.divTransition,this.cBefore),g(this.divTransition,this.cAfter),g(a,this.divTransition),g(this.divContainer,a);try{u(a,t+"px"),l(a,t/2+"px "+e/2+"px"),x(this.divTransition,"preserve-3d")}catch(t){this.isSupport=!0}s(this.cBefore,"position","absolute"),s(this.cAfter,"position","absolute"),o(this.divTransition,t,e),o(this.cBefore,t,e),o(this.cAfter,t,e);var h,c="";switch(this.direction){case ee:c="translateZ("+e/2+"px)",h="rotateX(90deg) translateZ("+e/2+"px)";break;case te:c="translateZ("+e/2+"px)",h="rotateX(-90deg) translateZ("+e/2+"px)";break;case ie:c="translateZ("+t/2+"px)",h="rotateY(90deg) translateZ("+t/2+"px)";break;case ne:c="translateZ("+t/2+"px)",h="rotateY(-90deg) translateZ("+t/2+"px)"}f(this.cBefore,c),f(this.cAfter,h)}setProgress(t){t=super.checkRevert(t),this.isRotate&&c(this.cPreBackground,1-2*(t-0)),this.isFullContent&&c(this.currentImage,1);var e="",i="",n=90*(t=k(0,1,t)),r=-this.canvasSource.width/2,a=-this.canvasSource.height/2,s=this.canvasSource.width*(1-t)+r,o=this.canvasSource.height*t+a;switch(this.direction){case ee:var h=H(0,180*Math.atan(this.canvasSource.height/(2*this.canvasSource.width))/Math.PI,1,180*-Math.atan(this.canvasSource.height/(2*this.canvasSource.width))/Math.PI),u="translateY("+o+"px) rotateX("+-n+"deg) translateY("+-a+"px)  translateZ("+a+"px)";this.isSupport||(e="translate(0px, "+-a+"px) scale(1, "+(1-t)+") translate(0px,"+a+"px)",i="translate(0px, "+o+"px) scale(1, "+t+") translate(0px,"+a+"px)");break;case te:h=H(0,180*Math.atan(this.canvasSource.height/(2*this.canvasSource.width))/Math.PI,1,180*-Math.atan(this.canvasSource.height/(2*this.canvasSource.width))/Math.PI),u="translateY("+-o+"px) rotateX("+n+"deg) translateY("+a+"px)  translateZ("+a+"px)",this.isSupport||(e="translate(0px, "+a+"px) scale(1, "+(1-t)+") translate(0px,"+-a+"px)",i="translate(0px, "+-o+"px) scale(1, "+t+") translate(0px,"+-a+"px)");break;case ie:h=H(0,180*Math.atan(.5)/Math.PI,1,180*-Math.atan(.5)/Math.PI),u="translateX("+s+"px) rotateY("+-n+"deg) translateX("+r+"px)  translateZ("+r+"px)",this.isSupport||(e="translate("+r+"px, 0px) scale("+(1-t)+", 1) translate("+-r+"px, 0px)",i="translate("+s+"px, 0px) scale("+t+", 1) translate("+-r+"px, 0px)");break;case ne:h=H(0,180*Math.atan(.5)/Math.PI,1,180*-Math.atan(.5)/Math.PI),u="translateX("+-s+"px) rotateY("+n+"deg) translateX("+-r+"px)  translateZ("+r+"px)",this.isSupport||(e="translate("+-r+"px, 0px) scale("+(1-t)+", 1) translate("+r+"px, 0px)",i="translate("+-s+"px, 0px) scale("+t+", 1) translate("+r+"px, 0px)");break;default:throw Error("Unknown direction")}this.isFullContent||(.5>t?(r=H(0,90,45,0),r=.5*Math.sin(r(n)*Math.PI/180)):(r=H(45,0,90,90),r=.5*Math.sin(r(n)*Math.PI/180))),this.isSupport?(0>=(t=n-h(t))?c(this.cAfter,0):90<=t?c(this.cBefore,0):(c(this.cAfter,1),c(this.cBefore,1)),f(this.divTransition,u)):(f(this.cBefore,e),f(this.cAfter,i))}}var jt,qt,$t,te=0,ee=1,ie=2,ne=3;class re extends ct{isLeft=!0;uLeftCurtain;bufferContainer2;constructor(t,e,i,n){super(t,i,e,n.revert),this.M=n.dir}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[-this.canvasSource.width/2,this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler;\n\n\tvoid main(void)\n\t{\n\t\tvec3 n = normalize(vNormal);\n\t\tvec3 lightingDirection = vec3(0.0, 0.0, 1.0);\n\t\tfloat directionalLightWeighting = abs(dot(n, lightingDirection));\n\t\tfloat intentsity = 0.7 + 0.3 * directionalLightWeighting;\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord);\n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a);\n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\tuniform mat3 uNMatrix;\n\n\tuniform float uPhase;\n\tuniform float uSlideHeight;\n\tuniform float uSlideWidth;\n\tuniform bool uLeftCurtain;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst float WAVES_COUNT = 10.0;\n\tconst float MIN_AMP_KOEF = 0.5;\n\tconst float WAVE_APPEAR_DURATION = 0.1;\n\tconst float WAVES_START_APPEAR_PHASE = 0.075;\n\tconst float WAVES_READY_PHASE = 0.275;\n\tconst float STRETCH_KOEF = 1.25;\n\tconst float MAX_CORNER_BOUNCE_AT_START_KOEF = 1.5;\n\tconst float MAX_CORNER_BOUNCE_AT_END_KOEF = 3.5;\n\tconst float DELTA_W = 1.0;\n\tconst float DELTA_H = 1.0;\n\tconst float PI = 3.14159265358979323846264;\n\n\tfloat sinX;\n\tfloat waveStartAppearTime;\n\tfloat rowRatio;\n\tfloat diagonalRatio;\n\tfloat forcedXPath;\n\tfloat xDampAmp;\n\tfloat yAmp;\n\tvec4 xTimesPart1;\n\tvec4 xTimesPart2;\n\tvec2 xTimesPart3;\n\tvec4 yTimesPart1;\n\tvec3 yTimesPart2;\n\n\tfloat linearInterpolation(float x, float x0, float fx0, float x1, float fx1)\n\t{\n\t\treturn mix(fx0, fx1, (x - x0) / (x1 - x0));\n\t}\n\n\tfloat calcAmpKoef(float x)\n\t{\n\t\tconst float X0 = 0.0;\n\t\tconst float X1 = 0.5;\n\t\tconst float X2 = 1.0;\n\n\t\tconst float Y0 = 0.25;\n\t\tconst float Y1 = 0.16;\n\t\tconst float Y2 = 0.0;\n\n\t\tfloat part1 = (x - X1) * (x - X2) * Y0 / (X0 - X1) / (X0 - X2);\n\t\tfloat part2 = (x - X0) * (x - X2) * Y1 / (X1 - X0) / (X1 - X2);\n\t\tfloat part3 = (x - X0) * (x - X1) * Y2 / (X2 - X0) / (X2 - X1);\n\n\t\treturn part1 + part2 + part3;\n\t}\n\n\tfloat smoothStep(float min, float max, float x)\n\t{\n\t\tif (x < min)\n\t\t{\n\t\t\treturn 0.0;\n\t\t}\n\t\tif (x >= max)\n\t\t{\n\t\t\treturn 1.0;\n\t\t}\n\n\t\tfloat value = (x - min) / (max - min);\n\t\tfloat squaredValue = value * value;\n\n\t\treturn -2.0 * squaredValue * value + 3.0 * squaredValue;\n\t}\n\n\tfloat calcAmp()\n\t{\n\t\tfloat periodKoef = linearInterpolation(uPhase, waveStartAppearTime, 1.0, waveStartAppearTime + WAVE_APPEAR_DURATION, MIN_AMP_KOEF);\n\t\tperiodKoef = clamp(periodKoef, MIN_AMP_KOEF, 1.0);\n\n\t\treturn calcAmpKoef(periodKoef) * uSlideWidth / WAVES_COUNT;\n\t}\n\n\tfloat calcX()\n\t{\n\t\tfloat forcedX = smoothStep(xTimesPart1.x, xTimesPart1.y, uPhase) * forcedXPath + smoothStep(xTimesPart1.z, xTimesPart1.w, uPhase) * 0.75;\n\t\tfloat dampAmpKoef = (uPhase <= xTimesPart2.w + 0.35) ? 1.0 : (diagonalRatio == 0.0 ? 1.0 : diagonalRatio);\n\t\tfloat stretchWidth = smoothStep(xTimesPart2.w, xTimesPart3.x, uPhase);\n\t\tfloat compressionWidth = smoothStep(xTimesPart3.x, xTimesPart3.y, uPhase);\n\t\tfloat deltaWidthKoef = (linearInterpolation(diagonalRatio, 0.0, 0.0, 1.0, compressionWidth) - linearInterpolation(diagonalRatio, 0.0, 0.0, 1.0, stretchWidth)) * STRETCH_KOEF;\n\n\t\tfloat dampX = smoothStep(xTimesPart2.x, xTimesPart2.y, uPhase);\n\t\tdampX -= smoothStep(xTimesPart2.y, xTimesPart2.z, uPhase) * 1.25;\n\t\tdampX += deltaWidthKoef;\n\n\t\treturn (forcedX + dampX * xDampAmp / dampAmpKoef) * uSlideWidth;\n\t}\n\n\tfloat calcY(vec3 vertex)\n\t{\n\t\tfloat cornerBounceAtStartKoef = linearInterpolation(uPhase, yTimesPart1.y, 0.0, yTimesPart1.z, MAX_CORNER_BOUNCE_AT_START_KOEF);\n\t\tfloat x0 = uLeftCurtain ? uSlideWidth * 0.25 : uSlideWidth * 0.5;\n\t\tfloat x1 = uLeftCurtain ? uSlideWidth * 0.5 : uSlideWidth * 0.75;\n\t\tfloat fx0 = uLeftCurtain ? cornerBounceAtStartKoef : MAX_CORNER_BOUNCE_AT_START_KOEF;\n\t\tfloat fx1 = uLeftCurtain ? MAX_CORNER_BOUNCE_AT_START_KOEF: cornerBounceAtStartKoef ;\n\t\tfloat colBounceAtStartKoef = linearInterpolation(vertex.x, x0, fx0, x1, fx1);\n\t\tcolBounceAtStartKoef = clamp(colBounceAtStartKoef, 0.0, MAX_CORNER_BOUNCE_AT_START_KOEF);\n\n\t\tfloat cornerBounceAtEndKoef = linearInterpolation(uPhase, yTimesPart2.y, 0.0, yTimesPart2.z, MAX_CORNER_BOUNCE_AT_END_KOEF);\n\t\tx0 = uLeftCurtain ? 0.0 : uSlideWidth * 0.5;\n\t\tx1 = uLeftCurtain ? uSlideWidth * 0.5 : uSlideWidth;\n\t\tfx0 = uLeftCurtain ? cornerBounceAtEndKoef : MAX_CORNER_BOUNCE_AT_END_KOEF;\n\t\tfx1 = uLeftCurtain ? MAX_CORNER_BOUNCE_AT_END_KOEF: cornerBounceAtEndKoef ;\n\t\tfloat colBounceAtEndKoef = linearInterpolation(vertex.x, x0, fx0, x1, fx1);\n\n\t\tfloat y0 = -smoothStep(yTimesPart1.x, yTimesPart1.y, uPhase) * colBounceAtStartKoef;\n\t\ty0 += smoothStep(yTimesPart1.y, yTimesPart1.z, uPhase) * MAX_CORNER_BOUNCE_AT_START_KOEF;\n\t\ty0 -= smoothStep(yTimesPart1.z, yTimesPart1.w, uPhase) * 0.25;\n\t\ty0 += smoothStep(yTimesPart1.w, yTimesPart2.x, uPhase) * 0.25;\n\t\ty0 -= smoothStep(yTimesPart2.x, yTimesPart2.y, uPhase) * colBounceAtEndKoef;\n\t\ty0 += smoothStep(yTimesPart2.y, yTimesPart2.z, uPhase) * (MAX_CORNER_BOUNCE_AT_END_KOEF + 1.0);\n\n\t\treturn (y0 * yAmp + rowRatio) * uSlideHeight;\n\t}\n\n\tvec3 getVertexPosition(vec3 vertex)\n\t{\n\t\tfloat amp = calcAmp();\n\t\tfloat z = -amp * sinX;\n\t\tfloat xKoef = uLeftCurtain ? 1.0 : -1.0;\n\n\t\treturn vec3(vertex.x - calcX() * xKoef, -calcY(vertex), z);\n\t}\n\n\tvoid initVertexParams(vec3 vertex)\n\t{\n\t\tfloat periodWidth = uSlideWidth / WAVES_COUNT;\n\t\tfloat frequency = PI * 2.0 / periodWidth;\n\t\tsinX = sin(frequency * vertex.x);\n\n\t\trowRatio = vertex.y / uSlideHeight;\n\n\t\tfloat halfRowRatio = rowRatio * 0.5;\n\t\tfloat halfSquaredRowRatio = rowRatio * halfRowRatio;\n\n\t\tfloat maxDT = 0.1;\n\t\tfloat dtAmp = 2.0 * maxDT;\n\t\tfloat dt = dtAmp * halfRowRatio;\n\n\t\tfloat distT = (0.6 - dt);\n\n\t\tfloat xT1 = dt;\n\t\tfloat xT2 = 0.4 + dt;\n\t\tfloat xT3 = xT2 + distT * 0.5;\n\t\tfloat xT4 = 1.0 + (1.0 - xT3);\n\n\t\tfloat xDampT1 = (xT1 + xT2) * 0.45;\n\t\tfloat xDampT2 = xT2;\n\t\tfloat xDampT3 = xT3;\n\t\tfloat xDampT4 = xDampT2 + (xDampT3 - xDampT2) * 0.5;\n\t\tfloat xDampT5 = xDampT3 + 0.075;\n\t\tfloat xDampT6 = 1.0;\n\n\t\tdistT = (0.7 - dt);\n\n\t\tfloat yT2 = 0.3 + dt;\n\t\tfloat yT3 = yT2 + distT * 0.5;\n\n\t\tfloat yDampT1 = 0.0;\n\t\tfloat yDampT2 = (yDampT1 * 2.0 + 0.35) * 0.5;\n\t\tfloat yDampT3 = yT2;\n\t\tfloat yDampT4 = (yT2 + yT2 + yT3) / 3.0;\n\t\tfloat yDampT5 = (yT2 + yT3 + yT3) / 3.0;\n\t\tfloat yDampT6 = yT3 + 0.1175;\n\t\tfloat yDampT7 = 1.0;\n\n\t\txTimesPart1 = vec4(xT1, xT2, xT3 - 0.125, xT4);\n\t\txTimesPart2 = vec4(xDampT1, xDampT2, xDampT3, xDampT4);\n\t\txTimesPart3 = vec2(xDampT5, xDampT6);\n\n\t\tyTimesPart1 = vec4(yDampT1 + 0.05, yDampT2, yDampT3, yDampT4);\n\t\tyTimesPart2 = vec3(yDampT5, yDampT6, yDampT7);\n\n\t\twaveStartAppearTime = linearInterpolation(vertex.y, 0.0, WAVES_START_APPEAR_PHASE, uSlideHeight, WAVES_READY_PHASE - WAVE_APPEAR_DURATION);\n\n\t\tfloat colRatio = (uLeftCurtain ? vertex.x : uSlideWidth - vertex.x)  / (uSlideWidth * 0.5);\n\t\tdiagonalRatio = (colRatio + rowRatio) * 0.5;\n\n\t\tfloat x0 = uLeftCurtain ? 0.0 : uSlideWidth * 0.5;\n\t\tfloat x1 = uLeftCurtain ? uSlideWidth * 0.5 : uSlideWidth;\n\t\tfloat fx0 = uLeftCurtain ? 0.2 : 0.0;\n\t\tfloat fx1 = uLeftCurtain ? 0.0 : 0.2;\n\t\tforcedXPath = 0.2 * (colRatio + linearInterpolation(vertex.x, x0, fx0, x1, fx1));\n\n\t\tfloat mxDampAmp = 0.1 * diagonalRatio;\n\t\tfloat dampAcc = 2.0 * mxDampAmp;\n\t\txDampAmp = dampAcc * halfRowRatio;\n\n\t\tfloat maxYAmp = 0.02;\n\t\tfloat dyAmp = 2.0 * maxYAmp * diagonalRatio * rowRatio;\n\t\tyAmp = dyAmp * halfSquaredRowRatio;\n\t}\n\n\tvec3 getVertexNormal(vec3 vertex, vec3 p)\n\t{\n\t\tbool rightSideXPos = vertex.x == (uLeftCurtain ? uSlideWidth * 0.5 : uSlideWidth);\n\t\tfloat deltaWidth = rightSideXPos ? -DELTA_W : DELTA_W;\n\n\t\tvec3 rightVertex = vec3(vertex.x + deltaWidth, vertex.y, vertex.z);\n\t\tinitVertexParams(rightVertex);\n\t\tvec3 right = getVertexPosition(rightVertex);\n\n\t\tvec3 downVertex = vec3(vertex.x, vertex.y + DELTA_H, vertex.z);\n\t\tinitVertexParams(downVertex);\n\t\tvec3 down = getVertexPosition(downVertex);\n\n\t\tvec3 v1 = vec3(right.x - p.x, right.y - p.y, right.z - p.z);\n\t\tvec3 v2 = vec3(down.x - p.x, down.y - p.y, down.z - p.z);\n\n\t\tvec3 n = rightSideXPos ? cross(v1, v2) : cross(v2, v1);\n\t\tn = normalize(n);\n\n\t\treturn n;\n\t}\n\n\tvoid main(void)\n\t{\n\t\tvTextureCoord = aTextureCoord;\n\n\t\tvec3 vertex = vec3(aVertexPosition.x, -aVertexPosition.y, aVertexPosition.z);\n\t\tinitVertexParams(vertex);\n\t\tvec3 p = getVertexPosition(vertex);\n\n\t\tvec3 pNormal = getVertexNormal(vertex, p);\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\n\t\tif (vertex.y == 0.0)\n\t\t{\n\t\t\tfloat maxDY = calcAmpKoef(MIN_AMP_KOEF) * uSlideWidth / WAVES_COUNT * 0.4;\n\t\t\tp.y += max(0.0, min(maxDY, linearInterpolation(uPhase, WAVES_START_APPEAR_PHASE, 0.0, WAVES_START_APPEAR_PHASE + WAVE_APPEAR_DURATION, maxDY)));\n\t\t}\n\t\tgl_Position = uPMVMatrix * vec4(p, 1.0);\n\t}"}bufferData(){var t=O(this.canvasSource.width,this.canvasSource.height,0,31),e=B(15,31),i=new I,n=T(this.webGLContext,F(t),3);i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer=i,t=O(this.canvasSource.width,this.canvasSource.height,30,61),i=new I,n=T(this.webGLContext,F(t),3),i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer2=i}getProperties(){super.getProperties(),this.uLeftCurtain=S(this.webGLContext,this.shaderProgram,"uLeftCurtain")}setupData(){this.webGLContext.uniform1f(this.uSlideWidth,this.canvasSource.width),this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height)}setProgress(t){t=super.checkRevert(t),this.isLeft=!0,this.webGLContext.uniform1f(this.uPhase,t),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP),this.isLeft=!1,this.drawTransition(this.bufferContainer2,this.webGLContext.TRIANGLE_STRIP)}dataProsess(){this.webGLContext.uniform1f(this.uLeftCurtain,this.isLeft)}completed(){super.completed(),P(this.webGLContext,this.bufferContainer2)}}class ae extends w{opts=["NONE","THROUGHBACK"];constructor(t,e,i,n){super(t,e,i,n.revert),this.preImage=i,this.Fe=!1,this.throughBlack=this.opts.indexOf(n.dir)}initialize(){this.throughBlack&&(this.Sf=this.createBlack(this.canvasSource.width,this.canvasSource.height),g(this.divContainer,this.Sf)),this.drawBackground()}drawBackground(){var t=this.canvasSource.width,e=this.canvasSource.height;if(!this.throughBlack){let i=n(t,e);s(i,"position","absolute"),this.preImage?i.getContext("2d").drawImage(this.preImage,0,0):i=this.createBlack(t,e),g(this.divContainer,i)}this.canvas=n(t,e),this.canvas.getContext("2d").drawImage(this.currentImage,0,0),g(this.divContainer,this.canvas)}setProgress(t){t=super.checkRevert(t),this.throughBlack?.2>t?(c(this.Sf,1),c(this.canvas,0)):(c(this.Sf,0),c(this.canvas,1)):.01>t?(c(this.Sf,1),c(this.canvas,0)):(c(this.Sf,0),c(this.canvas,1))}}class se extends w{constructor(t,e,i,n){super(t,i,e,n.revert),this.currentIndex=0}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height,i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),jt&&!(qt!=t||$t!=e)||(jt=[],qt=t,$t=e,function(t,e){for(var i=jt,n=54,r=42,a=t/n,s=e/r,o=0,h=0,c=0;n>c;++c){h=0;for(var u=Math.round((c+1)*a)-o,l=0;r>l;++l){var d=Math.round((l+1)*s)-h,v=new oe(o,h,u,d);v.startTime=Math.random(),i.push(v),h+=d}o+=u}i.sort((function(t,e){return t.startTime<e.startTime?-1:t.startTime>e.startTime?1:0}));var x=i.length;for(c=0;c<x;++c)i[c].startTime=.9*c/(x-1)}(t,e)),this.drawBackground()}drawBackground(){var t=this.canvasSource.width,e=this.canvasSource.height;this.canvasSource.getContext("2d").drawImage(this.currentImage,0,0,t,e),g(this.divContainer,this.canvasSource)}setProgress(t){t=super.checkRevert(t);for(var e=this.canvasSource.getContext("2d"),i=this.currentIndex;i<jt.length;i++){if(t<(n=jt[i]).startTime)break;e.drawImage(this.currentImage,n.left,n.top,n.width,n.height,n.left,n.top,n.width,n.height)}e.save(),e.globalCompositeOperation="destination-out";for(i=this.currentIndex;i<jt.length;i++){var n;if((n=jt[i]).startTime>t)break;var r=t-n.startTime;r>=.1&&(this.currentIndex=i),e.fillStyle="rgba(0, 0, 0, "+Math.floor(1e7*r)/1e6+")",e.fillRect(n.left,n.top,n.width,n.height)}e.restore()}}class oe{constructor(t,e,i,n){this.left=t,this.top=e,this.width=i,this.height=n,this.startTime=0}}class he extends w{opts=["VERTICAL","HORIZONTAL"];constructor(t,e,i,n,r,a,s){super(t,e,i,n.revert),this.direct=this.opts.indexOf(n.dir),this.isWindow=r,this.XH=n.transformLeft,this.currentBackground=e,this.preBackground=this.preImage,this.foreground=a,this.preForeground=s}initialize(){this.setBackground()}setBackground(){var t=this.canvasSource.width,e=this.canvasSource.height;if(this.isWindow){var i=n(t=this.canvasSource.width,e=this.canvasSource.height);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.currentImage,0,0),this.currentBackground=i,this.preImage?(s(i=n(t,e),"position","absolute"),i.getContext("2d").drawImage(this.preImage,0,0)):i=this.createBlack(t,e),this.preBackground=i,g(this.divContainer,i)}this.cCurrent=n(t,e),s(this.cCurrent,"position","absolute"),g(this.divContainer,this.cCurrent),this.cCurrent.getContext("2d").drawImage(this.isWindow?this.foreground:this.currentBackground,0,0),this.cLeft=n(t,e);var a=this.cLeft.getContext("2d");this.cRight=n(t,e);var o=this.cRight.getContext("2d"),h=r(t,e);s(h,"position","absolute"),s(h,"overflow","hidden"),g(this.divContainer,h),g(h,this.cLeft),g(h,this.cRight);try{u(h,t+"px"),l(h,t/2+"px "+e/2+"px"),x(this.cLeft,"preserve-3d"),x(this.cRight,"preserve-3d"),this.isSupport=!0}catch(t){this.isSupport=!1}s(this.cLeft,"position","absolute"),s(this.cRight,"position","absolute"),a.clearRect(0,0,t,e),o.clearRect(0,0,t,e);var c=this.isWindow?this.preForeground:this.preBackground;switch(this.direct){case ce:c&&a.drawImage(c,0,0,t/2,e,0,0,t/2,e),c&&o.drawImage(c,t/2,0,t/2,e,t/2,0,t/2,e);break;case ue:c&&a.drawImage(c,0,0,t,e/2,0,0,t,e/2),o.drawImage(c,0,e/2,t,e/2,0,e/2,t,e/2)}}setProgress(t){t=super.checkRevert(t),this.isWindow&&c(this.preBackground,1-2*(t-0));var e=this.canvasSource.width;e/=e+(1-2*t*t*.5)*e,e=this.isWindow?this.XH?Y(0,.7,4,e):V(e):e,f(this.cCurrent,"scale("+e+", "+e+")"),e=this.canvasSource.width/2;var i=this.canvasSource.height/2,n="",r="",a=0,s=0,o=0,u=0,l=120*t,d=H(0,1,1,.8),v=.8*k(0,1,t);switch(this.direct){case ce:n="translateX("+-e+"px) translateZ("+v*this.canvasSource.width+"px) rotateY("+l+"deg) translateX("+e+"px)",r="translateX("+e+"px) translateZ("+v*this.canvasSource.width+"px) rotateY("+-l+"deg) translateX("+-e+"px)",this.isSupport||(a=t*-e,s=t*e,n="translate("+-e+"px, 0px) scale("+d(t)+", 1) translate("+e+"px, 0px",r="translate("+e+"px, 0px) scale("+d(t)+", 1) translate("+-e+"px, 0px");break;case ue:n="translateY("+-i+"px) translateZ("+v*this.canvasSource.height+"px) rotateX("+-l+"deg) translateY("+i+"px)",r="translateY("+i+"px) translateZ("+v*this.canvasSource.height+"px) rotateX("+l+"deg) translateY("+-i+"px)",this.isSupport||(o=t*-i,u=t*i,n="translate(0px,"+-i+"px) scale(1, "+d(t)+") translate(0px, "+i+"px)",r="translate(0px, "+i+"px) scale(1, "+d(t)+") translate(0px, "+-i+"px)")}this.isSupport||(h(this.cLeft,a,o),h(this.cRight,s,u)),f(this.cLeft,n),f(this.cRight,r),d=H(0,1,.8,0),c(this.cLeft,d(t)),c(this.cRight,d(t))}}var ce=0,ue=1;class le extends ct{isLeft;uDirectionIsLeft;opts=["RIGHT","LEFT"];constructor(t,e,i,r){let a=n(e.width,e.height),s=a.getContext("2d");s.translate(e.width/2,e.height/2),s.rotate(Math.PI),s.translate(-e.width/2,-e.height/2),s.drawImage(e,0,0),super(t,a,i,r.revert),this.isLeft=this.opts.indexOf(r.dir)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[-this.canvasSource.width/2,this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler;\n\n\tconst vec3 LIGHT_DIRECTION = vec3(0.0, 0.0, 1.0);\n\tconst float AMBIENT_INTENSITY = 0.4;\n\tconst float DIFFUSE_INTENSITY = 0.6;\n\n\tvoid main(void)\n\t{\n\t\tfloat intentsity = AMBIENT_INTENSITY + DIFFUSE_INTENSITY * abs(dot(normalize(vNormal), LIGHT_DIRECTION));\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord);\n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a);\n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\tuniform mat3 uNMatrix;\n\n\tuniform float uPhase;\n\tuniform bool uDirectionIsLeft;\n\tuniform float uSlideHeight;\n\tuniform float uSlideWidth;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst float TIME_1 = 0.2;\n\tconst float TIME_2 = 0.6;\n\tconst float TIME_3 = 0.7;\n\tconst float TIME_4 = 0.8;\n\n\tconst float START_PHASE = 0.3;\n\tconst float END_PHASE = 0.7;\n\n\tconst float ANGLE_1 = 0.0;\n\tconst float ANGLE_2 = -180.0;\n\tconst float ANGLE_3 = ANGLE_2 - 20.0;\n\n\tfloat linearInterpolation(float x, float x0, float fx0, float x1, float fx1)\n\t{\n\t\treturn mix(fx0, fx1, (x - x0) / (x1 - x0));\n\t}\n\n\tvec3 ellipse(float angle, vec3 pos, vec2 center, vec2 radius)\n\t{\n\t\tfloat ang = radians(angle);\n\t\treturn vec3(pos.x, center.x + radius.x * cos(ang), -(center.y + radius.y * sin(ang)));\n\t}\n\n\tfloat goBack(float y, float phase, float constAngleTime)\n\t{\n\t\tfloat time = linearInterpolation(y, 0.0, TIME_3, uSlideHeight, TIME_4);\n\n\t\tif (phase > time)\n\t\t{\n\t\t\treturn linearInterpolation(phase, time, ANGLE_3, 1.0, ANGLE_2);\n\t\t}\n\t\tfloat angle = linearInterpolation(phase, constAngleTime, ANGLE_2, time, ANGLE_3);\n\t\treturn angle;\n\t}\n\n\tfloat getRowAngleByPhase(vec3 pos, float phase)\n\t{\n\t\tconst float HORIZONTAL_DELAY = 0.05;\n\t\tfloat colDelay = uDirectionIsLeft\n\t\t\t? linearInterpolation(pos.x, 0.0, 0.0, uSlideWidth, HORIZONTAL_DELAY)\n\t\t\t: linearInterpolation(pos.x, 0.0, HORIZONTAL_DELAY, uSlideWidth, 0.0);\n\n\t\tphase = linearInterpolation(phase, 0.0, colDelay, 1.0, 1.0);\n\n\t\tfloat constAngleTime = linearInterpolation(pos.y, 0.0, TIME_2, uSlideHeight, TIME_1);\n\t\tif (phase > constAngleTime)\n\t\t{\n\t\t\treturn goBack(pos.y, phase, constAngleTime);\n\t\t}\n\n\t\tfloat angle = linearInterpolation(phase, 0.0, ANGLE_1, constAngleTime, ANGLE_2);\n\t\treturn angle;\n\t}\n\n\tvec3 getVertexPosition(float phase, vec3 pos)\n\t{\n\t\tfloat R_1 = uSlideHeight;\n\t\tfloat R_2 = uSlideHeight * 0.25;\n\t\tvec2 r = vec2(linearInterpolation(pos.y, 0.0, R_1, uSlideHeight, 0.0), linearInterpolation(pos.y, 0.0, R_2, uSlideHeight, 0.0));\n\n\t\tfloat angle = getRowAngleByPhase(pos, phase);\n\t\tvec3 v = ellipse(angle, pos, vec2(0.0, 0.0), r);\n\t\treturn v;\n\t}\n\tvec3 getVertexNormal(float phase, vec3 pos)\n\t{\n\t\tconst float DELTA_W = 1.0;\n\t\tconst float DELTA_H = 1.0;\n\n\t\tfloat deltaWidth = (pos.x == uSlideWidth) ? -DELTA_W : DELTA_W;\n\t\tfloat deltaHeight = (pos.y == uSlideHeight) ? -DELTA_H : DELTA_H;\n\n\t\tvec3 right = getVertexPosition(phase, vec3(pos.x + deltaWidth, pos.y, pos.z));\n\t\tvec3 down = getVertexPosition(phase, vec3(pos.x, pos.y + deltaHeight, pos.z));\n\t\tvec3 p = getVertexPosition(phase, vec3(pos.x, pos.y, pos.z));\n\n\t\tvec3 v1 = right - p;\n\t\tvec3 v2 = down - p;\n\n\t\tvec3 n = (pos.x == uSlideWidth) ? cross(v1, v2) : cross(v2, v1);\n\n\t\treturn normalize(n);\n\t}\n\n\tvoid main(void)\n\t{\n\t\tfloat phase = uPhase;\n\t\tif (phase < START_PHASE)\n\t\t{\n\t\t\tphase = 0.0;\n\t\t}\n\t\telse if (phase > END_PHASE)\n\t\t{\n\t\t\tphase = 1.0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tphase = linearInterpolation(phase, START_PHASE, 0.0, END_PHASE, 1.0);\n\t\t}\n\t\t\n\t\tvec3 vertex = vec3(aVertexPosition.x, -aVertexPosition.y, aVertexPosition.z);\n\t\tvec4 p = vec4(getVertexPosition(phase, vertex), 1.0);\n\t\tgl_Position = uPMVMatrix * p;\n\t\tvTextureCoord = aTextureCoord;\n\n\t\tvec3 pNormal = getVertexNormal(phase, vertex);\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\t}"}bufferData(){var t=_(30,30,this.canvasSource.width,this.canvasSource.height),e=B(30,30),i=new I,n=T(this.webGLContext,F(t),3);i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer=i}getProperties(){super.getProperties(),this.uDirectionIsLeft=S(this.webGLContext,this.shaderProgram,"uDirectionIsLeft")}setupData(){this.webGLContext.uniform1f(this.uSlideWidth,this.canvasSource.width),this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height),this.webGLContext.uniform1f(this.uDirectionIsLeft,this.isLeft)}completed(){super.completed()}}class de extends w{opts=["SMOOTHLY","THROUGHBACK"];constructor(t,e,i,n){super(t,i,e,n.revert),this.direction=this.opts.indexOf(n.dir),this.Fe=!0}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;let i=n(t,e),r=i.getContext("2d");r.fill="black",r.fillRect(0,0,t,e),this.canvasSource.getContext("2d").drawImage(this.direction?i:this.currentImage,0,0),g(this.divContainer,this.canvasSource);var a=n(t,e);s(a,"position","absolute"),g(this.divContainer,a),a.getContext("2d").drawImage(this.preImage,0,0),this.preBackground=a}setProgress(t){t=super.checkRevert(t),c(this.preBackground,1-2*(.5-t))}}class ve extends ct{isLeft;uDirectionIsLeft;opts=["RIGHT","LEFT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.isLeft=this.opts.indexOf(n.dir)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t+.1),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[-this.canvasSource.width/2,-this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float; \n\n\tvarying vec2 vTextureCoord; \n\tvarying vec3 vNormal; \n\n\tuniform sampler2D uSampler; \n\n\tvoid main(void)  \n\t{ \n\t\tvec3 n = normalize(vNormal); \n\t\tvec3 lightingDirection = vec3(0.0, 0.0, 1.0); \n\t\tfloat directionalLightWeighting = dot(n, lightingDirection); \n\t\tfloat intentsity = 0.55 + 0.45 * directionalLightWeighting; \n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord); \n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a); \n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\tuniform mat3 uNMatrix;\n\n\tuniform float uPhase;\n\tuniform bool uDirectionIsLeft;\n\tuniform float uSlideHeight;\n\tuniform float uSlideWidth;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst float DELAY_ANGLE = 5.0;\n\tconst float SLIDE_WIDTH_KOEF = 0.2;\n\tconst float PI = 3.14159265358979323846264;\n\tconst vec2 CENTER = vec2(0.0, 0.0);\n\tconst float DELTA_W = 0.5;\n\tconst float DELTA_H = 0.5;\n\n\tfloat linearInterpolation(float x, float x0, float fx0, float x1, float fx1)\n\t{\n\t\treturn mix(fx0, fx1, (x - x0) / (x1 - x0));\n\t}\n\n\tvec2 ellipse(float angle, vec2 center, vec2 radius)\n\t{\n\t\tfloat ang = radians(angle);\n\t\treturn vec2((center.x + radius.x * cos(ang)), -(center.y + radius.y * sin(ang)));\n\t}\n\n\tfloat accelerationFunc(float progress)\n\t{\n\t\tfloat a = 3.0;\n\t\tfloat b = 1.0;\n\t\tfloat c = 1.0;\n\t\tfloat d = 1.0;\n\n\t\tfloat squaredProgress = progress * progress;\n\t\treturn a * squaredProgress * progress + b * squaredProgress + c * progress + d;\n\t}\n\n\tfloat getRowAngleByPhase(vec3 vertex)\n\t{\n\t\tfloat endAngle = atan(uSlideHeight * 0.5 / max(uSlideWidth, uSlideHeight)) * 180.0 / PI + 90.0 + DELAY_ANGLE * 4.0;\n\n\t\tfloat a = -0.6;\n\t\tfloat b = 2.0 + a;\n\n\t\tfloat phase = linearInterpolation(uPhase, 0.0, a, 1.0, b);\n\t\tphase = accelerationFunc(phase);\n\n\t\tfloat angle = linearInterpolation(phase, accelerationFunc(a), 0.0, accelerationFunc(b), endAngle);\n\t\tfloat rowDelayAngle = linearInterpolation(vertex.y, 0.0, DELAY_ANGLE, uSlideHeight, 0.0);\n\t\tfloat extraAngle = linearInterpolation(uPhase, 0.5, 0.0, 0.8, DELAY_ANGLE);\n\t\tfloat maxDelayAngle = DELAY_ANGLE + max(0.0, min(DELAY_ANGLE, extraAngle));\n\t\tfloat colAngle = uDirectionIsLeft\n\t\t\t? linearInterpolation(vertex.x, 0.0, maxDelayAngle * 0.5, uSlideWidth, maxDelayAngle)\n\t\t\t: linearInterpolation(vertex.x, 0.0, maxDelayAngle, uSlideWidth, maxDelayAngle * 0.5);\n\n\t\tfloat colDelayAngle = uDirectionIsLeft\n\t\t\t? linearInterpolation(vertex.x, 0.0, 0.0, uSlideWidth, colAngle)\n\t\t\t: linearInterpolation(vertex.x, 0.0, colAngle, uSlideWidth, 0.0);\n\n\n\t\treturn max(0.0, angle - rowDelayAngle - colDelayAngle);\n\t}\n\n\tvec3 getVertexPosition(vec3 vertex)\n\t{\n\t\tfloat maxXRadius = uSlideHeight;\n\t\tfloat maxYRadius = sqrt(uSlideWidth * SLIDE_WIDTH_KOEF * uSlideWidth * SLIDE_WIDTH_KOEF + uSlideHeight * uSlideHeight);\n\n\t\tfloat xRadius = linearInterpolation(vertex.y, 0.0, maxXRadius, uSlideHeight, 0.0);\n\t\tfloat yRadius = linearInterpolation(vertex.y, 0.0, maxYRadius, uSlideHeight, 0.0);\n\n\t\treturn vec3(vertex.x, ellipse(getRowAngleByPhase(vertex), CENTER, vec2(xRadius, yRadius)));\n\t}\n\n\tvec3 getVertexNormal(vec3 pos, vec3 p)\n\t{\n\t\tbool rightSideXPos = pos.x == uSlideWidth;\n\t\tfloat deltaWidth = rightSideXPos ? -DELTA_W : DELTA_W;\n\n\t\tvec3 right = getVertexPosition(vec3(pos.x + deltaWidth, pos.y, pos.z));\n\t\tvec3 down = getVertexPosition(vec3(pos.x, pos.y + DELTA_H, pos.z));\n\n\t\tvec3 v1 = right - p;\n\t\tvec3 v2 = down - p;\n\n\t\tvec3 n = rightSideXPos ? cross(v1, v2) : cross(v2, v1);\n\t\tn = normalize(n);\n\n\t\treturn n;\n\t}\n\n\tvoid main(void)\n\t{\n\t\tvTextureCoord = aTextureCoord;\n\n\t\tvec3 vertex = vec3(aVertexPosition.x, -aVertexPosition.y, aVertexPosition.z);\n\t\tvec4 p = vec4(getVertexPosition(vertex), 1.0);\n\t\tgl_Position = uPMVMatrix * p;\n\n\t\tvec3 pNormal = getVertexNormal(vertex, vec3(p.xyz));\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\t}"}bufferData(){var t=_(15,15,this.canvasSource.width,this.canvasSource.height),e=B(15,15),i=new I,n=T(this.webGLContext,F(t),3);i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer=i}getProperties(){super.getProperties(),this.uDirectionIsLeft=S(this.webGLContext,this.shaderProgram,"uDirectionIsLeft")}setupData(){this.webGLContext.uniform1f(this.uSlideWidth,this.canvasSource.width),this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height),this.webGLContext.uniform1f(this.uDirectionIsLeft,this.isLeft)}completed(){super.completed()}}class xe extends w{opts=["FROMRIGHT","FROMLEFT"];constructor(t,e,i,n,r,a){super(t,e,i,a.revert),this.direction=this.opts.indexOf(a.dir),this.foreground=n,this.preForground=r}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height,i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.currentImage,0,0),this.Ar=i,s(i=n(t,e),"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.Dr=i,this.oe=this.Sb(t,e),g(this.divContainer,this.oe);var r=n(t,e);i=n(t,e),this.cF=this.Sb(t,e),this.Bg=this.Sb(t,e),this.Ag=this.Sb(t,e),g(this.Bg,r),g(this.Ag,i),g(this.oe,this.cF),g(this.cF,this.Bg),g(this.cF,this.Ag),r=r.getContext("2d"),i=i.getContext("2d"),this.preForground&&r.drawImage(this.preForground,0,0),i.drawImage(this.foreground,0,0),u(this.oe,Math.max(t,e)+"px"),l(this.oe,t/2+"px "+e/2+"px"),x(this.cF,"preserve-3d")}setProgress(t){t=super.checkRevert(t);var e=this.canvasSource.width,i=this.canvasSource.height;c(this.Dr,1-t),c(this.Ar,t),t=function(t,e,i){return i<t?0:i>=e?1:(t=(i-t)/(e-t),-2*Math.pow(t,3)+3*Math.pow(t,2))}(0,1,t);var n,r=this.M==fe?1:-1,a=r*this.V_*e*(1-t),s=-this.W_*i*(1-t),o=-Math.max(e,i)*(1-t),h=-this.iQ*(1-t),u=-r*this.jQ*(1-t),l=r*this.X_*(1-t);n=-r/2,f(this.Bg,"translateZ("+Math.max(e,i)*t+"px) translateY("+i*t+"px) translateX("+n*this.Y_*e*t+"px) rotateX("+this.iQ*t+"deg) rotateY("+r*this.jQ*t+"deg) rotateZ("+-r*this.Z_*t+"deg)"),this.direction&&(a=-a,u=-u,l=-l),f(this.Ag,"translateZ("+o+"px) translateY("+s+"px) translateX("+a+"px) rotateX("+h+"deg) rotateY("+u+"deg) rotateZ("+l+"deg)")}Sb(t,e){var n=i("DIV");return o(n,t,e),s(n,"position","absolute"),n}Y_=.1;V_=.5;W_=1.75;X_=30;Z_=10;iQ=80;jQ=30}var fe=1;class ge extends w{constructor(t,e,i,n){super(t,e,i,n.revert),this.direction=n.dir}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.drawBackground()}setProgress(t){t=super.checkRevert(t);var e=this.canvasSource,i=this.canvasSource.width,n="scale("+t+") rotate("+-360*t+"deg)";i=i/2+"px "+this.canvasSource.height/2+"px",c(e,t),s(e,"MozTransform",n),s(e,"MozTransformOrigin",i),s(e,"webkitTransform",n),s(e,"webkitTransformOrigin",i),s(e,"OTransform",n),s(e,"OTransformOrigin",i),s(e,"msTransform",n),s(e,"msTransformOrigin",i)}drawBackground(){var t=this.canvasSource.width,e=this.canvasSource.height;this.canvasSource.getContext("2d").drawImage(this.currentImage,0,0,t,e),g(this.divContainer,this.canvasSource)}}class pe extends w{isLeft;transtionDiv;opts=["RIGHT","LEFT"];constructor(t,e,i,n){super(t,e,i,n.revert),this.isLeft=this.opts.indexOf(n.dir)}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;a(this.canvasSource,this.currentImage),this.canvasSource2=n(t,e),a(this.canvasSource2,this.preImage);var r=i("div");this.transtionDiv=i("div"),u(r,Math.max(t,e)+"px"),l(r,t/2+"px "+e/2+"px"),x(this.transtionDiv,"preserve-3d"),d(this.transtionDiv,"hidden"),this.isLeft?(g(this.transtionDiv,this.canvasSource),g(this.transtionDiv,this.canvasSource2)):(g(this.transtionDiv,this.canvasSource2),g(this.transtionDiv,this.canvasSource)),g(r,this.transtionDiv),g(this.divContainer,r),s(this.canvasSource,"position","absolute"),s(this.canvasSource2,"position","absolute"),o(this.transtionDiv,t,e),this.isLeft?f(this.canvasSource,"rotateY(180deg)"):f(this.canvasSource2,"rotateY(180deg)")}updateDivTransition(t){t=this.isLeft?t:1-t;var e=.35*(1-Math.cos(2*t*Math.PI));t=z(.63,.43)(t);var i=Math.max(this.canvasSource.width,this.canvasSource.height);f(this.transtionDiv,"rotateY("+-180*t+"deg)translateZ("+e*i*-.3+"px)")}updateCanvasSource(t){if((t=z(.63,.43)(t))<.5){var e="scaleX("+H(0,1,.5,0)(t)+")";c(this.canvasSource,1),c(this.canvasSource2,0),f(this.canvasSource,e)}else{e="scaleX("+H(.5,0,1,1)(t)+")";c(this.canvasSource,0),c(this.canvasSource2,1),f(this.canvasSource2,e)}}setProgress(t){t=super.checkRevert(t),this.updateDivTransition(t)}}class me extends w{opts=["IN","OUT","INWITHBOUNCE","OUTWITHBOUNCE"];constructor(t,e,i,n,r,a,s){super(t,e,i,n.revert),this.currentBackground=e,this.preBackground=i,this.direction=this.opts.indexOf(n.dir)%2,this.flyThrough=r,this.isBounce=n.dir&&n.dir.toUpperCase().includes("BOUNCE"),this.foreground=a,this.preForeground=s}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;if(this.flyThrough){let i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.currentImage,0,0),this.currentBackground=i,i=n(t,e),s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.preBackground=i}this.canvasCurrentMain=n(t,e),s(this.canvasCurrentMain,"position","absolute"),g(this.divContainer,this.canvasCurrentMain),this.contextCurrentMain=this.canvasCurrentMain.getContext("2d")}setProgress(t){t=super.checkRevert(t),this.flyThrough&&c(this.preBackground,1-2*(t-0));var e=this.canvasSource.width,i=this.canvasSource.height,n=this.flyThrough?this.preForeground:this.preBackground,r=this.flyThrough?this.foreground:this.currentBackground,a=this.contextCurrentMain;a.clearRect(0,0,e,i),e=this.direction==we?1:-1,t=k(0,1,t),i=H(0,6,1,1),i=this.isBounce?Y(4,.8,4,t):this.direction==we?2-t:i(t),i=this.direction==we?1/i:i,this.direction==we?(Ce(this,t,i,a,this.flyThrough?this.foreground:r),Se(this,2*t,e,a,this.flyThrough?this.preForeground:n)):(Se(this,.5*t,e,a,this.flyThrough?this.preForeground:n),Ce(this,t,i,a,this.flyThrough?this.foreground:r))}}var we=0;function Ce(t,e,i,n,r){const a=t.canvasSource.width,s=t.canvasSource.height;var o=t.canvasSource.width/2*(1-i);t=t.canvasSource.height/2*(1-i),n.save(),n.translate(o,t),n.scale(i,i),n.globalAlpha=2*e,n.drawImage(r,0,0,a,s),n.restore()}function Se(t,e,i,n,r){const a=t.canvasSource.width,s=t.canvasSource.height;var o=-i*t.canvasSource.width*e/2;t=-i*t.canvasSource.height*e/2,i=1+i*e,n.save(),n.translate(o,t),n.scale(i,i),e=Math.min(1-2*e,1),e=Math.max(e,0),n.globalAlpha=e,r&&n.drawImage(r,0,0,a,s),n.restore()}class Te extends me{constructor(t,e,i,n,r,a){super(t,e,i,a,!0,n,r)}}class Ae extends ct{constructor(t,e,i,n){super(t,i,e,n.revert)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),this.setupMatrices(),this.drawBackground(),this.bufferData()}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying float vLightIntentsity;\n\n\tuniform sampler2D uSampler;\n\n\tvoid main(void)\n\t{\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord);\n\n\t\tgl_FragColor = vec4(textureColor.rgb * vLightIntentsity, textureColor.a);\n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\tattribute vec3 aRotationCenter;\n\tattribute vec3 aRotationParams;\n\tattribute vec3 aTranslationParams;\n\tattribute vec4 aFreeRotation;\n\n\tuniform mat4 uPMVMatrix; \n\tuniform mat3 uNMatrix;\n\tuniform float uPhase;\n\tuniform float uSlideHeight;\n\n\tvarying vec2 vTextureCoord;\n\tvarying float vLightIntentsity;\n\n\tfloat sqr(float v)\n\t{\n\t\treturn v * v;\n\t}\n\n\tmat4 prependTranslation(mat4 m, float x, float y, float z)\n\t{\n\t\tmat4 t = mat4(1.0);\n\t\tt[3] = vec4(x, y, z, 1.0);\n\t\treturn m * t;\n\t}\n\n\tmat4 prependRotation(mat4 m, float angle, vec3 axis)\n\t{\n\t\tmat4 t = mat4(1.0);\n\t\tvec3 u = normalize(axis);\n\t\tfloat rad = radians(angle);\n\t\tfloat sin = sin(rad);\n\t\tfloat cos = cos(rad);\n\t\tt[0] = vec4(cos + sqr(u.x) * (1.0 - cos), u.y * u.x * (1.0 - cos) + u.z * sin, u.z * u.x * (1.0 - cos) - u.y * sin, 0.0);\n\t\tt[1] = vec4(u.x * u.y * (1.0 - cos) - u.z * sin, cos + sqr(u.y) * (1.0 - cos), u.z * u.y * (1.0 - cos) + u.x * sin, 0.0);\n\t\tt[2] = vec4(u.x * u.z * (1.0 - cos) + u.y * sin, u.y * u.z * (1.0 - cos) - u.x * sin, cos + sqr(u.z) * (1.0 - cos), 0.0);\n\t\treturn m * t;\n\t}\n\n\tmat4 prependRotation(mat4 m, float angle, vec3 axis, vec3 pivotPoint)\n\t{\n\t\tmat4 t = mat4(1.0);\n\t\tt = prependTranslation(t, pivotPoint.x, pivotPoint.y, pivotPoint.z);\n\t\tt = prependRotation(t, angle, axis);\n\t\tt = prependTranslation(t, -1.0 * pivotPoint.x, -1.0 * pivotPoint.y, -1.0 * pivotPoint.z);\n\t\treturn m * t;\n\t}\n\n\tvoid main(void) \n\t{\n\t\tconst float delay =  0.15;\n\t\tfloat phase = clamp(uPhase - delay, 0.0, 1.0);\n\n\t\tfloat vy = uSlideHeight / (1.0 - delay);\n\t\tfloat dy = vy * phase + (aTranslationParams.y * sqr(phase)) / 2.0;\n\t\tvec3 d = mix(vec3(0.0), aTranslationParams, phase);\n\t\tvec3 r = mix(vec3(0.0), aRotationParams, phase);\n\t\tfloat r2 = mix(0.0, aFreeRotation.x, phase);\n\t\tvec3 v2 = normalize(aFreeRotation.yzw);\n\n\t\tmat4 transform = prependTranslation(mat4(1.0), d.x, -1.0 * dy, d.z);\n\t\ttransform = prependRotation(transform, r.x, vec3(1.0, 0.0, 0.0), aRotationCenter);\n\t\ttransform = prependRotation(transform, r.y, vec3(0.0, 1.0, 0.0), aRotationCenter);\n\t\ttransform = prependRotation(transform, r.z, vec3(0.0, 0.0, 1.0), aRotationCenter);\n\t\ttransform = prependRotation(transform, r2, v2, aRotationCenter);\n\n\t\tvec4 n = transform * vec4(vec3(0.0, 0.0, 1.0), 0.0);\n\t\tvec4 p = transform * vec4(aVertexPosition, 1.0);\n\n\t\tgl_Position = uPMVMatrix * p;\n\t\tvTextureCoord = aTextureCoord;\n\t\tvec3 lightingDirection = vec3(0.0, 0.0, 1.0);\n\t\tvec3 transformedNormal = normalize(uNMatrix * n.xyz); \n\t\tfloat directionalLightWeighting = abs(dot(transformedNormal, lightingDirection)); \n\t\tvLightIntentsity = 0.5 + 0.5 * directionalLightWeighting;\n\t}"}bufferData(){this.webGLContext.disable(this.webGLContext.DEPTH_TEST);for(var t=[new M(.1806930693069307,0),new M(.3725247524752475,0),new M(.4603960396039604,0),new M(.6856435643564357,0),new M(.7673267326732673,0),new M(.8849009900990099,0),new M(.9987623762376238,.02103960396039604),new M(0,.027227722772277228),new M(0,.15841584158415842),new M(.47,.16955445544554457),new M(.4876237623762376,.16955445544554457),new M(.5284653465346535,.17202970297029702),new M(.41707920792079206,.1745049504950495),new M(1,.18316831683168316),new M(0,.19554455445544555),new M(.6076732673267327,.2042079207920792),new M(.32,.21658415841584158),new M(.6485148514851485,.2202970297029703),new M(.7141089108910891,.22153465346534654),new M(0,.2623762376237624),new M(.275990099009901,.2908415841584158),new M(.2524752475247525,.33292079207920794),new M(.22153465346534654,.38242574257425743),new M(.8081683168316832,.41336633663366334),new M(0,.44183168316831684),new M(.18935643564356436,.46410891089108913),new M(.4752475247524752,.47029702970297027),new M(.4665841584158416,.4715346534653465),new M(.4938118811881188,.4814356435643564),new M(.5024752475247525,.48267326732673266),new M(.5099009900990099,.4863861386138614),new M(.5123762376237624,.49133663366336633),new M(.801980198019802,.4938118811881188),new M(.5148514851485149,.49876237623762376),new M(.47896039603960394,.5),new M(.47,.5),new M(.5,.5),new M(.5148514851485149,.5012376237623762),new M(.4801980198019802,.5061881188118812),new M(.5136138613861386,.5099009900990099),new M(.48267326732673266,.5123762376237624),new M(.5099009900990099,.5136138613861386),new M(.48514851485148514,.5148514851485149),new M(.504950495049505,.5160891089108911),new M(.48886138613861385,.5185643564356436),new M(.4938118811881188,.5185643564356436),new M(.4975247524752475,.5185643564356436),new M(.5334158415841584,.5334158415841584),new M(1,.5346534653465347),new M(.4962871287128713,.5371287128712872),new M(.47648514851485146,.5396039603960396),new M(.18811881188118812,.568069306930693),new M(0,.6485148514851485),new M(.2537128712871287,.6534653465346535),new M(.7982673267326733,.6670792079207921),new M(.28589108910891087,.7066831683168316),new M(.775,.7351485148514851),new M(1,.7784653465346535),new M(.3341584158415842,.7945544554455446),new M(.7066831683168316,.8032178217821783),new M(0,.8106435643564357),new M(.38985148514851486,.8477722772277227),new M(.47,.8564356435643564),new M(.6150990099009901,.8601485148514851),new M(1,.943069306930693),new M(0,.9826732673267327),new M(.21905940594059406,1),new M(.34034653465346537,1),new M(.4752475247524752,1),new M(.6596534653465347,1),new M(.8403465346534653,1),new M(0,0),new M(1,0),new M(1,1),new M(0,1)],e=new E,i=new y(0,0,1),n=0;n<t.length;n++){var r=t[n],a=new y((r.x-.5)*this.canvasSource.width,(r.y-.5)*this.canvasSource.height,0);r=new M(r.x,r.y),R(e,new L(a,r,i))}i=this.canvasSource.height,n=this.canvasSource.width,(t=[]).push(new Pe(e,[7,71,16,0],new y(0,0,50),i)),t.push(new Pe(e,[16,0,12,1],new y(0,0,20),1.5*i,.05*n)),t.push(new Pe(e,[27,20,26,16],new y(0,0,5),1.6*i,.03*n)),t.push(new Pe(e,[21,8,16,7,-1,27,22,20,-1,22,19,21,14],new y(0,0,5),1.6*i)),t.push(new Pe(e,[21,14,8],new y(0,0,5),2*i)),t.push(new Pe(e,[27,25,22],new y(0,0,0),1.8*i)),t.push(new Pe(e,[24,25,19,22],new y(0,0,5),1.65*i)),t.push(new Pe(e,[35,25,27],new y(0,120,0),2*i)),t.push(new Pe(e,[52,51,24,25],new y(0,0,0),1.8*i)),t.push(new Pe(e,[51,38,25,34],new y(0,75,10),1.85*i,-.05*n)),Ie(t[t.length-1],0,2),t.push(new Pe(e,[65,60,55,53],new y(0,0,0),1.8*i)),t.push(new Pe(e,[67,66,61,58,50],new y(0,0,0),8*i,-.2*n,n)),t.push(new Pe(e,[55,53,42,40],new y(0,180,0),1.8*i,-.05*n)),Ie(t[t.length-1],0,1),t.push(new Pe(e,[74,66,65,58,55],new y(0,0,0),1.8*i,.02*n)),t.push(new Pe(e,[58,55,44,42],new y(0,270,90),1.8*i,-.05*n)),Ie(t[t.length-1],0,1),t.push(new Pe(e,[60,52,53,51,40,38],new y(30,60,0),2.5*i)),t.push(new Pe(e,[61,50,45,44],new y(75,180,90),i,.05*n)),t.push(new Pe(e,[49,61,46,45],new y(75,180,90),i,-.05*n)),t.push(new Pe(e,[49,62,61],new y(-360,0,0),i,-.01*n)),Ie(t[t.length-1],1,2),t.push(new Pe(e,[68,67,62,61],new y(0,0,0),i)),t.push(new Pe(e,[69,68,63,62],new y(0,0,0),i)),t.push(new Pe(e,[63,62,43,46],new y(-270,0,0),i,.01*n)),Ie(t[t.length-1],0,1),t.push(new Pe(e,[70,69,59,63],new y(0,0,0),i)),t.push(new Pe(e,[59,63,41,43],new y(-360,0,0),i,-.05*n)),Ie(t[t.length-1],0,1),t.push(new Pe(e,[73,70,64,59,56],new y(0,0,0),i,.05*n)),t.push(new Pe(e,[59,56,41],new y(-360,0,0),i,.05*n)),Ie(t[t.length-1],0,1),t.push(new Pe(e,[57,64,54,56,47],new y(-270,0,0),i)),t.push(new Pe(e,[54,47,39,41],new y(0,0,0),i,0,0,1080,e.container[54].position.clone().remove(e.container[39].position))),t.push(new Pe(e,[57,48,54,32,39,23,37],new y(0,0,0),1.5*i)),t.push(new Pe(e,[37,33,23,13,32,48],new y(0,0,0),i)),t.push(new Pe(e,[13,72,33,31],new y(0,0,0),1.5*i)),t.push(new Pe(e,[5,4,30,29],new y(0,0,5),1.2*i)),t.push(new Pe(e,[5,18,72,6],new y(0,0,0),i,-.07*n)),t.push(new Pe(e,[4,3,17,15],new y(0,0,-45),1.8*i)),t.push(new Pe(e,[2,9,3,10,3,11,3,15],new y(0,0,0),2.2*i)),t.push(new Pe(e,[17,29,11],new y(0,0,30),2*i)),t.push(new Pe(e,[11,29,10],new y(70,0,0),i,0,0,120,e.container[29].position.clone().remove(e.container[10].position))),Ie(t[t.length-1],0,2),t.push(new Pe(e,[10,29,9],new y(120,720,15),-.01*i,.15*n,0,1080,e.container[10].position.clone().remove(e.container[29].position))),t.push(new Pe(e,[6,18,31,30],new y(0,0,0),i,-.05*n,0,1080,e.container[6].position.clone().remove(e.container[30].position))),t.push(new Pe(e,[26,16,28,12],new y(40,30,0),.7*i,0,-.25*n)),t.push(new Pe(e,[2,29,1,28],new y(-80,60,0),.7*i,.05*n,-.5*n)),t.push(new Pe(e,[36,26,28],new y(270,0,720),0,.2*n,-1*n)),t.push(new Pe(e,[35,27,36,26],new y(0,180,720),0,-.15*n,-1*n)),t.push(new Pe(e,[38,34,36],new y(180,180,0),0,-.1*n,-.8*n)),t.push(new Pe(e,[40,38,36],new y(180,180,180),0,.1*n,-1*n)),t.push(new Pe(e,[42,40,36],new y(720,270,0),0,.05*n,-.6*n)),t.push(new Pe(e,[44,42,36],new y(90,120,0),0,0,-1*n)),t.push(new Pe(e,[45,44,36],new y(360,0,0),0,.07*n,-.8*n)),t.push(new Pe(e,[46,45,36],new y(0,60,180),0,.1*n,-.8*n)),t.push(new Pe(e,[43,46,36],new y(80,120,45),0,.2*n,-.5*n)),t.push(new Pe(e,[41,43,36],new y(90,360,60),0,.17*n,-.5*n)),t.push(new Pe(e,[39,41,36],new y(0,120,120),0,.15*n,-.5*n)),t.push(new Pe(e,[39,37,36],new y(90,90,90),0,.2*n,-1*n)),t.push(new Pe(e,[37,33,36],new y(0,120,90),0,.18*n,-1*n)),t.push(new Pe(e,[33,31,36],new y(45,45,0),0,.1*n,-1*n)),t.push(new Pe(e,[31,30,36],new y(270,0,45),0,.15*n,-1*n)),t.push(new Pe(e,[30,29,36],new y(90,360,60),0,0,-.8*n)),t.push(new Pe(e,[29,28,36],new y(0,120,120),0,0,-.8*n));for(var s=[],o=[],h=[],c=[],u=[],l=[],d=[],v=0,x=0;x<t.length;x++){for(var f=t[x],g=0;g<f.indecies.length;g++){var p=f.indecies[g];-1!=p?(p=e.container[p],s.push(p.position.x,-1*p.position.y,-1*p.position.z),o.push(p.texture.x,p.texture.y),h.push(f.rotationCenter.x,-1*f.rotationCenter.y,-1*f.rotationCenter.z),c.push(f.rotation.x,-1*f.rotation.y,-1*f.rotation.z),u.push(f.dx,f.acceleration,-1*f.XY),p=f.freeRotation,l.push(f.eZ,p.x,-1*p.y,-1*p.z),d.push(v),v++):(d.push(v-1),d.push(v))}d.push(v-1),d.push(v)}d.pop(),d.pop(),this.elmentCount=d.length,this.bVertextPosition=T(this.webGLContext,s,3),this.bTextureCoord=T(this.webGLContext,o,2),this.bRotationCenter=T(this.webGLContext,h,3),this.bRotationParams=T(this.webGLContext,c,3),this.bTranslationParams=T(this.webGLContext,u,3),this.bFreeRotation=T(this.webGLContext,l,4),this.bElementIndicies=A(this.webGLContext,d);var m=this.webGLContext;m.bindBuffer(m.ARRAY_BUFFER,this.bVertextPosition),m.vertexAttribPointer(this.aVertexPosition,3,m.FLOAT,!1,0,0),m.bindBuffer(m.ARRAY_BUFFER,this.bTextureCoord),m.vertexAttribPointer(this.aTextureCoord,2,m.FLOAT,!1,0,0),m.bindBuffer(m.ARRAY_BUFFER,this.bRotationCenter),m.vertexAttribPointer(this.aRotationCenter,3,m.FLOAT,!1,0,0),m.bindBuffer(m.ARRAY_BUFFER,this.bRotationParams),m.vertexAttribPointer(this.aRotationParams,3,m.FLOAT,!1,0,0),m.bindBuffer(m.ARRAY_BUFFER,this.bTranslationParams),m.vertexAttribPointer(this.aTranslationParams,3,m.FLOAT,!1,0,0),m.bindBuffer(m.ARRAY_BUFFER,this.bFreeRotation),m.vertexAttribPointer(this.aFreeRotation,4,m.FLOAT,!1,0,0),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,this.bElementIndicies)}getProperties(){super.getProperties(),this.aRotationCenter=C(this.webGLContext,this.shaderProgram,"aRotationCenter"),this.aRotationParams=C(this.webGLContext,this.shaderProgram,"aRotationParams"),this.aTranslationParams=C(this.webGLContext,this.shaderProgram,"aTranslationParams"),this.aFreeRotation=C(this.webGLContext,this.shaderProgram,"aFreeRotation")}setupData(){this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t),this.setupMatrices(),this.webGLContext.drawElements(this.webGLContext.TRIANGLE_STRIP,this.elmentCount,this.webGLContext.UNSIGNED_SHORT,0)}completed(){super.completed()}}function Ie(t,e,i){var n=t.mContainer.container[t.indecies[e]].clone().position;n=n.add(t.mContainer.container[t.indecies[i]].position.clone()),t.rotationCenter=new y(n.x/2,n.y/2,n.z/2)}function Pe(t,e,i,n,r,a,s,o){for(this.rotation=i,this.acceleration=n,r&&(this.dx=r),a&&(this.XY=a),s&&(this.eZ=s),this.freeRotation=o||new y(0,0,1),this.indecies=e,this.mContainer=t,s=a=r=n=i=0;s<e.length;s++)-1!=(o=e[s])&&(a+=1,i+=(o=t.container[o]).position.x,n+=o.position.y,r+=o.position.z);this.rotationCenter=new y(i/a,n/a,r/a)}Pe.prototype.dx=0,Pe.prototype.XY=0,Pe.prototype.eZ=0;class be extends w{opts=["DIAMONDSFROMBOTTOM","DIAMONDSFROMTOP","DIAMONDSFROMRIGHT","DIAMONDSFROMLEFT","HEXAGONSFROMBOTTOM","HEXAGONSFROMTOP","HEXAGONSFROMRIGHT","HEXAGONSFROMLEFT"];checkTypes=["DIAMONDS","HEXAGONS"];constructor(t,e,i,n){super(t,e,i,n.revert),this.type=this.opts.indexOf(n.dir)%4;for(let t=0;t<this.checkTypes.length;t++){const e=this.checkTypes[t];if(n.dir.includes(e)){this.checkType=t;break}}}checkTime=.3;maxTime=.7;drawBackground(){var t=this.canvasSource.width,e=this.canvasSource.height;this.canvasSource.getContext("2d").drawImage(this.currentImage,0,0,t,e),g(this.divContainer,this.canvasSource)}drawBackgroundPre(){this.canvasPre=n(this.canvasSource.width,this.canvasSource.height),this.canvasPre.getContext("2d").drawImage(this.preImage,0,0,this.canvasSource.width,this.canvasSource.height),g(this.divContainer,this.canvasPre)}initialize(){s(this.divContainer,"position","relative"),this.drawBackground(),this.drawBackgroundPre();var t=this.canvasPre,e=this.canvasSource;this.checkType==De?(this.columnCount=16,this.rowCount=8):(this.columnCount=16,this.rowCount=12),this.rowCountX2add=2*this.rowCount+1;var i=this.canvasSource.width/this.columnCount,n=i/2,r=this.canvasSource.height/this.rowCount,a=r/2;this.Horizontal=this.type==Oe||this.type==Be?this.canvasSource.width:this.canvasSource.height,this.HorizontalTwo=2*this.Horizontal,this.arrayCanvas=[];for(var o,h,c=-a,u=0;u<this.rowCountX2add;++u){0==u%2?(o=-n,h=this.columnCount+1):(o=0,h=this.columnCount);for(var l=0;l<h;++l){var d=ye(this,i+2,r+2),v=ye(this,i+2,r+2),x=new ze;x.ChangeFb(Math.round(o+l*i)-1),this.checkType==De?(x.ChangeGb(Math.round(c+u*a)-1),Le(t,d,x.Fb,x.Gb,i+2,r+2),Le(e,v,x.Fb,x.Gb,i+2,r+2)):(x.ChangeGb(Math.round(c+1.5*u*a)),Ee(t,d,x.Fb,x.Gb,i+2,r+2),Ee(e,v,x.Fb,x.Gb,i+2,r+2)),x.Wz=d,x.tv=v,Ve(x,!0),He(x,!1),x.mf=0,x.mu=!1,x.iA=0,this.arrayCanvas.push(x)}}}setProgress(t){if(t=super.checkRevert(t),t*=this.maxTime,this.type==_e||this.type==Be)var e=t/this.maxTime*(this.Horizontal+this.HorizontalTwo)-this.HorizontalTwo,i=e+this.HorizontalTwo;else i=(e=this.Horizontal-t/this.maxTime*(this.Horizontal+this.HorizontalTwo)+this.HorizontalTwo)-this.HorizontalTwo;for(var n,r=0;r<this.arrayCanvas.length;r++){var a=this.arrayCanvas[r];if(n=a.mu?a.mf:0,n=Math.abs(Math.cos(n)),a.rD&&!a.VJ){var s=new Me,o=a.mf;Math.PI/2<o&&o<=Math.PI?(Ve(a,!1),He(a,!0),s.scale(1*n,1),ke(a.tv,s)):o<Math.PI/2?(Ve(a,!0),He(a,!1),s.scale(1*n,1),ke(a.Wz,s)):(Ve(a,!1),He(a,!0),s.scale(1,1),ke(a.tv,s))}a.mu?(a.mf=(t-a.iA)*Math.PI/this.checkTime,a.mu=!0):0!=Ne(this,a,e)?(a.iA=t,a.mf=0,a.mu=!0,a.rD=!0):0!=(n=Ne(this,a,i))&&1<=Math.random()+n/this.HorizontalTwo&&(a.iA=t,a.mf=0,a.mu=!0,a.rD=!0),a.rD&&!a.VJ&&t-a.iA>this.checkTime&&(a.VJ=!0)}}}class Me{constructor(t,e,i,n,r,a){if(6==arguments.length)this.setTransform(t,e,i,n,r,a);else{if(0!=arguments.length)throw Error("Insufficient matrix parameters");this.Xc=this.pd=1,this.Ad=this.zd=this.Td=this.Ud=0}}scale(t,e){return this.Xc*=t,this.Ad*=t,this.zd*=e,this.pd*=e,this}}function ye(t,e,i){let r=n(e,i);return s(r,"position","absolute"),g(t.divContainer,r),r}function Le(t,e,i,n,r,a){(e=e.getContext("2d")).save(),e.fillStyle="#FFFFFF",Re(t,e,i,n),e.globalCompositeOperation="destination-in",e.beginPath();var s=Math.round(.5*r),o=Math.round(.5*a);r=Math.round(r),a=Math.round(a),e.moveTo(s,-1),e.lineTo(r+1,o),e.lineTo(s,a+1),e.lineTo(-1,o),e.lineTo(s,-1),e.fill(),e.restore()}function Ee(t,e,i,n,r,a){(e=e.getContext("2d")).save(),e.fillStyle="#FFFFFF",Re(t,e,i,n),e.globalCompositeOperation="destination-in";var s=Math.round(.5*r)+.5;r=Math.round(r)+.5;var o=Math.round(a)+.5;e.beginPath(),e.moveTo(s,-1),e.lineTo(r,Math.round(.25*a)-1),e.lineTo(r,Math.round(.75*a)+1),e.lineTo(s,o),e.lineTo(-1,Math.round(.75*a)+1),e.lineTo(-1,Math.round(.25*a)-1),e.lineTo(s,1),e.fill(),e.restore()}function Re(t,e,i,n){i=Math.round(i),n=Math.round(n),e.drawImage(t,-i,-n)}function Ne(t,e,i){switch(t.type){case Ge:return e.Gb>=i?e.Gb-i:0;case _e:return e.Gb<=i?i-e.Gb:0;case Oe:return e.Fb>=i?e.Fb-i:0}return e.Fb<=i?i-e.Fb:0}var De=0,Ge=0,_e=1,Oe=2,Be=3;class ze{constructor(){}Fb=0;Gb=0;KS=!0;LS=!0;mf=0;mu=!0;iA=0;VJ=!1;rD=!1;ChangeFb(t){this.Fb=t,this.$gChangePosition()}ChangeGb(t){this.Gb=t,this.$gChangePosition()}$gChangePosition(){null!=this.Wz&&this.KS&&h(this.Wz,this.Fb,this.Gb),null!=this.tv&&this.LS&&h(this.tv,this.Fb,this.Gb)}}function Ve(t,e){t.KS=e,null!=t.Wz&&c(t.Wz,e?1:0),e&&t.$gChangePosition()}function He(t,e){t.LS=e,null!=t.tv&&c(t.tv,e?1:0),e&&t.$gChangePosition()}function ke(t,e){!function(t,e,i){e.style[t.Az.transform]=1==i.Xc&&0==i.Ad&&0==i.zd&&1==i.pd&&0==i.Td&&0==i.Ud?"":function(t,e){return"matrix("+t.KM(e).join(",")+")"}(t,i)}(function(){if(We)return We;for(var t=null,e=function(t,e,i){return Ke(document,arguments)}("DIV"),i=[["transform",Ye,{transform:"transform",transformOrigin:"transformOrigin"}],["webkitTransform",Ye,{transform:"webkitTransform",transformOrigin:"webkitTransformOrigin"}],["msTransform",Ye,{transform:"msTransform",transformOrigin:"msTransformOrigin"}],["MozTransform",Ze,{transform:"MozTransform",transformOrigin:"MozTransformOrigin"}],["OTransform",Ye,{transform:"OTransform",transformOrigin:"OTransformOrigin"}]],n=0;n<i.length;++n)if(Ue(e.style[i[n][0]])){t=new i[n][1](i[n][2]);break}if(!t)throw Error("browser doesn't support css matrix transformation");return We=t}(),t,e)}function Xe(t){return Math.floor(1e6*t)/1e6}var We=null;function Ue(t){return void 0!==t}class Ye{constructor(t){this.Az=t}KM(t){return[Xe(t.Xc),Xe(t.Ad),Xe(t.zd),Xe(t.pd),Xe(t.Td),Xe(t.Ud)]}}function Ze(t){this.Az=t}function Ke(t,e){var i=String(e[0]),n=e[1];if(n&&(n.name||n.type)){if(i=["<",i],n.name&&i.push(' name="',Qe(n.name),'"'),n.type){i.push(' type="',Qe(n.type),'"');var r={};!function(t,e){for(var i,n,r=1;r<arguments.length;r++){for(i in n=arguments[r])t[i]=n[i];for(var a=0;a<sc.length;a++)i=sc[a],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}(r,n),delete r.type,n=r}i.push(">"),i=i.join("")}return i=t.createElement(i),n&&(function(t){return"string"==typeof t}(n)?i.className=n:function(t){return"array"==Ga(t)}(n)?i.className=n.join(" "):function(t,e){!function(t,e,i){for(var n in t)e.call(i,t[n],n,t)}(e,(function(e,i){e&&"object"==typeof e&&e.ho&&(e=e.Rk()),"style"==i?t.style.cssText=e:"class"==i?t.className=e:"for"==i?t.htmlFor=e:Fe.hasOwnProperty(i)?t.setAttribute(Fe[i],e):0==i.lastIndexOf("aria-",0)||0==i.lastIndexOf("data-",0)?t.setAttribute(i,e):t[i]=e}))}(i,n)),2<e.length&&Je(t,i,e,2),i}function Qe(t){return je.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(Jb,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Kb,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Lb,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Mb,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Nb,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(Ob,"&#0;")),t):t}var je=/[\x00&<>"']/;class qe extends w{constructor(t,e,i,n){super(t,e,i,n.revert)}initialize(){s(this.divContainer,"position","relative"),this.setInfoTransition(),this.setBackground()}setBackground(){var t=this.canvasSource.width,e=this.canvasSource.height;this.canvas1=n(t,e),this.contextCanvas1=this.canvas1.getContext("2d"),this.canvas2=n(t,e),this.contextCanvas2=this.canvas2.getContext("2d"),this.canvas3=n(t,e),this.contextCanvas3=this.canvas3.getContext("2d"),this.canvas4=n(t,e),this.contextCanvas4=this.canvas4.getContext("2d"),this.canvas5=n(t,e),this.contextCanvas5=this.canvas5.getContext("2d"),this.canvas6=n(t,e),this.contextCanvas6=this.canvas6.getContext("2d"),this.canvas7=n(t,e),this.contextCanvas7=this.canvas7.getContext("2d"),this.canvas8=n(t,e),this.contextCanvas8=this.canvas8.getContext("2d"),g(this.divContainer,this.canvas1),g(this.divContainer,this.canvas5),s(this.canvas1,"position","absolute"),s(this.canvas5,"position","absolute")}setProgress(t){t=super.checkRevert(t);var e=this.canvasSource.width,i=this.canvasSource.height;if(this.contextCanvas1.clearRect(0,0,e,i),this.contextCanvas5.clearRect(0,0,e,i),this.contextCanvas7.clearRect(0,0,e,i),this.contextCanvas6.clearRect(0,0,e,i),this.contextCanvas7.drawImage(this.preImage,0,0),this.contextCanvas7.save(),this.contextCanvas7.globalCompositeOperation="destination-in",$e(this,this.contextCanvas6,this.array1,t),this.contextCanvas7.drawImage(this.canvas6,0,0),this.contextCanvas7.restore(),ei(this,this.contextCanvas8,this.preImage,t/si,!1),this.contextCanvas5.drawImage(this.canvas7,0,0),this.contextCanvas5.drawImage(this.canvas8,0,0),t>ai&&t<1-ai){var n=H(ai,1,1-ai,4),r=H(ai,0,1-ai,-30);f(this.canvas5,"rotate("+r(t)+"deg) scale("+n(t)+", "+n(t)+")")}t>oi&&(this.contextCanvas3.clearRect(0,0,e,i),this.contextCanvas2.clearRect(0,0,e,i),this.contextCanvas3.drawImage(this.currentImage,0,0),this.contextCanvas3.save(),this.contextCanvas3.globalCompositeOperation="destination-in",$e(this,this.contextCanvas2,this.array2,t),this.contextCanvas3.drawImage(this.canvas2,0,0),this.contextCanvas3.restore(),this.contextCanvas1.drawImage(this.canvas3,0,0),t<hi?(e=(n=H(ai,.5,hi,1))(t),r=H(oi,45,hi,0),f(this.canvas1,"rotate("+r(t)+"deg) scale("+e+", "+e+")")):(ei(this,this.contextCanvas4,this.currentImage,(t-(1-si))/si,!0),this.contextCanvas1.drawImage(this.canvas4,0,0),f(this.canvas1,"rotate(0deg) scale(1, 1)")))}setInfoTransition(){this.value1=.9/(ni-1)/2,this.value2=1.154/(ri-1)/2,this.array1=[],this.array2=[],ti(this.array1,.1,.8,!0),ti(this.array2,.15,.9,!1)}}function $e(t,e,i,n){for(var r=0;r<i.length;++r){var a=i[r];if(n>=a.mH&&n<=a.mH+.05)var s=(n-a.mH)/.05,o=a.JN?1-s:s;else o=n<a.mH?a.JN?1:0:a.JN?0:1;a=t,s=e;var h=i[r].x,c=i[r].y;h*=a.canvasSource.width,c*=a.canvasSource.height,s.fillStyle="rgba(0, 0, 255, "+o+")",s.beginPath(),s.moveTo(h,c-ii(a)),s.lineTo(h+a.value1*a.canvasSource.width,c-.5*ii(a)),s.lineTo(h+a.value1*a.canvasSource.width,c+.5*ii(a)),s.lineTo(h,c+ii(a)),s.lineTo(h-a.value1*a.canvasSource.width,c+.5*ii(a)),s.lineTo(h-a.value1*a.canvasSource.width,c-.5*ii(a)),s.lineTo(h,c-ii(a)),s.fill()}}function ti(t,e,i,n){for(var r=1/(ni-1),a=1/(ri-1)+.002,s=i-e,o=Math.floor(ri/2),h=0;h<ri;++h)for(var c=0!=h%2?ni:ni-1,u=0;u<c;++u){var l={};l.x=r*u,0==h%2&&(l.x+=.5*r),l.y=a*h-.01,l.JN=n,l.mH=h==o&&u==.5*(c-1)?e:0==h||h==ri-1||0==u&&c==ni||u==ni-1&&c==ni?n?e:i:e+s*Math.random(),t.push(l)}}function ei(t,e,i,n,r){r=(n=0==r?(t.canvasSource.width+600)*n:(t.canvasSource.width+300)*(1-n))-300,e.clearRect(0,0,t.canvasSource.width,t.canvasSource.height),e.drawImage(i,0,0),e.save(),e.globalCompositeOperation="destination-out",(i=e.createLinearGradient(r,0,n,0)).addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),e.fillStyle=i,e.fillRect(0,0,t.canvasSource.width,t.canvasSource.height),e.restore()}function ii(t){return t.value2*t.canvasSource.height}var ni=10,ri=9,ai=.05,si=.15,oi=.2,hi=.9;class ci extends ct{lj=[];mL=[];iK=[];hK=[];XL=[];WL=[];opts=["LEFT","RIGHT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.M=this.opts.indexOf(n.dir)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),this.drawBackground();var e=this.canvasSource.width,i=-this.canvasSource.height/2,r=3*i/4,a=xi(new M(-(e=e/2-.2*e),-i),new M(e/2,-i/2)),o=xi(new M(-e/4,-i),new M(0,0)),h=xi(new M(e/2,-i/2),new M(e,i)),c=xi(new M(0,0),new M(e,i/4)),u=pi(a,o),l=pi(h,c),d=new M(H(0,.5,e,.8)(l.x),H(0,.5,i,1)(l.y)),v=new M(H(-e,.2,0,.5)(u.x),H(-i,0,0,.5)(u.y)),x=new y(5*e/8,3*-i/8,-10*r/16),f=new y(-e/8,-i/2,15*-r/32),p=new y(e/2,i/8,15*-r/32),m=new y(5*-e/8,5*-i/16,9*-r/8),w=new y(e/2,i/4,5*-r/6),C=new y(-e/10,i/10,-r),S=new y(4*-e/8,-i/8,3*-r/16),T=new y(-e/16,5*i/8,3*-r/16),A=new y(5*e/16,5*i/8,-r),I=new y(14*-e/32,4*-i/8,0),P=new y(4*e/8,23*i/32,0),b=new y(5*-e/16,3*-i/16,-r/4),L=new y(3*e/16,5*i/16,0);o=new y(3*-e/4,3*i/4,0),h=new Ci(new y(e,-i,0),new y(15*e/16,9*-i/16,-r),new M(.8,0)),c=new Ci(new y(7*e/8,7*-i/8,0),new y(9*e/12,-i/2,-46*r/48),new M(.7625,.0625)),a=new Ci(new y(e/2,-i,0),new y(6*e/9,8*-i/12,47*-r/48),new M(.65,0)),r=new Ci(new y(e,-i/2,0),new y(19*e/24,4*-i/9,47*-r/48),new M(.8,.25));var E=new Ci(new y(e/2,-i/2,0),x,new M(.65,.25));if(u=new Ci(new y(u.x,u.y,0),f,new M(v.x,v.y)),l=new Ci(new y(l.x,l.y,0),p,new M(d.x,d.y)),x=new Ci(new y(-e/4,-i,0),x,new M(.425,0)),w=new Ci(new y(e,i/4,0),w,new M(.8,.625)),C=new Ci(new y(0,0,0),C,new M(.5,.5)),S=new Ci(new y(-e/2,-i/2,0),S,new M(.35,.25)),T=new Ci(new y(e/2,i/2,0),T,new M(.65,.75)),m=new Ci(new y(-e,-i,0),m,new M(.2,0)),A=new Ci(new y(e,i,0),A,new M(.8,1)),I=new Ci(new y(-e,-i/2,0),I,new M(.2,.25)),P=new Ci(new y(e/2,i,0),P,new M(.65,1)),b=new Ci(new y(-e/2,0,0),b,new M(.35,.5)),L=new Ci(new y(0,i/2,0),L,new M(.5,.75)),i=new Ci(new y(-e,i,0),o,new M(.2,1)),this.lj=[h,h,c,c,a,r,c,c,a,r,E,E,a,r,u,l,E,E,a,r,u,l,x,w,E,E,u,l,C,C,u,l,C,C,S,T,u,l,x,w,m,A,u,l,S,T,m,A,C,C,b,L,S,T,S,T,m,A,I,P,S,T,I,P,b,L,C,C,b,L,i,i,b,L,I,P,i,i],this.M==mi){for(i=[],e=this.canvasSource.height,e=xi(new M(0,-e/2),new M(0,e/2)),h=0;h<this.lj.length;h++)c=this.lj[h],o=new M(c.start().x,c.start().y),a=new M(c.end().x,c.end().y),o=fi(e,o),a=fi(e,a),c=new Ci(new y(o.x,o.y,c.start().z),new y(a.x,a.y,c.end().z),new M(1-c.jF.x,c.jF.y)),i.push(c);this.lj=i}this.mL=[0,2,4,1,5,3,6,10,8,7,9,11,12,16,14,17,13,15,24,28,26,25,27,29,18,20,22,19,23,21,38,36,40,37,39,41,46,42,44,43,47,45,30,32,34,33,31,35,52,48,50,49,53,51,62,60,64,65,61,63,56,54,58,55,57,59,74,72,76,73,75,77,68,66,70,67,69,71],e=(o=(c=this.canvasSource.width)/2)-(a=.2*c),h=3*(i=-(r=this.canvasSource.height)/2)/4,c=-Math.max(c,r)/2,m=new y(-o,-i,0),r=new y(-o+a,-i,0),l=new y(-o+a,-i/2,0),I=new y(-o,0,0),E=new y(-o,i,0),P=new y(-o+a,i,0),x=new y(0,-i,c),L=di(r,new y(5*-e/8,5*-i/16,-h),.1),T=di(l,new y(14*-e/32,4*-i/8,0),.1),A=new y(0,-i/2,c),b=new y(0,i,c),u=di(P,new y(3*-e/4,3*i/4,0),.1),m=new Ci(m,x,new M(0,0)),l=new Ci(l,T,new M(.2,.25)),I=new Ci(I,A,new M(0,.5)),P=new Ci(P,u,new M(.2,1)),this.iK=[m,new Ci(r,L,new M(.2,0)),l,m,l,I,l,I,P,I,new Ci(E,b,new M(0,1)),P],this.hK=[0,1,2,3,4,5,7,6,8,9,11,10],r=new y(o-a,-i,0),I=new y(o,-i,0),u=new y(o-a,-i/2,0),b=new y(o,0,0),E=new y(o-a,i,0),L=new y(o,i,0),P=new y(o-a,i/2,0),a=di(r,new y(7*e/8,9*-i/16,-7*h/8),.1),l=new y(0,i,c),m=di(u,new y(19*e/24,4*-i/9,47*-h/48),.1),A=new y(0,-i/2,c),o=di(E,new y(5*e/16,5*i/8,-h),.1),c=new y(0,i,c),i=di(P,new y(-e/16,5*i/8,3*-h/16),.1),e=new Ci(I,l,new M(1,0)),h=new Ci(u,m,new M(.8,.25)),b=new Ci(b,A,new M(1,.5)),c=new Ci(L,c,new M(1,1)),i=new Ci(P,i,new M(.8,.75)),this.XL=[new Ci(r,a,new M(.8,0)),e,h,e,h,b,h,b,i,b,i,c,i,new Ci(E,o,new M(.8,1)),c],this.WL=[0,1,2,3,5,4,6,7,8,9,11,10,12,14,13],this.bufferData()}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler;\n\n\tconst vec3 LIGHT_DIRECTION = vec3(0.0, 0.0, 1.0);\n\tconst float AMBIENT_INTENSITY = 0.7;\n\tconst float DIFFUSE_INTENSITY = 0.3;\n\n\tvoid main(void)  \n\t{ \n\t\tfloat intentsity = AMBIENT_INTENSITY + DIFFUSE_INTENSITY * abs(dot(normalize(vNormal), LIGHT_DIRECTION));\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord); \n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a); \n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition; \n\tattribute vec3 aVertexNormal; \n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix; \n\n\tuniform mat3 uNMatrix; \n\t \n\tvarying vec2 vTextureCoord; \n\tvarying vec3 vNormal;\n\n\tvoid main(void) \n\t{ \n\t\tgl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0); \n\t\tvTextureCoord = aTextureCoord;\n\t\tvNormal = uNMatrix * aVertexNormal;\n\t}"}bufferData(){this.rk=ui(0,this.lj),this.TU=li(this,this.rk,this.mL),this.Dy=ui(0,this.iK),this.WS=li(this,this.Dy,this.hK),this.Jz=ui(0,this.XL),this.cW=li(this,this.Jz,this.WL)}setProgress(t){t=super.checkRevert(t);var e=this.canvasSource.width,i=this.canvasSource.height;if(e=Math.max(e,i),i=this.M==wi?1:-1,at(this),.1>=t)this.$B(this,t);else if(.2>=t){var n=H(.1,.1,.2,1);ot(this,-60*(t=n(t)),[1,0,0],[0,0,0]),mat4.translate(this.m4PMVMatrix,[0,0,20*-t]),this.rk=ui(t,this.lj),ot(this,-15*i*t,[0,0,1],[0,0,0])}else.4>=t?(this.rk=ui(1,this.lj),ot(this,-60,[1,0,0],[0,0,0]),ot(this,-15*i,[0,0,1],[0,0,0]),mat4.translate(this.m4PMVMatrix,[0,0,-20]),n=H(.2,0,.4,1),t=Math.pow(n(t),3),mat4.translate(this.m4PMVMatrix,[0,0,-t*e/20])):.5>t?(this.rk=ui(1,this.lj),ot(this,-60,[1,0,0],[0,0,0]),ot(this,-15*i,[0,0,1],[0,0,0]),mat4.translate(this.m4PMVMatrix,[0,0,-(20+e/20)]),t=(n=H(.4,0,.5,1))(t),mat4.translate(this.m4PMVMatrix,[0,0,-t*e/30]),vi(t,this.lj,this.rk,8)):(this.rk=ui(1,this.lj),ot(this,-60,[1,0,0],[0,0,0]),ot(this,-15*i,[0,0,1],[0,0,0]),mat4.translate(this.m4PMVMatrix,[0,0,-(20+e/20+e/30)]),vi(t=(n=H(.5,0,1,1))(t),this.lj,this.rk,40),t=k(0,1,t),mat4.translate(this.m4PMVMatrix,[i*t*e,t*e/2,t*e/2]),ot(this,-30*i*t,[0,0,1],[0,0,0]),ot(this,-60*i*t,[0,1,0],[0,0,0]));this.setupMatrices(),this.drawTransition(this.TU,this.webGLContext.TRIANGLES,this.bufferSubPosition,this.bufferSubNormal),st(this)}bufferSubPosition(t){t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(F(t.rk)))}bufferSubNormal(t){nt(t.rk,t.mL),t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(D(t.rk)))}$B(t,e){var i=H(0,0,.1,.1);t.rk=ui(i(e),t.lj),ot(t,-60*i(e),[1,0,0],[0,0,0]),i=H(0,0,.1,1),t.Dy=ui(i(e),t.iK),t.Jz=ui(i(e),t.XL),this.setupMatrices(),this.drawTransition(t.WS,t.webGLContext.TRIANGLES,(function(t){t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(F(t.Dy)))}),(function(t){nt(t.Dy,t.hK),t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(D(t.Dy)))}),t),this.drawTransition(t.cW,t.webGLContext.TRIANGLES,(function(t){t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(F(t.Jz)))}),(function(t){nt(t.Jz,t.WL),t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,new Float32Array(D(t.Jz)))}),t)}}function ui(t,e){for(var i=new E,n=new y(0,0,1),r=0;r<e.length;r++){var a=e[r],s=t;s=di(a.start(),a.end(),s),a.yI=s,e[r]=a,s=new y(a.current().x,a.current().y,a.current().z),R(i,new L(s,a.jF,n))}return i}function li(t,e,i){var n=new I,r=T(t.webGLContext,F(e),3);return n.vertexPosition=r,r=T(t.webGLContext,G(e),2),n.textureCoord=r,r=A(t.webGLContext,i),n.elementIndecies=r,t=T(t.webGLContext,D(e),3),n.vertexNormal=t,n}function di(t,e,i){var n=H(0,t.x,1,e.x),r=H(0,t.y,1,e.y),a=H(0,t.z,1,e.z);return new y(n(i),r(i),a(i))}function vi(t,e,i,n){!n||(n=50);for(var r=[new Si([0,1],0,0,-5),new Si([2,3,6,7],0,0,-5),new Si([4,8,12,18],0,0,-5),new Si([5,9,13,19],0,0,-5),new Si([20,14,26,30,42,36],0,0,15),new Si([15,21,37,43,31,27],0,0,15),new Si([44,34,52,60,54],0,0,20),new Si([35,45,55,61,53],0,0,20),new Si([40,46,56],0,0,30),new Si([41,47,57],20,20,30),new Si([58,62,74],20,20,15),new Si([75,63,59],0,0,15),new Si([76,70,71,77],0,0,-20)],a=0;a<r.length;a++){var s=r[a],o=s.Bj(),h=e[s.yg[0]],c=t,u=n,l=h.current().x+s.q0*Math.sin(c*Math.PI/2*u),d=s.sQ?H(0,h.current().y,1,h.current().y+s.sQ)(c):h.current().y;for(s=h.current().z+s.r0*Math.sin(c*Math.PI/2*u),h.yI=new y(l,d,s),l=new y(h.current().x,h.current().y,h.current().z),d=new y(0,0,1),s=0;s<o.length;s++)e[c=o[s]]=h,u=new L(l,h.jF,d),i.container[c]=u}}function xi(t,e){return new gi(t.y-e.y,e.x-t.x,t=t.x*e.y-e.x*t.y)}function fi(t,e){var i=-t.b,n=t.a;return t=2*(i=pi(t,new gi(i,n,-i*e.x-n*e.y))).x-e.x,e=2*i.y-e.y,new M(t,e)}function gi(t,e,i){this.a=t,this.b=e,this.c=i}function pi(t,e){var i=t.a*e.b-e.a*t.b;return 1e-9>Math.abs(i)?null:new M((t.b*e.c-e.b)*t.c/i,(t.c*e.a-e.c*t.a)/i)}var mi=0,wi=1;function Ci(t,e,i){this.e6=t,this.UI=e||t,this.jF=i,this.yI=new y}function Si(t,e,i,n){this.yg=t,this.q0=e,this.sQ=i,this.r0=n}Ci.prototype.start=function(){return this.e6},Ci.prototype.end=function(){return this.UI},Ci.prototype.current=function(){return this.yI},Si.prototype.Bj=function(){return this.yg};class Ti extends ct{direction;uDeltaX;uSampler2;opts=["DOUBLELEFT","DOUBLERIGHT","SINGLELEFT","SINGLERIGHT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.direction=this.opts.indexOf(n.dir)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP)}initialize(){this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[-this.canvasSource.width/2,this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground(),0==this.direction&&this.webGLContext.disable(this.webGLContext.DEPTH_TEST);var t=this.canvasSource.width,e=this.canvasSource.height,i=n(t,e);i.style.zIndex=-10,i.getContext("2d").drawImage(this.preImage,0,0,t,e),g(this.divContainer,i)}getFragmentCode(){return"precision mediump float; \n\n\tvarying vec2 vTextureCoord; \n\tvarying vec3 vNormal; \n\n\tuniform sampler2D uSampler1; \n\tuniform sampler2D uSampler2; \n\n\tconst vec3 LIGHT_DIRECTION = vec3(0.0, 0.0, 1.0); \n\tconst float AMBIENT_INTENSITY = 0.91; \n\tconst float DIFFUSE_INTENSITY = 0.09; \n\n\tvoid main(void) \n\t{ \n\t\tfloat intentsity = AMBIENT_INTENSITY + DIFFUSE_INTENSITY * abs(dot(normalize(vNormal), LIGHT_DIRECTION));\n\n\t\tvec4 textureColor; \n\t\tif (gl_FrontFacing) \n\t\t{ \n\t\t\ttextureColor = texture2D(uSampler1, vTextureCoord); \n\t\t} \n\t\telse \n\t\t{ \n\t\t\tfloat s = 1.0 - vTextureCoord.s; \n\t\t\ttextureColor = texture2D(uSampler2, vec2(s, vTextureCoord.t)); \n\t\t} \n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a); \n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\tuniform mat3 uNMatrix;\n\n\tuniform float uPhase;\n\tuniform float uDeltaX;\n\tuniform float uSlideHeight;\n\tuniform float uSlideWidth;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst float ANGLE = 180.0;\n\tconst float PHASE_OFFSET = 0.35;\n\tconst float CHANGE_PHASE = 0.25;\n\n\tconst float COEF_1 = 0.3;\n\tconst float COEF_2 = 0.5;\n\n\tfloat linearInterpolation(float x, float x0, float fx0, float x1, float fx1)\n\t{\n\t\treturn mix(fx0, fx1, (x - x0) / (x1 - x0));\n\t}\n\n\tvec2 ellipse(float angle, vec2 center, vec2 radius)\n\t{\n\t\tfloat ang = radians(angle);\n\n\t\tfloat x = center.x + radius.x * cos(ang);\n\t\tfloat y = center.y + radius.y * sin(ang);\n\n\t\treturn vec2(x, -y);\n\t}\n\tfloat PHASE_FUNC(float phase)\n\t{\n\t\treturn linearInterpolation(phase, 0.0, 0.0, CHANGE_PHASE, 1.0);\n\t}\n\n\tfloat PHASE_FUNC1(float phase)\n\t{\n\t\treturn linearInterpolation(phase, 0.0, 1.0, 1.0, 0.0);\n\t}\n\n\tfloat PHASE_FUNC2(float phase)\n\t{\n\t\treturn linearInterpolation(phase, 0.0, 1.0, 1.0, 0.5);\n\t}\n\tvec3 getNormal(vec3 v, vec2 pr)\n\t{\n\t\tfloat y = (v.y == 0.0) ? uSlideHeight : 0.0;\n\n\t\tvec3 v1Pos = vec3(v.x, y, v.z);\n\t\tvec3 v2Pos = vec3(pr.x, v.y, -pr.y);\n\n\t\tvec3 v1 = v1Pos - v;\n\t\tvec3 v2 = v2Pos - v;\n\n\t\tvec3 n = (v.x == uSlideWidth && v.y == uSlideHeight) ? cross(v1, v2) : cross(v2, v1);\n\t\tn = normalize(n);\n\t\tif (n.z < 0.0)\n\t\t{\n\t\t\tn.z = n.z * -1.0;\n\t\t}\n\t\treturn n;\n\t}"+this.getAddVertexCode()}getAddVertexCode(){switch(this.direction){case 0:return"\n\tfloat C_FUNC1(float x)\n\t{\n\t\treturn linearInterpolation(x, uSlideWidth * 0.5, 0.0, uSlideWidth, 1.0);\n\t}\n\n\tfloat PHASE_OFFSET_FUNC1(float x)\n\t{\n\t\treturn linearInterpolation(x, uSlideWidth * 0.5, PHASE_OFFSET, uSlideWidth, 0.0);\n\t}\n\n\tfloat getAngleInDoubleLeft(float x, float phase)\n\t{\n\t\tfloat angle;\n\t\tif (phase >= 0.0 && phase <= CHANGE_PHASE)\n\t\t{\n\t\t\tangle = -ANGLE * (phase + (PHASE_OFFSET_FUNC1(x) * PHASE_FUNC(phase)));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tangle = -ANGLE * (phase + PHASE_OFFSET_FUNC1(x));\n\t\t}\n\t\treturn max(angle, -ANGLE);\n\t}\n\n\tvec2 getPosition(float x)\n\t{\n\t\tfloat a = uSlideWidth * 0.5 * C_FUNC1(x);\n\t\tfloat b = a * COEF_1;\n\t\tvec2 center = vec2(uSlideWidth * 0.5, 0.0);\n\t\tfloat angle = getAngleInDoubleLeft(x, uPhase);\n\n\t\tvec2 pos = ellipse(angle, center, vec2(a, b));\n\t\tpos.y = pos.y - (b * C_FUNC1(x) * PHASE_FUNC1(uPhase));\n\t\tpos.y = max(pos.y, 1.0);\n\t\treturn pos;\n\t}\n\n\tvoid main(void)\n\t{\n\t\tvec3 pNormal;\n\t\tfloat x = aVertexPosition.x;\n\t\tif (x <= uSlideWidth * 0.5)\n\t\t{\n\t\t\tgl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0);\n\t\t\tpNormal = vec3(0.0, 0.0, 1.0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvec2 pos = getPosition(x);\n\t\t\tvec3 v = vec3(pos.x, aVertexPosition.y, pos.y);\n\t\t\tgl_Position = uPMVMatrix * vec4(v, 1.0);\n\n\t\t\tfloat nextX = x + uDeltaX;\n\t\t\tvec2 pr = getPosition(nextX);\n\t\t\tpNormal = getNormal(v, pr);\n\t\t}\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\t\tvTextureCoord = aTextureCoord;\n\t}";case 1:return"\n\tfloat C_FUNC2(float x)\n\t{\n\t\treturn linearInterpolation(x, 0.0, 1.0, uSlideWidth * 0.5, 0.0);\n\t}\n\tfloat PHASE_OFFSET_FUNC2(float x)\n\t{\n\t\treturn linearInterpolation(x, 0.0, 0.0, uSlideWidth * 0.5, PHASE_OFFSET);\n\t}\n\n\tfloat getAngleInDoubleRight(float x, float phase)\n\t{\n\t\tfloat angle;\n\t\tif (phase >= 0.0 && phase <= CHANGE_PHASE)\n\t\t{\n\t\t\tangle = ANGLE * (1.0 + phase + (PHASE_OFFSET_FUNC2(x) * PHASE_FUNC(phase)));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tangle = ANGLE * (1.0 + phase + PHASE_OFFSET_FUNC2(x));\n\t\t}\n\t\treturn min(angle, ANGLE * 2.0);\n\t}\n\n\tvec2 getPosition(float x)\n\t{\n\t\tfloat a = uSlideWidth * 0.5 * C_FUNC2(x);\n\t\tfloat b = a * COEF_1;\n\t\tvec2 center = vec2(uSlideWidth * 0.5, 0.0);\n\t\tfloat angle = getAngleInDoubleRight(x, uPhase);\n\n\t\tvec2 pos = ellipse(angle, center, vec2(a, b));\n\t\tpos.y = pos.y - (b * C_FUNC2(x) * PHASE_FUNC1(uPhase));\n\t\tpos.y = max(pos.y, 1.0);\n\t\treturn pos;\n\t}\n\n\tvoid main(void)\n\t{\n\t\tvec3 pNormal;\n\t\tfloat x = aVertexPosition.x;\n\t\tif (x >= uSlideWidth * 0.5)\n\t\t{\n\t\t\tgl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0);\n\t\t\tpNormal = vec3(0.0, 0.0, 1.0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvec2 pos = getPosition(x);\n\t\t\tvec3 v = vec3(pos.x, aVertexPosition.y, pos.y);\n\t\t\tgl_Position = uPMVMatrix * vec4(v, 1.0);\n\n\t\t\tfloat nextX = x + uDeltaX;\n\t\t\tvec2 pr = getPosition(nextX);\n\t\t\tpNormal = getNormal(v, pr);\n\t\t}\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\t\tvTextureCoord = aTextureCoord;\n\t}";case 2:return"\n\tfloat C_FUNC3(float x)\n\t{\n\t\treturn linearInterpolation(x, 0.0, 0.0, uSlideWidth, 1.0);\n\t}\n\n\tfloat PHASE_OFFSET_FUNC3(float x)\n\t{\n\t\treturn linearInterpolation(x, 0.0, 0.0, uSlideWidth, PHASE_OFFSET);\n\t}\n\n\tfloat getAngleInSingleLeft(float x, float phase)\n\t{\n\t\tfloat angle;\n\t\tif (phase >= 0.0 && phase <= CHANGE_PHASE)\n\t\t{\n\t\t\tangle = -ANGLE * (phase - (PHASE_OFFSET_FUNC3(x) * PHASE_FUNC(phase)));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tangle = -ANGLE * (phase - PHASE_OFFSET_FUNC3(x));\n\t\t}\n\t\treturn min(angle, 0.0);\n\t}\n\n\tvec2 getPosition(float x)\n\t{\n\t\tfloat a = uSlideWidth * C_FUNC3(x);\n\t\tfloat b = a * COEF_2;\n\t\tvec2 center = vec2(0.0, 0.0);\n\t\tfloat angle = getAngleInSingleLeft(x, uPhase);\n\n\t\tvec2 pos = ellipse(angle, center, vec2(a, b));\n\t\tpos.y = pos.y - (b * C_FUNC3(x) * PHASE_FUNC2(uPhase));\n\t\tpos.y = max(pos.y, 0.0);\n\t\treturn pos;\n\t}\n\n\tvoid main(void)\n\t{\n\t\tvec2 pos = getPosition(aVertexPosition.x);\n\t\tvec3 v = vec3(pos.x, aVertexPosition.y, pos.y);\n\t\tgl_Position = uPMVMatrix * vec4(v, 1.0);\n\t\tvTextureCoord = aTextureCoord;\n\n\t\tfloat nextX = aVertexPosition.x + uDeltaX;\n\t\tvec2 pr = getPosition(nextX);\n\t\tvec3 pNormal = getNormal(v, pr);\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\t}";case 3:return"\n\tfloat C_FUNC4(float x)\n\t{\n\t\treturn linearInterpolation(x, 0.0, 1.0, uSlideWidth, 0.0);\n\t}\n\n\tfloat PHASE_OFFSET_FUNC4(float x)\n\t{\n\t\treturn linearInterpolation(x, 0.0, PHASE_OFFSET, uSlideWidth, 0.0);\n\t}\n\n\tfloat getAngleInSingleRight(float x, float phase)\n\t{\n\t\tfloat angle;\n\t\tif (phase >= 0.0 && phase <= CHANGE_PHASE)\n\t\t{\n\t\t\tangle = ANGLE * (1.0 + phase - (PHASE_OFFSET_FUNC4(x) * PHASE_FUNC(phase)));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tangle = ANGLE * (1.0 + phase - PHASE_OFFSET_FUNC4(x));\n\t\t}\n\t\treturn max(angle, ANGLE);\n\t}\n\n\tvec2 getPosition(float x)\n\t{\n\t\tfloat a = uSlideWidth * C_FUNC4(x);\n\t\tfloat b = a * COEF_2;\n\t\tvec2 center = vec2(uSlideWidth, 0.0);\n\t\tfloat angle = getAngleInSingleRight(x, uPhase);\n\n\t\tvec2 pos = ellipse(angle, center, vec2(a, b));\n\t\tpos.y = pos.y - (b * C_FUNC4(x) * PHASE_FUNC2(uPhase));\n\t\tpos.y = max(pos.y, 0.0);\n\t\treturn pos;\n\t}\n\n\tvoid main(void)\n\t{\n\t\tvec2 pos = getPosition(aVertexPosition.x);\n\t\tvec3 v = vec3(pos.x, aVertexPosition.y, pos.y);\n\t\tgl_Position = uPMVMatrix * vec4(v, 1.0);\n\t\tvTextureCoord = aTextureCoord;\n\n\t\tfloat nextX = aVertexPosition.x + uDeltaX;\n\t\tvec2 pr = getPosition(nextX);\n\t\tvec3 pNormal = getNormal(v, pr);\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\t}";default:throw Error("Unknown transition page curl type")}}bufferData(){var t=_(2,40,this.canvasSource.width,this.canvasSource.height),e=B(2,40),i=new I,n=T(this.webGLContext,F(t),3);i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer=i}getProperties(){super.getProperties(),this.uDeltaX=S(this.webGLContext,this.shaderProgram,"uDeltaX"),this.uSampler=S(this.webGLContext,this.shaderProgram,"uSampler1"),this.uSampler2=S(this.webGLContext,this.shaderProgram,"uSampler2")}drawBackground(){this.texture=super.drawBackground(this.currentImage,this.uSampler,this.webGLContext.TEXTURE0,0),this.texture2=super.drawBackground(this.preImage,this.uSampler2,this.webGLContext.TEXTURE1,1)}setupData(){this.webGLContext.uniform1f(this.uSlideWidth,this.canvasSource.width),this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height),this.webGLContext.uniform1f(this.uDeltaX,this.canvasSource.width/39)}completed(){super.completed(),this.webGLContext.deleteTexture(this.texture),this.webGLContext.deleteTexture(this.texture2)}}class Ai extends ct{isLeft;uDirectionIsLeft;opts=["RIGHT","LEFT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.isLeft=this.opts.indexOf(n.dir)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t+.2),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[(this.isLeft?-1:1)*this.canvasSource.width/2,this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler;\n\n\tconst vec3 LIGHT_DIRECTION = vec3(0.0, 0.0, 1.0);\n\tconst float AMBIENT_INTENSITY = 0.4;\n\tconst float DIFFUSE_INTENSITY = 0.6;\n\n\tvoid main(void)  \n\t{ \n\t\tfloat intentsity = AMBIENT_INTENSITY + DIFFUSE_INTENSITY * abs(dot(normalize(vNormal), LIGHT_DIRECTION));\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord); \n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a); \n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\tuniform mat3 uNMatrix;\n\n\tuniform float uPhase;\n\tuniform bool uDirectionIsLeft;\n\tuniform float uSlideHeight;\n\tuniform float uSlideWidth;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst float ANGLE = 45.0;\n\tconst float PI = 3.14159265358979323846264;\n\n\tfloat linearInterpolation(float x, float x0, float fx0, float x1, float fx1)\n\t{\n\t\treturn mix(fx0, fx1, (x - x0) / (x1 - x0));\n\t}\n\n\tmat4 rotationZmatrix(float angle)\n\t{\n\t  \tfloat ang = radians(angle);\n\t  \tfloat cosA = cos(ang);\n\t  \tfloat sinA = sin(ang);\n\n\t  \tmat4 m = mat4(1.0);\n\t  \tm[0] = vec4(cosA, sinA, 0, 0);\n\t  \tm[1] = vec4(-sinA, cosA, 0, 0);\n\t  \treturn m;\n\t}\n\n\tvec3 getOriginPos(vec3 pos)\n\t{\n\t\tvec3 v = vec3(pos.x, pos.y, 0.0);;\n\t\tmat4 m;\n\n\t\tvec2 p;\n\t\tif (uDirectionIsLeft)\n\t\t{\n\t\t\tm = rotationZmatrix(ANGLE);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tv.x = pos.x - uSlideWidth;\n\t\t\tm = rotationZmatrix(-ANGLE);\n\t\t}\n\t\tv = (m * vec4(v.xyz, 1.0)).xyz;\n\t\treturn vec3(v.x, v.y, 0.0);\n\t}\n\n\tfloat calcX(float phase, float u, float r, float maxSide)\n\t{\n\t\tfloat coeff = (u < 0.0) ? -1.0 : 1.0;\n\t\tfloat centerX = linearInterpolation(phase, 0.0, maxSide, 1.0, 0.0);\n\t\tfloat m = PI * r;\n\n\t\tif (centerX > coeff * u)\n\t\t{\n\t\t\treturn u;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfloat a = 180.0 * (maxSide - centerX) / (PI * r);\n\t\t\tfloat b = linearInterpolation(coeff * u, centerX, -90.0, maxSide + 1.0, a - 90.0);\n\n\t\t\tif (coeff * u >= centerX + m)\n\t\t\t{\n\t\t\t\treturn coeff * (centerX - (coeff * u - centerX - m));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfloat ang = b * PI / 180.0;\n\t\t\t\treturn coeff * (centerX + r * cos(ang));\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat calcY(float phase, float u, float r, float maxSide)\n\t{\n\t\tu = abs(u);\n\n\t\tfloat centerX = linearInterpolation(phase, 0.0, maxSide, 1.0, 0.0);\n\t\tfloat centerY = r;\n\n\t\tfloat m = PI * r;\n\t\tif (centerX >= u)\n\t\t{\n\t\t\treturn 0.0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (u > centerX + m)\n\t\t\t{\n\t\t\t\treturn linearInterpolation(u, centerX + m, r * 2.0, centerX + m + m, r * 2.5);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfloat a = 180.0 * (maxSide - centerX) / (PI * r);\n\t\t\t\tfloat b = linearInterpolation(u, centerX, -90.0, maxSide+1.0, a - 90.0);\n\n\t\t\t\tfloat ang = b * PI / 180.0;\n\t\t\t\treturn centerY + r * sin(ang);\n\t\t\t}\n\t\t}\n\t}\n\n\tvec3 getVertexPosition(float phase, vec3 pos)\n\t{\n\t\tvec3 originPos = getOriginPos(pos);\n\t\tfloat maxSide = sqrt(uSlideWidth * uSlideWidth + uSlideHeight * uSlideHeight);\n\n\t\tfloat r = max(uSlideWidth, uSlideHeight) / 4.0;\n\t\tvec3 v = vec3(calcX(phase, originPos.x, r, maxSide), originPos.y, calcY(phase, originPos.x, r, maxSide));\n\n\t\tmat4 m;\n\t\tif (uDirectionIsLeft)\n\t\t{\n\t\t\tm = rotationZmatrix(-ANGLE);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tm = rotationZmatrix(ANGLE);\n\t\t}\n\n\t\treturn (m * vec4(v.xyz, 1.0)).xyz;\n\t}\n\n\tvec3 getVertexNormal(float phase, vec3 pos)\n\t{\n\t\tconst float DELTA_W = 1.0;\n\t\tconst float DELTA_H = 1.0;\n\n\t\tvec3 right = getVertexPosition(phase, vec3(pos.x + DELTA_W, pos.y, pos.z));\n\t\tvec3 down = getVertexPosition(phase, vec3(pos.x, pos.y + DELTA_H, pos.z));\n\t\tvec3 p = getVertexPosition(phase, vec3(pos.x, pos.y, pos.z));\n\n\t\tvec3 v1 = right - p;\n\t\tvec3 v2 = down - p;\n\n\t\treturn normalize(cross(v2, v1));\n\t}\n\n\tvoid main(void)\n\t{\n\t\tfloat phase = uPhase;\n\t\tvec3 vertex = vec3(aVertexPosition.x, aVertexPosition.y, aVertexPosition.z);\n\t\tvec4 p = vec4(getVertexPosition(phase, vertex), 1.0);\n\t\tgl_Position = uPMVMatrix * p;\n\t\tvTextureCoord = aTextureCoord;\n\n\t\tvec3 pNormal = getVertexNormal(phase, vertex);\n\t\tvec3 transformedNormal = uNMatrix * pNormal;\n\t\tvNormal = transformedNormal;\n\t}"}bufferData(){var t=_(30,30,this.canvasSource.width,this.canvasSource.height),e=B(30,30),i=new I,n=T(this.webGLContext,F(t),3);i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer=i}getProperties(){super.getProperties(),this.uDirectionIsLeft=S(this.webGLContext,this.shaderProgram,"uDirectionIsLeft")}setupData(){this.webGLContext.uniform1f(this.uSlideWidth,this.canvasSource.width),this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height),this.webGLContext.uniform1f(this.uDirectionIsLeft,this.isLeft)}completed(){super.completed()}}class Ii extends ct{constructor(t,e,i,n){super(t,i,e,n.revert)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP)}initialize(){this.drawCurrentBackground(),this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[-this.canvasSource.width/2,this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler;\n\n\tconst vec3 LIGHT_DIRECTION = vec3(0.0, 0.0, 1.0);\n\tconst float AMBIENT_INTENSITY = 0.3;\n\tconst float DIFFUSE_INTENSITY = 0.7;\n\n\tvoid main(void)\n\t{\n\t\tfloat intentsity = AMBIENT_INTENSITY + DIFFUSE_INTENSITY * abs(dot(normalize(vNormal), LIGHT_DIRECTION));\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord);\n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a);\n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec3 aVertexNormal;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\tuniform mat3 uNMatrix;\n\n\tuniform float uPhase;\n\tuniform float uSlideHeight;\n\tuniform float uSlideWidth;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst float START_EFFECT_TIME = 0.0;\n\tconst float START_FLY_EFFECT_TIME = 0.4;\n\tconst float STOP_FLY_EFFECT_TIME = 0.8;\n\tconst float START_TOP_CENTER = 0.0;\n\tconst float START_TOP_CORNERS_TIME = 0.1;\n\tconst float START_BOTTOM_CORNERS_TIME = 0.0;\n\n\tconst float HORIZONTAL_WAVES_COUNT = 3.0;\n\tfloat HORIZONTAL_MAX_AMPLITUDE;\n\tconst float HORIZONTAL_WAVE_RUNNING_START_TIME = 0.0;\n\n\tconst float MAX_FLEX_DELAY = 0.1;\n\n\tfloat MAX_STRETCHING_Z;\n\tfloat MAX_STRETCHING_Y;\n\tfloat HORIZONTAL_TOP_STRETCHING;\n\tfloat VERTICAL_TOP_STRETCHING;\n\n\tconst float PI = 3.141592654;\n\n\tfloat linearInterpolation(float x, float x0, float fx0, float x1, float fx1)\n\t{\n\t\treturn mix(fx0, fx1, (x - x0) / (x1 - x0));\n\t}\n\tvec2 getMirrorPoint(vec2 a, vec2 b, vec2 p)\n\t{\n\t\treturn a + reflect(a - p, b - a);\n\t}\n\tfloat calcCenterWave(float x, float phase, float A, float F, float dx, float dy)\n\t{\n\t\tfloat CENTER_LINE_POS = uSlideWidth * 0.5;\n\t\tfloat startX = CENTER_LINE_POS;\n\t\tif (x < startX)\n\t\t{\n\t\t\tx = getMirrorPoint(vec2(CENTER_LINE_POS, 0), vec2(CENTER_LINE_POS , uSlideHeight), vec2(x, 0)).x;\n\t\t}\n\t\tfloat s = linearInterpolation(phase, 0.0, startX, 1.0, uSlideWidth);\n\t\tif ((x < startX) || (x < s))\n\t\t{\n\t\t\treturn 0.0;\n\t\t}\n\t\tfloat x0 = - linearInterpolation(phase, 0.0, 2.0 * PI * startX / uSlideWidth * HORIZONTAL_WAVES_COUNT, 1.0, PI * 2.0 * HORIZONTAL_WAVES_COUNT);\n\t\treturn A + A * sin(F * x +-PI / 2.0 + x0);\n\t}\n\tfloat getColWaveDelay(float phase, vec3 pos)\n\t{\n\t\tphase = linearInterpolation(phase, HORIZONTAL_WAVE_RUNNING_START_TIME, 0.0, 1.0, 1.0);\n\t\tfloat MAX_AMPLITUDE = linearInterpolation(phase, 0.0, 0.0, 1.0, HORIZONTAL_MAX_AMPLITUDE);\n\t\tfloat A = linearInterpolation(pos.y, 0.0, 0.0, uSlideHeight, MAX_AMPLITUDE);\n\t\tfloat F = (PI * 2.0 / uSlideWidth) * HORIZONTAL_WAVES_COUNT;\n\t\treturn calcCenterWave(pos.x, phase, A, F, 0.0, 0.0);\n\t}\n\tvec3 getVertexPosition(float phase, vec3 pos)\n\t{\n\t\tfloat CENTER = uSlideWidth * 0.5;\n\t\tphase = pow(phase, 4.0);\n\t\tfloat modifiedPhase = phase;\n\n\t\tfloat deltaZVertical = linearInterpolation(abs(pos.y), 0.0, 1.0, uSlideHeight / 2.0, 0.0);\n\t\tif (abs(pos.y) > uSlideHeight * 0.5)\n\t\t{\n\t\t\tdeltaZVertical = 0.0;\n\t\t}\n\t\tbool isLeft = (pos.x < CENTER);\n\t\tfloat stretch;\n\t\tfloat yDelay;\n\t\tvec3 delta = vec3(0, 0, 0);\n\t\tif (modifiedPhase > START_TOP_CENTER)\n\t\t{\n\t\t\tif (isLeft)\n\t\t\t{\n\t\t\t\tyDelay = linearInterpolation(pos.x, 0.0, MAX_FLEX_DELAY, CENTER, 0.0);\n\t\t\t\tstretch = linearInterpolation(pos.x, 0.0, 0.0, CENTER, 1.0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tyDelay = linearInterpolation(pos.x, CENTER, 0.0, uSlideWidth, MAX_FLEX_DELAY);\n\t\t\t\tstretch = linearInterpolation(pos.x, CENTER, 1.0, uSlideWidth, 0.0);\n\t\t\t}\n\t\t\tfloat deltaZHorizontal = pow(stretch, 3.0);\n\t\t\tmodifiedPhase = linearInterpolation(modifiedPhase, START_TOP_CENTER, 0.0, 1.0, 1.0);\n\t\t\tif (modifiedPhase >= yDelay)\n\t\t\t{\n\t\t\t\tdelta.y = linearInterpolation(modifiedPhase, yDelay, 0.0, 1.0, MAX_STRETCHING_Y * deltaZHorizontal * deltaZVertical);\n\t\t\t\tdelta.z = linearInterpolation(modifiedPhase, yDelay, 0.0, 1.0, MAX_STRETCHING_Z * deltaZHorizontal * deltaZVertical);\n\t\t\t}\n\t\t\tdelta.y = -delta.y;\n\t\t}\n\t\tif (phase > HORIZONTAL_WAVE_RUNNING_START_TIME)\n\t\t{\n\t\t\tdelta.z += getColWaveDelay(phase, pos);\n\t\t}\n\t\treturn pos - delta;\n\t}\n\tfloat getPower(float h1, float h2, float v1, float v2, vec2 pos, float max2)\n\t{\n\t  float a1 = min(max(linearInterpolation(pos.x, h1, 1.0, h2, 0.0), 0.0), 1.0);\n\t  float a2 = linearInterpolation(pos.y, v1, 1.0, v2, max2);\n\t  return a1 * a2;\n\t}\n\tvec3 updateVertex(float phase, vec3 translation)\n\t{\n\t\tfloat pPhase = phase;\n\t\tvec3 delta = vec3(0, 0, 0);\n\t\tvec3 v0 = getVertexPosition(phase, aVertexPosition);\n\n\t\tif (phase > START_TOP_CORNERS_TIME)\n\t\t{\n\t\t\tpPhase = linearInterpolation(phase, START_TOP_CORNERS_TIME, 0.0, 1.0, 1.0);\n\t\t\tpPhase = pow(pPhase, 4.0);\n\n\t\t\tfloat p1 = getPower(0.0, uSlideWidth * 0.5, 0.0, uSlideHeight, v0.xy, 2.0);\n\t\t\tfloat p2 = getPower(uSlideWidth, uSlideWidth * 0.5, 0.0, uSlideHeight, v0.xy, 2.0);\n\n\t\t\tdelta += vec3(p2 - p1, -p1 - p2, 0) * vec3(HORIZONTAL_TOP_STRETCHING, VERTICAL_TOP_STRETCHING, 0)  * vec3(pPhase, pPhase, 0);\n\t\t}\n\t\tif (phase > START_BOTTOM_CORNERS_TIME)\n\t\t{\n\t\t\tpPhase = linearInterpolation(phase, START_BOTTOM_CORNERS_TIME, 0.0, 1.0, 1.0);\n\t\t\tpPhase = pow(pPhase, 4.0);\n\n\t\t\tfloat p1 = getPower(0.0, uSlideWidth * 0.25, uSlideHeight, 0.0, v0.xy, 0.0);\n\t\t\tfloat p2 = getPower(uSlideWidth, uSlideWidth * 0.75, uSlideHeight, 0.0, v0.xy, 0.0);\n\n\t\t\tdelta += vec3(0.5, 1, 0.25) * vec3(p2 - p1, p2, p2) * vec3(uSlideWidth, uSlideHeight, uSlideHeight) * vec3(pPhase, pPhase, pPhase);\n\t\t}\n\t\tdelta.y = -min(uSlideHeight * 0.75, abs(delta.y));\n\t\treturn (translation + v0 + delta);\n\t}\n\tvec3 getPosition(float phase, vec3 pos)\n\t{\n\t  \tfloat maxSide = sqrt(uSlideHeight * uSlideHeight + (uSlideWidth * 0.5) *  (uSlideWidth * 0.5)) * 2.0;\n\t\tvec3 translation = vec3(0.0);\n\t\tif ((phase >= START_FLY_EFFECT_TIME) && (phase <= STOP_FLY_EFFECT_TIME))\n\t\t{\n\t\t\tfloat modifiedPhase = linearInterpolation(phase, START_FLY_EFFECT_TIME, 0.0, STOP_FLY_EFFECT_TIME, 1.0);\n\t\t\tmodifiedPhase = pow(modifiedPhase, 4.0);\n\t\t\ttranslation = vec3(0.0, modifiedPhase * maxSide, 0.0);\n\t\t}\n\t\telse if (phase > STOP_FLY_EFFECT_TIME)\n\t\t{\n\t\t\ttranslation = vec3(0.0, maxSide, 0.0);\n\t\t}\n\t\tif (phase >= START_EFFECT_TIME)\n\t\t{\n\t\t\tfloat modifiedPhase = linearInterpolation(phase, START_EFFECT_TIME, 0.0, 1.0, 1.0);\n\t\t\treturn updateVertex(modifiedPhase, translation);\n\t\t}\n\t\treturn updateVertex(0.0, translation);\n\t}\n\n\tvec3 getVertexNormal(float phase, vec3 pos)\n\t{\n\t\tfloat deltaWidth = (pos.x == uSlideWidth) ? -1.0 : 1.0;\n\t\tfloat deltaHeight = 1.0;\n\n\t\tvec3 right = getVertexPosition(phase, vec3(pos.x + deltaWidth, pos.y, pos.z));\n\t\tvec3 down = getVertexPosition(phase, vec3(pos.x, pos.y + deltaHeight, pos.z));\n\t\tvec3 p = getVertexPosition(phase, vec3(pos.x, pos.y, pos.z));\n\n\t\tvec3 v1 = right - p;\n\t\tvec3 v2 = down - p;\n\n\t\tvec3 n = (pos.x == uSlideWidth) ? cross(v1, v2) : cross(v2, v1);\n\t\tn = normalize(n);\n\n\t\treturn n;\n\t}\n\tvoid main()\n\t{\n\t\tMAX_STRETCHING_Z = 0.74 * uSlideHeight;\n\t\tMAX_STRETCHING_Y = 0.74 * uSlideHeight;\n\t\tHORIZONTAL_TOP_STRETCHING = 0.42 * uSlideWidth;\n\t\tVERTICAL_TOP_STRETCHING = 0.05 * uSlideHeight;\n\t\tHORIZONTAL_MAX_AMPLITUDE = 0.93 * uSlideHeight;\n\n\t  \tvTextureCoord = aTextureCoord;\n\n\t\tvec3 vertex = vec3(aVertexPosition.x, -aVertexPosition.y, aVertexPosition.z);\n\t\tvec4 p = vec4(getPosition(uPhase, vertex), 1.0);\n\t\tgl_Position = uPMVMatrix * p;\n\n\t\tvec3 transformedNormal = uNMatrix * getVertexNormal(uPhase, vertex);\n\t\tvNormal = transformedNormal;\n\t}"}bufferData(){var t=_(10,35,this.canvasSource.width,this.canvasSource.height),e=B(10,35),i=new I,n=T(this.webGLContext,F(t),3);i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer=i}getProperties(){super.getProperties()}setupData(){this.webGLContext.uniform1f(this.uSlideWidth,this.canvasSource.width),this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height)}completed(){super.completed()}}class Pi extends w{opts=["FROMTOP","FROMRIGHT","FROMLEFT","FROMBOTTOM"];constructor(t,e,i,n,r,a,s){super(t,e,i,n.revert),this.direction=this.opts.indexOf(n.dir),this.isPan=r,this.foreground=a,this.preForeground=s}initialize(){if(this.isPan){var t=this.canvasSource.width,e=this.canvasSource.height,i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.currentImage,0,0),this.cCurrentBackground=i,s(i=n(t,e),"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.cPreBackground=i}g(this.divContainer,this.canvasSource)}setProgress(t){t=super.checkRevert(t),this.isPan&&c(this.cPreBackground,1-2*(t-0));var e=this.canvasSource.width,i=this.canvasSource.height,n=e*k(0,e,Math.floor(t*e)),r=i*k(0,i,Math.floor(t*i)),a=this.canvasSource.getContext("2d");switch(a.clearRect(0,0,e,i),this.direction){case bi:this.isPan?(a.drawImage(this.foreground,0,r-i,e,i),this.preForeground&&a.drawImage(this.preForeground,0,r,e,i)):(a.drawImage(this.currentImage,0,r-i,e,i),this.preImage&&a.drawImage(this.preImage,0,r,e,i));break;case Mi:this.isPan?(a.drawImage(this.foreground,e-n,0,e,i),this.preForeground&&a.drawImage(this.preForeground,-n,0,e,i)):(a.drawImage(this.currentImage,e-n,0,e,i),this.preImage&&a.drawImage(this.preImage,-n,0,e,i));break;case yi:this.isPan?(a.drawImage(this.foreground,n-e,0,e,i),this.preForeground&&a.drawImage(this.preForeground,n,0,e,i)):(a.drawImage(this.currentImage,n-e,0,e,i),this.preImage&&a.drawImage(this.preImage,n,0,e,i));break;case Li:this.isPan?(a.drawImage(this.foreground,0,i-r,e,i),this.preForeground&&a.drawImage(this.preForeground,0,-r,e,i)):(a.drawImage(this.currentImage,0,i-r,e,i),this.preImage&&a.drawImage(this.preImage,0,-r,e,i))}}}var bi=0,Mi=1,yi=2,Li=3;class Ei extends w{opts=["HORIZONTAL","VERTICAL"];constructor(t,e,i,n){super(t,i,e,n.revert),this.direction=this.opts.indexOf(n.dir),this.drawingItems=[];var r=this.canvasSource.width;switch(this.direction){case Ni:r=this.canvasSource.height;break;case Fi:r=this.canvasSource.width}this.numOfElement=Math.floor(r/7);for(var a=[],s=0;s<this.numOfElement;s++)a.push({index:s,startTime:Math.random()});for(a.sort((function(t,e){return t.startTime<e.startTime?-1:t.startTime>e.startTime?1:0})),s=0;s<this.numOfElement;s++){var o=a[s].index;o=o==this.numOfElement-1?1:o/this.numOfElement,this.drawingItems.push(new Ri(o,.8*s/(this.numOfElement-1)))}}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),g(this.divContainer,this.canvasSource),this.context=this.canvasSource.getContext("2d")}setProgress(t){t=super.checkRevert(t);var e=this.canvasSource.width,i=this.canvasSource.height,n=this.context;n.clearRect(0,0,e,i),n.drawImage(this.currentImage,0,0),this.isRevert&&(t=1-t),n.save(),n.globalCompositeOperation="destination-out";for(var r=this.isRevert?"#FFF":"rgba(255,255,255,0)",a=this.isRevert?"rgba(255,255,255,0)":"#FFF",s=this.direction==Ni?n.createLinearGradient(e/2,0,e/2,i):n.createLinearGradient(0,i/2,e,i/2),o=0;o<this.numOfElement;o++){var h=this.drawingItems[o].offset,c=Math.min((t-this.drawingItems[o].startTime)/.2,1);this.isRevert&&(c=1-c);var u=Math.floor(1e6*c)/1e6;t>=this.drawingItems[o].startTime+.2?s.addColorStop(h,a):t>=this.drawingItems[o].startTime?s.addColorStop(h,"rgba(255,255,255,"+u+")"):s.addColorStop(h,r)}n.fillStyle=s,n.beginPath(),n.rect(0,0,e,i),n.fill(),n.restore()}}class Ri{constructor(t,e){this.offset=t,this.startTime=e}}var Ni=0,Fi=1;class Di extends ct{direction;opts=["CENTER","FROMBOTTOMLEFT","FROMBOTTOMRIGHT","FROMTOPLEFT","FROMTOPRIGHT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.direction=this.opts.indexOf(n.dir)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP)}initialize(){this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[-this.canvasSource.width/2,this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float;\n\n\tvarying mediump vec2 vTextureCoord;\n\tvarying mediump float vShadow;\n\tvarying mediump float vAlpha;\n\n\tuniform sampler2D uSampler1;\n\tuniform sampler2D uSampler2;\n\n\tvoid main(void)  \n\t{ \n\t\tif (vTextureCoord.x < 0.0 || vTextureCoord.x > 1.0 || vTextureCoord.y < 0.0 || vTextureCoord.y > 1.0) \n\t\t{ \n\t\t\tgl_FragColor = mix(vec4(0.0), vec4(0.0), 0.0);\n\t\t\treturn;\n\t\t} \n\t\tvec4 color1 = texture2D(uSampler1, vTextureCoord);\n\t\tvec4 color2 = texture2D(uSampler2, vTextureCoord);\n\t\tvec4 mixedColor = mix(color1, color2, vAlpha);\n\t\tgl_FragColor = vec4(vShadow * mixedColor.rgb, mixedColor.a);\n\t}"}getVertexCode(){return"precision mediump float;\n\n\tattribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\tuniform mat3 uNMatrix;\n\n\tconst float FREQUENCY = 12.566371; // 4.0 * PI\n\tconst float SHADOW = 0.3;\n\n\tuniform float uPhase;\n\tuniform vec2 uSlideSize;\n\tuniform vec2 uWaveCenter;\n\tuniform float uWaveRadius;\n\n\tvarying mediump vec2 vTextureCoord;\n\tvarying mediump float vShadow;\n\tvarying mediump float vAlpha;\n\n\tvoid main(void)\n\t{\n\t\tvec2 texCoord = aTextureCoord;\n\t\tvec2 screenCoord = texCoord * uSlideSize;\n\t\tvec2 centerToPoint = screenCoord - uWaveCenter;\n\n\t\tfloat angle = atan(centerToPoint.y, centerToPoint.x);\n\t\tfloat radius = length(centerToPoint);\n\n\t\tfloat phaseOffset = radius / uWaveRadius;\n\t\tfloat phaseOffsetFixed = (uPhase + uPhase) - phaseOffset;\n\t\tfloat offset = sin(phaseOffsetFixed * FREQUENCY) * smoothstep(1.0, 0.85, phaseOffsetFixed)  *  smoothstep(0.0, 0.15, phaseOffsetFixed) * (phaseOffset);\n\n\t\tfloat AMPLITUDE = min(uSlideSize.x, uSlideSize.y) / 15.0;\n\t\tradius = radius + offset * AMPLITUDE;\n\t\tcenterToPoint = vec2(radius * cos(angle), radius * sin(angle));\n\n\t\ttexCoord =(uWaveCenter + centerToPoint) / uSlideSize;\n\t\tfloat alpha = smoothstep(0.0, 1.0, phaseOffsetFixed);\n\t\tfloat shadow = (1.0 - SHADOW * abs(offset));\n\n\t\tvTextureCoord = texCoord;\n\t\tvShadow = shadow;\n\t\tvAlpha = alpha;\n\n\t\tgl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0);\n\t}"}bufferData(){var t=_(50,50,this.canvasSource.width,this.canvasSource.height),e=B(50,50),i=new I,n=T(this.webGLContext,F(t),3);i.vertexPosition=n,n=T(this.webGLContext,G(t),2),i.textureCoord=n,n=A(this.webGLContext,e),i.elementIndecies=n,this.bufferContainer=i}getProperties(){super.getProperties(),this.uSampler=S(this.webGLContext,this.shaderProgram,"uSampler1"),this.uSampler2=S(this.webGLContext,this.shaderProgram,"uSampler2"),this.uSlideSize=S(this.webGLContext,this.shaderProgram,"uSlideSize"),this.uWaveCenter=S(this.webGLContext,this.shaderProgram,"uWaveCenter"),this.uWaveRadius=S(this.webGLContext,this.shaderProgram,"uWaveRadius")}setupData(){var t=this.canvasSource.width,e=this.canvasSource.height,i=null;switch(this.direction){case Gi:i=new M(t/2,e/2);break;case _i:i=new M(0,e);break;case Oi:i=new M(t,e);break;case Bi:i=new M(0,0);break;case zi:i=new M(t,0);break;default:throw Error("Unknown direction")}var n=0;n=this.direction==Gi?Math.sqrt(i.x*i.x+i.y*i.y):Math.sqrt(t*t+e*e),this.webGLContext.uniform2fv(this.uSlideSize,[t,e]),this.webGLContext.uniform2fv(this.uWaveCenter,[i.x,i.y]),this.webGLContext.uniform1f(this.uWaveRadius,n)}drawBackground(){this.texture=super.drawBackground(this.currentImage,this.uSampler,this.webGLContext.TEXTURE0,0),this.texture2=super.drawBackground(this.preImage,this.uSampler2,this.webGLContext.TEXTURE1,1)}completed(){super.completed()}}var Gi=0,_i=1,Oi=2,Bi=3,zi=4;class Vi extends w{constructor(t,e,i,n){super(t,e,i,n.revert)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),g(this.divContainer,this.canvasSource),this.context=this.canvasSource.getContext("2d")}setProgress(t){var e=this.canvasSource.width,i=this.canvasSource.height;this.context.clearRect(0,0,e,i),this.context.drawImage(this.currentImage,0,0),this.context.save();var n=t*Math.max(e,i);this.context.globalCompositeOperation="destination-in";var r=this.context.createRadialGradient(e/2,i/2,t*n,e/2,i/2,n);r.addColorStop(0,"#FFFFFF"),r.addColorStop(.15,"rgba(255,255,255,128)"),r.addColorStop(1,"rgba(255,255,255,0)"),this.context.fillStyle=r,this.context.beginPath(),this.context.arc(e/2,i/2,n,0,2*Math.PI,!0),this.context.fill(),this.context.restore()}}class Hi extends w{constructor(t,e,i,n){super(t,e,i,n.revert)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),g(this.divContainer,this.canvasSource),this.context=this.canvasSource.getContext("2d")}setProgress(t){if(0!=(t=super.checkRevert(t))){var e=this.canvasSource.width,i=this.canvasSource.height,n=this.currentImage,r=this.context;r.clearRect(0,0,e,i),r.drawImage(n,0,0),r.save(),r.globalCompositeOperation="destination-out",n=this.getGradient(e/2,i/2,e/2+e*t,i/2+i*t,t,!1,!1),r.fillStyle=n,r.beginPath(),r.rect(e/2,i/2,e/2,i/2),r.fill(),n=this.getGradient(e/2,i/2,e/2+e*t,-t*i+i/2,t,!0,!1),r.fillStyle=n,r.beginPath(),r.rect(e/2,0,e/2,i/2),r.fill(),n=this.getGradient(e/2,i/2,-t*e+e/2,i/2+i*t,t,!1,!0),r.fillStyle=n,r.beginPath(),r.rect(0,i/2,e/2,i/2),r.fill(),t=this.getGradient(e/2,i/2,-t*e+e/2,-t*i+i/2,t,!0,!0),r.fillStyle=t,r.beginPath(),r.rect(0,0,e/2,i/2),r.fill(),r.restore()}}getGradient(t,e,i,n,r,a,s){var o=this.context,h=this.canvasSource.width<this.canvasSource.height?o.createLinearGradient(t,e,(s?-t:t)*r*2+i,n):o.createLinearGradient(t,e,i,(a?-e:e)*r*2+n);return h.addColorStop(0,"rgba(255,255,255,0)"),h.addColorStop(.2<r?r-.2:0,"rgba(255,255,255,0)"),h.addColorStop(r,"rgba(255,255,255,128)"),h.addColorStop(.8>r?r+.2:1,"#FFFFFF"),h.addColorStop(1,"#FFFFFF"),h}}class ki extends w{constructor(t,e,i,n){super(t,i,e,n.revert)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),g(this.divContainer,this.canvasSource)}setProgress(t){var e=this.canvasSource.width,i=this.canvasSource.height,n=(e/2+50)*(1-t),r=n-50,a=(i/2+50)*(1-t),s=a-50,o=this.canvasSource.getContext("2d");o.clearRect(0,0,e,i),o.drawImage(this.currentImage,0,0),o.save(),o.globalCompositeOperation="destination-out";var h=o.createLinearGradient(0,a,0,s);h.addColorStop(0,"rgba(255, 255, 255, 1)"),h.addColorStop(1,"rgba(255, 255, 255, 0)");var c=o.createLinearGradient(n,0,r,0);c.addColorStop(0,"rgba(255, 255, 255, 1)"),c.addColorStop(1,"rgba(255, 255, 255, 0)"),r=e/2+(e/2+50)*t;var u=o.createLinearGradient(r-50,0,r,0);u.addColorStop(0,"rgba(255, 255, 255, 1)"),u.addColorStop(1,"rgba(255, 255, 255, 0)"),s=i/2+(i/2+50)*t;var l=o.createLinearGradient(0,s-50,0,s);l.addColorStop(0,"rgba(255, 255, 255, 1)"),l.addColorStop(1,"rgba(255, 255, 255, 0)"),o.fillStyle=h,o.fillRect(0,0,e/2,i/2),o.fillStyle=c,o.fillRect(0,0,e/2,i/2),o.fillStyle=l,o.fillRect(0,i/2,e/2,i/2),o.fillStyle=c,o.fillRect(0,i/2,e/2,i/2),o.fillStyle=h,o.fillRect(e/2,0,e/2,i/2),o.fillStyle=u,o.fillRect(e/2,0,e/2,i/2),o.fillStyle=l,o.fillRect(e/2,i/2,e/2,i/2),o.fillStyle=u,o.fillRect(e/2,i/2,e/2,i/2),o.restore()}}class Xi extends w{opts=["STRIPSIN","STRIPSOUT","PARTICLESIN","PARTICLESOUT"];constructor(t,e,i,n){super(t,e,i,n.revert),this.shredType=this.opts.indexOf(n.dir)}initialize(){this.dI=this.sX=!1,this.afterSharedItem=[],this.beforeShredItems=[];var t=this.canvasSource.width,e=this.canvasSource.height;this.length=Math.max(t,e);var i=this.getShredDivContainer(this.divContainer,t,e,!0);if(u(i,this.length+"px"),this.divTransition=this.getShredDivContainer(i,t,e,!0),this.divBefore=this.getShredDivContainer(this.divTransition,t,e,!0),this.divAfter=this.getShredDivContainer(this.divTransition,t,e,!0),s(this.divAfter,"visibility","hidden"),2==this.shredType||3==this.shredType){t=4,e=this.isRevert?this.currentImage:this.preImage;for(var n=this.isRevert?this.preImage:this.currentImage,r=this.canvasSource.width,a=this.canvasSource.height,o=t/2-1,c=0;c<t;c++){var l=.05+.05*Math.random(),d=c<=o?-1:1,v=Math.floor((200*Math.random()+50)*(.5>Math.random()?-1:1));this.beforeShredItems[c]=this.getShredItem(this.divBefore,r,a,l,v,d),this.afterSharedItem[c]=this.getShredItem(this.divAfter,r,a,l,v,d)}for(r/=128,a/=96,o=0,d=[],c=0;128>c;++c){l=0,v=Math.round((c+1)*r)-o;for(var x=o,f=0;96>f;++f){if(0==d.length)for(var g=0;g<t;++g)d[g]=g;g=Math.round((f+1)*a)-l;var p=l,m=Math.floor(d.length*Math.random()),w=d[m];d.splice(m,1),m=this.afterSharedItem[w].canvas,this.beforeShredItems[w].canvas.getContext("2d").drawImage(e,x,p,v,g,x,p,v,g),m.getContext("2d").drawImage(n,x,p,v,g,x,p,v,g),l+=g}o+=v}}else!function(t){function e(t,e,r,a){if(null!=t){var s=t.position,o=t.size;t=Math.max(s[0]-1,0),s=Math.max(s[1]-1,0);var h=Math.min(o[0]+1,i)-t;o=Math.min(o[1]+1,n)-s;var c=r.canvas.getContext("2d"),u=a.canvas.getContext("2d");c.drawImage(S,t,s,h,o,t-e,s,h,o),u.drawImage(T,t,s,h,o,t-e,s,h,o)}}var i=t.canvasSource.width,n=t.canvasSource.height,r=.675*n,a=.125*n,s=.034*i,o=.018*i,c=(.02-.009)*i,u=.009*i,l=[];l.push({qB:void 0,Wn:void 0,Kw:void 0});for(var d=0,v=0,x=!0,f=0;f<i;f+=d){var g=0,p=0,m=l[v];if(x?(p=n,g=c*Math.random()+u):(p=r*Math.random()+a,g=s*Math.random()+o),0==v&&x){var w=J();j(w,f,0);var C=J();j(C,f+g,p)}if(f+g>i&&(g=i-f),!x&&f+g>=i){if(!(g>.5*s+o)){m.Kw=void 0,j(w=J(),m.Wn.x,0),j(C=J(),f+g,p),m.Wn.size.x+=g,m.Wn.size.y=n;continue}g=o}x?(j(w=J(),f,0),j(C=J(),f+g,p),m.Wn={position:w,size:C}):(j(w=J(),f,p),j(C=J(),f+g,n),m.Kw={position:w,size:C},l.push({qB:void 0,Wn:void 0,Kw:void 0}),d=l[++v],j(w=J(),f,0),j(C=J(),f+g,p),d.qB={position:w,size:C}),d=g,x=!x}var S=t.isRevert?t.currentImage:t.preImage,T=t.isRevert?t.preImage:t.currentImage;for(r=.5>Math.random()?-1:1,a=0;a<l.length;++a)c=.05+.05*Math.random(),u=Math.floor((200*Math.random()+50)*r),s=l[a],o=s.Wn.position[0],v=s.Wn.size[0],null!=s.qB&&(o=s.qB.position[0]),null!=s.Kw&&(v=s.Kw.size[0]),x=v-o,v=t.getShredItem(t.divBefore,x,n,c,u,r),c=t.getShredItem(t.divAfter,x,n,c,u,r),h(v.canvas,o,0),h(c.canvas,o,0),e(s.qB,o,v,c),e(s.Wn,o,v,c),e(s.Kw,o,v,c),t.beforeShredItems[a]=v,t.afterSharedItem[a]=c,r=-r}(this)}getShredDivContainer(t,e,i,n){var a=r(e,i);return s(a,"position","absolute"),g(t,a),n&&x(a,"preserve-3d"),a}getShredItem(t,e,i,r,a,o){var h=n(e,i);return s(h,"position","absolute"),g(t,h),new Wi(h,r,a,o)}setTransform(t){var e=this.isRevert,i=3==this.shredType||1==this.shredType;if(i&&!this.dI&&(!e&&.47<=t||e&&.47>=t)&&(this.dI=!0),0<=t&&.4>t){var n=H(0,0,.4,1);t=n(t)}else.6<=t&&1>t?t=(n=H(.6,1,1,0))(t):t=1;n=-this.length*t/2;var r=30*t*(this.dI?-1:1);i&&e&&(r=-r),f(this.divTransition,"translateZ("+n+"px) rotateY("+r+"deg) rotateX("+-15*t+"deg)")}setProgress(t){if(1!=(t=super.checkRevert(t))||!this.isRevert){this.setTransform(t);var e=2*this.length,i=this.isRevert,n=this.beforeShredItems;(i&&.47>=t||!i&&.47<=t)&&(n=this.afterSharedItem,this.sX||(this.sX=!0,s(this.divAfter,"visibility","visible"),s(this.divBefore,"visibility","hidden"))),i=n.length;for(var r=0;r<i;++r){var a=n[r],o=t;if(.4>o){var h=H(0,0,.4,1);o=h(o)}else.522<=o&&.922>o?o=(h=H(.522,1,.922,0))(o):o=.4<=o&&.522>o?1:0;if(o*=a.randomNumber,.401<=(h=t)&&.461>h){var c=H(.401,0,.461,1);h=c(h)}else.461<=h&&.521>h?h=(c=H(.461,1,.521,0))(h):h=0;f(a.canvas,"translateZ("+(h*e*a.direction+o)+"px)")}}}}function Wi(t,e,i,n){this.canvas=t,this.startTime=e,this.randomNumber=i,this.direction=n}class Ui extends w{opts=["VERTICALIN","VERTICALOUT","HORIZONTALIN","HORIZONTALOUT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.type=this.opts.indexOf(n.dir)}initialize(){var t=n(this.canvasSource.width,this.canvasSource.height);s(t,"position","absolute"),g(this.divContainer,t),t.getContext("2d").drawImage(this.preImage,0,0),this.canvasMain=n(this.canvasSource.width,this.canvasSource.height),g(this.divContainer,this.canvasMain)}setProgress(t){t=super.checkRevert(t);var e=0,i=0,n=0,r=0,a=0,s=0,o=0,h=0;switch(this.type){case Ki:i=(r=(this.canvasSource.height/2+200)*t)-200,h=(o=this.canvasSource.height-t*(this.canvasSource.height/2+200))+200;break;case Qi:r=(i=(this.canvasSource.height/2+200)*(1-t))-200,o=(h=this.canvasSource.height-(1-t)*(this.canvasSource.height/2+200))+200;break;case Yi:e=(n=(this.canvasSource.width/2+200)*t)-200,s=(a=this.canvasSource.width-t*(this.canvasSource.width/2+200))+200;break;case Zi:n=(e=(this.canvasSource.width/2+200)*(1-t))-200,a=(s=this.canvasSource.width-(1-t)*(this.canvasSource.width/2+200))+200}(t=this.canvasMain.getContext("2d")).clearRect(0,0,this.canvasSource.width,this.canvasSource.height),t.drawImage(this.currentImage,0,0),t.save(),t.globalCompositeOperation="destination-out",(e=t.createLinearGradient(e,i,n,r)).addColorStop(0,"rgba(255, 255, 255, 1)"),e.addColorStop(1,"rgba(255, 255, 255, 0)"),t.fillStyle=e,this.type==Yi||this.type==Zi?t.fillRect(0,0,this.canvasSource.width/2,this.canvasSource.height):t.fillRect(0,0,this.canvasSource.width,this.canvasSource.height/2),(a=t.createLinearGradient(a,o,s,h)).addColorStop(0,"rgba(255, 255, 255, 0)"),a.addColorStop(1,"rgba(255, 255, 255, 1)"),t.fillStyle=a,this.type==Yi||this.type==Zi?t.fillRect(this.canvasSource.width/2,0,this.canvasSource.width/2,this.canvasSource.height):t.fillRect(0,this.canvasSource.height/2,this.canvasSource.width,this.canvasSource.height/2),t.restore()}}var Yi=0,Zi=1,Ki=2,Qi=3;class Ji extends ct{direction;opts=["FROMRIGHT","FROMBOTTOM","FROMLEFT","FROMTOP"];constructor(t,e,i,r){let a="FROMRIGHT"==r.dir||"FROMLEFT"==r.dir?-1:1,s="FROMBOTTOM"==r.dir||"FROMTOP"==r.dir?-1:1,o=n(e.width,e.height),h=o.getContext("2d");h.translate(e.width/2,e.height/2),h.scale(a,s),h.translate(-e.width/2,-e.height/2),h.drawImage(e,0,0),super(t,i,o,r.revert),this.direction=this.opts.indexOf(r.dir)}initialize(){this.setupProgram(),this.createMatrices(),mat4.translate(this.m4PMVMatrix,[-this.canvasSource.width/2,this.canvasSource.height/2,0]),this.setupMatrices(),this.drawBackground()}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler1;\n\tuniform sampler2D uSampler2;\n\n\tvoid main(void)\n\t{\n\t\tvec3 n = normalize(vNormal);\n\t\tvec3 lightingDirection = vec3(0.0, 0.0, 1.0);\n\t\tfloat directionalLightWeighting = abs(dot(n, lightingDirection));\n\t\tfloat intentsity = 0.4 + 0.6 * directionalLightWeighting;\n\t\tvec4 textureColor;\n\t\tif(gl_FrontFacing)\n\t\t{\n\t\t\ttextureColor = texture2D(uSampler2, vTextureCoord);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttextureColor = texture2D(uSampler1, vTextureCoord);\n\t\t}\n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a);\n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\tattribute float aDelay;\n\tattribute float aMaxDistance;\n\n\tuniform mat4 uPMVMatrix;\n\n\tuniform mat3 uNMatrix;\n\n\tuniform float uPhase;\n\tuniform float uSlideHeight;\n\tuniform float uSlideWidth;\n\tuniform bool uHorizontal;\n\n\tconst float MAX_DELAY = 0.5;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tfloat linearInterpolation(float x, float x0, float fx0, float x1, float fx1)\n\t{\n\t\treturn mix(fx0, fx1, (x - x0) / (x1 - x0));\n\t}\n\tmat4 rotationXmatrix(float angle)\n\t{\n\t  float ang = radians(angle);\n\t  float cosA = cos(ang);\n\t  float sinA = sin(ang); \n\n\t  mat4 m; \n\t  m[0] = vec4(1, 0, 0, 0);\n\t  m[1] = vec4(0, cosA, sinA, 0);\n\t  m[2] = vec4(0, -sinA, cosA, 0);\n\t  m[3] = vec4(0, 0, 0, 1);\n\t  return m;\n\t}\n\tmat4 rotationYmatrix(float angle)\n\t{\n\t  float ang = radians(angle);\n\t  float cosA = cos(ang);\n\t  float sinA = sin(ang); \n\n\t  mat4 m; \n\t  m[0] = vec4(cosA, 0, -sinA, 0);\n\t  m[1] = vec4(0, 1, 0, 0);\n\t  m[2] = vec4(sinA, 0, cosA, 0);\n\t  m[3] = vec4(0, 0, 0, 1);\n\t  return m;\n\t}\n\tmat4 translationMatrix(float x, float y, float z)\n\t{\n\t  mat4 t = mat4(1.0);\n\t  t[3] = vec4(x, y, z, 1.0);\n\t  return t;\n\t}\n\n\tmat4 positionMatrix()\n\t{\n\t\tfloat endTime = linearInterpolation(aDelay, 0.0, 1.0 - MAX_DELAY, MAX_DELAY, 1.0);\n\t\tfloat pPhase = linearInterpolation(uPhase, aDelay, 0.0, endTime, 1.0);\n\t\tif (uPhase < aDelay)\n\t\t{\n\t\t\tpPhase = 0.0;\n\t\t}\n\t\telse if (uPhase > endTime)\n\t\t{\n\t\t\tpPhase = 1.0;\n\t\t}\n\t\tfloat z =  4.0 * aMaxDistance * pPhase * (pPhase - 1.0);\n\t\tfloat rotation = 180.0 * pPhase;\n\n\t\tmat4 m = mat4(1.0);\n\n\t\tvec3 pivotPoint = vec3(- uSlideWidth / 2.0, uSlideHeight / 2.0, 0.0);\n\t\tm = m * translationMatrix(-pivotPoint.x, -pivotPoint.y, -pivotPoint.z);\n\t\tif (uHorizontal)\n\t\t{\n\t\t   m = m * rotationYmatrix(rotation);//left right\n\t\t}\n\t\telse \n\t\t{\n\t\t\tm = m * rotationXmatrix(rotation);//top bottom\n\t\t}\n\t\tm = m * translationMatrix(pivotPoint.x, pivotPoint.y, pivotPoint.z);\n\t\tm = m * translationMatrix(0.0, 0.0, z);\n\n\t\treturn m;\n\t}\n\n\tvec3 getVertexPosition() \n\t{ \n\t\tmat4 m = positionMatrix();\n\t\tvec4 v = m * vec4(aVertexPosition, 1.0);\n\t\treturn v.xyz;\n\t} \n\tvec3 getNormal() \n\t{\n\t\tmat4 m = positionMatrix();\n\t\tvec4 v = m * vec4(0 ,0, 1, 0.0);\n\t\treturn v.xyz;\n\t}\n\tvoid main(void)\n\t{\n\t\tvTextureCoord = aTextureCoord;\n\n\t\tvec3 pos = getVertexPosition();\n\t\tvec3 n = getNormal();\n\t\tn = normalize(n);\n\t\tgl_Position = uPMVMatrix * vec4(pos, 1.0); \n\t\tvNormal = uNMatrix * n;\n\t}"}bufferData(){var t=this.canvasSource.width,e=this.canvasSource.height,i=t/50,n=e/45;this.container=new tn;for(var r=0;r<45;++r)for(var a=0;a<50;++a){var s=new $i(a*i,r*n,i,n,t,e,this.direction);this.container.arrayCurrentValue=this.container.arrayCurrentValue.concat(s.getArrayCurrentValue()),this.container.arrayNormal=this.container.arrayNormal.concat(s.getArrayNormal()),this.container.arrayPositions=this.container.arrayPositions.concat(s.getArrayPositions()),this.container.arrayRandom=this.container.arrayRandom.concat(s.getArrayRandom());for(var o=4*this.container.stepCount,h=s.getArrayIndecies(),c=0;c<h.length;++c)this.container.arrayIndecies.push(h[c]+o);this.container.stepCount++}var u=new I,l=T(this.webGLContext,this.container.arrayPositions,3);u.vertexPosition=l,l=T(this.webGLContext,this.container.arrayNormal,2),u.textureCoord=l,l=A(this.webGLContext,this.container.arrayIndecies),u.elementIndecies=l,this.bufferContainer=u,this.randomBuffer=T(this.webGLContext,this.container.arrayRandom,1),this.currentValueBuffer=T(this.webGLContext,this.container.arrayCurrentValue,1)}getProperties(){super.getProperties(),this.uSampler=S(this.webGLContext,this.shaderProgram,"uSampler1"),this.uSampler2=S(this.webGLContext,this.shaderProgram,"uSampler2"),this.uHorizontal=S(this.webGLContext,this.shaderProgram,"uHorizontal"),this.aDelay=C(this.webGLContext,this.shaderProgram,"aDelay"),this.aMaxDistance=C(this.webGLContext,this.shaderProgram,"aMaxDistance")}setupData(){this.webGLContext.uniform1f(this.uSlideWidth,this.canvasSource.width),this.webGLContext.uniform1f(this.uSlideHeight,this.canvasSource.height),this.webGLContext.uniform1f(this.uHorizontal,this.direction==ji||this.direction==qi?1:0)}drawBackground(){this.texture=super.drawBackground(this.currentImage,this.uSampler,this.webGLContext.TEXTURE0,0),this.texture2=super.drawBackground(this.preImage,this.uSampler2,this.webGLContext.TEXTURE1,1)}setProgress(t){t=super.checkRevert(t),this.webGLContext.bindBuffer(this.webGLContext.ARRAY_BUFFER,this.currentValueBuffer),this.webGLContext.vertexAttribPointer(this.aDelay,this.currentValueBuffer.size,this.webGLContext.FLOAT,!1,0,0),this.webGLContext.bindBuffer(this.webGLContext.ARRAY_BUFFER,this.randomBuffer),this.webGLContext.vertexAttribPointer(this.aMaxDistance,this.randomBuffer.size,this.webGLContext.FLOAT,!1,0,0),super.setProgress(t)}completed(){super.completed(),this.webGLContext.deleteBuffer(this.randomBuffer),this.webGLContext.deleteBuffer(this.currentValueBuffer),this.webGLContext.deleteTexture(this.texture2),b(this.webGLContext,this.aVertexPosition),b(this.webGLContext,this.aVertexPosition)}}var ji=0,qi=2;class $i{constructor(t,e,i,n,r,a,s){switch(this.x=t,this.y=e,this.z=0,this.width=i,this.height=n,this.containerWidth=r,this.containerHeight=a,this.direction=s,this.random=(.5<Math.random()?-1:1)*Math.random()*2*Math.max(r,a),s){case ji:this.currentValue=H(0,.5,r,0)(t);break;case 1:this.currentValue=H(0,.5,a,0)(e);break;case qi:this.currentValue=H(0,0,r,.5)(t);break;case 3:this.currentValue=H(0,0,a,.5)(e)}}getArrayIndecies(){return[0,1,3,0,3,2]}getArrayPositions(){var t=this.x,e=-this.y,i=this.z,n=this.width,r=-this.height;return[t,e,i,t+n,e,i,t,e+r,i,t+n,e+r,i]}getArrayNormal(){var t=this.x/this.containerWidth,e=this.y/this.containerHeight,i=this.width/this.containerWidth,n=this.height/this.containerHeight;return[t,e,t+i,e,t,e+n,t+i,e+n]}getArrayRandom(){return[this.random,this.random,this.random,this.random]}getArrayCurrentValue(){return[this.currentValue,this.currentValue,this.currentValue,this.currentValue]}}class tn{constructor(){this.stepCount=0,this.arrayPositions=[],this.arrayNormal=[],this.arrayRandom=[],this.arrayCurrentValue=[],this.arrayIndecies=[]}}class en extends Pi{constructor(t,e,i,n,r,a){super(t,e,i,a,!0,n,r)}}class nn extends pt{constructor(t,e,i,n,r,a){super(t,i,e,a,!0,n,r)}}class rn extends Jt{constructor(t,e,i,n,r,a){super(t,e,i,a,!0,n,r)}}class an extends he{opts=["VERTICAL","HORIZONTAL"];constructor(t,e,i,n,r,a){super(t,e,i,a,!0,n,r),this.direct=this.opts.indexOf(a.dir)}}class sn extends w{constructor(t,e,i,n){super(t,e,i,n.revert),this.Fe=!1}initialize(){this.Sf=document.createElement("div"),o(this.Sf,this.canvasSource.width,this.canvasSource.height),s(this.Sf,"backgroundColor","#000000"),s(this.Sf,"position","absolute"),g(this.divContainer,this.Sf),this.drawBackground()}drawBackground(){this.canvas=n(this.canvasSource.width,this.canvasSource.height),this.canvas.getContext("2d").drawImage(this.currentImage,0,0),g(this.divContainer,this.canvas)}setProgress(t){.8>t?(c(this.Sf,1),c(this.canvas,0)):(c(this.Sf,0),c(this.canvas,1))}}class on{duration;transition;#t;constructor(t,e,i){this.transition=t,this.duration=e,this.oncompleted=i}start(){this.transition&&(this.transition.initialize(),this.#t=performance.now(),this.#e(this))}end(){this.transition&&(this.transition.completed(),this.oncompleted&&this.oncompleted())}#e(t){var e=performance.now(),i=Math.min((e-t.#t)/t.duration,1);t.transition.setProgress(i),i<1?requestAnimationFrame((()=>t.#e(t))):t.end()}}class hn extends w{opts=["SMOOTHLYFROMLEFT","SMOOTHLYFROMRIGHT","THROUGHBACKFROMLEFT","THROUGHBACKFROMRIGHT"];constructor(t,e,i,n,r,a){super(t,e,i,a.revert),this.M=this.opts.indexOf(a.dir),this.Fe=!0,this.currentBackground=e,this.preBackground=i,this.foreground=n,this.preForeground=r}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;let i=n(t,e),r=n(t,e);i.getContext("2d").drawImage(this.currentImage,0,0),r.getContext("2d").drawImage(this.preImage,0,0),this.currentBackground=i,this.preBackground=r,g(this.divContainer,i),g(this.divContainer,r),this.xC=n(t,e),s(this.xC,"position","absolute"),g(this.divContainer,this.xC),this.UH=n(t,e),s(this.UH,"position","absolute"),g(this.divContainer,this.UH)}setProgress(t){var e=this.canvasSource.width,i=this.canvasSource.height,n=this.xC.getContext("2d"),r=e,a=i;n.clearRect(0,0,e,i);var s=.5>t?this.M==xn||this.M==vn?H(0,-e,.5,e):H(0,e,.5,-e):this.M==xn||this.M==vn?H(.5,e,1,-e):H(.5,-e,1,e);s=n.createLinearGradient(s(t),0,s(t)+e,0),this.M==xn||this.M==vn?(s.addColorStop(0,"rgba(0, 0, 0, 1)"),s.addColorStop(1,"rgba(0, 0, 0, 0)")):(s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(1,"rgba(0, 0, 0, 1)")),this.M==dn||this.M==vn?(c(this.preBackground,1-t),.5>t?this.preForeground&&n.drawImage(this.preForeground,0,0):n.drawImage(this.foreground,0,0),n.save(),n.globalCompositeOperation="destination-out",n.fillStyle=s,n.fillRect(0,0,r,a),n.restore()):(.5>t?(c(this.currentBackground,1),n.drawImage(this.preForeground,0,0)):(c(this.preBackground,0),n.drawImage(this.foreground,0,0)),(n=this.UH.getContext("2d")).clearRect(0,0,e,i),n.fillStyle=s,n.fillRect(0,0,r,a)),.5>t?(e=H(0,0,.5,cn),i=H(0,0,.5,un),n=H(0,1,.5,1+ln)):(e=H(.5,-cn,1,0),i=H(.5,un,1,0),n=H(.5,1+ln,1,1)),t="scale("+n(t)+") translate("+e(t)+"px,"+i(t)+"px)",f(this.xC,t)}}var cn=-30,un=-20,ln=.1,dn=0,vn=1,xn=2;class fn extends w{constructor(t,e,i,n,r,a){super(t,e,i,a.revert),this.M=a.dir,this.Fe=!0,this.currentBackground=e,this.preBackground=this.preImage,this.foreground=n,this.preForeground=r}initialize(){var t=this.canvasSource.width,e=this.canvasSource.height;let i=n(t,e);i.getContext("2d").drawImage(this.currentImage,0,0),this.currentBackground=i,i=n(t,e),i.getContext("2d").drawImage(this.preImage,0,0),this.preBackground=i,i=n(t,e),this.preForeground&&i.getContext("2d").drawImage(this.preForeground,0,0),this.preForeground=i,i=n(t,e),i.getContext("2d").drawImage(this.foreground,0,0),this.foreground=i,g(this.divContainer,this.currentBackground),g(this.divContainer,this.preBackground),g(this.divContainer,this.preForeground),g(this.divContainer,this.foreground)}setProgress(t){(t=super.checkRevert(t))<.01?(c(this.preBackground,1),c(this.preForeground,1),c(this.foreground,0),c(this.currentBackground,0)):t<.1?c(this.preForeground,0):t<.2?(c(this.preForeground,1),c(this.preBackground,0)):(c(this.preForeground,0),c(this.foreground,1-2*(.5-t)),c(this.currentBackground,1-2*(.5-t)))}}class gn extends ct{isLeft;uDirectionIsLeft;constructor(t,e,i,n){super(t,i,e,n.revert),this.isLeft=n.left,this.M=n.dir,this.qy=n.revert}ga(){return this.qy}setProgress(t){var e=(t=super.checkRevert(t))/(.5/(In.length-1)),i=Math.floor(e);if(e-=i,i>In.length-1&&(i=In.length-1,e=0),0!=e||this.ga()&&!this.T1){if(this.b2!=i){var n=i!=In.length-1?In[i+1]:null;this.c2=pn(this,In[i],!0),this.GT=null!=n?pn(this,n,!0):null}for(n=0;n<this.zf.length();n++){var r=this.zf.container[n],a=this.c2.container[n],s=null!=this.GT?this.GT.container[n]:null;mn(r,a.position.clone()),wn(r,a.normal.clone()),null!=s&&((a=new y(0,0,0)).X=r.position.x+(s.position.x-r.position.x)*e,a.Y=r.position.y+(s.position.y-r.position.y)*e,a.Z=r.position.z+(s.position.z-r.position.z)*e,mn(r,a),(a=new y(0,0,0)).X=r.normal.x+(s.normal.x-r.normal.x)*e,a.Y=r.normal.y+(s.normal.y-r.normal.y)*e,a.Z=r.normal.z+(s.normal.z-r.normal.z)*e,wn(r,a))}this.T1=!0,this.b2=i}.5<t&&(i=12*this.canvasSource.height,e=mat4.create(),mat4.identity(e),e[13]=Math.pow(t-.5,2)/2*i*-1,this.m4PMVMatrix=mat4.multiply(this.pA,e,this.m4PMVMatrix)),this.setupMatrices(),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLES,this.bufferSubPosition,this.bufferSubNormal)}bufferSubPosition(t){let e=new Float32Array(F(t.zf));t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,e)}bufferSubNormal(t){let e=new Float32Array(D(t.zf));t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,e)}initialize(){let t=this.canvasSource.width,e=this.canvasSource.height;var i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),this.setupMatrices(),this.drawBackground();var r=mat4.create();mat4.identity(r),r[0]=t/921.6,r[5]=e/518.4,this.m4PMVMatrix=mat4.multiply(this.m4PMVMatrix,r,this.m4PMVMatrix),this.pA=mat4.create(),mat4.set(this.m4PMVMatrix,this.pA)}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler;\n\n\tconst vec3 LIGHT_DIRECTION = vec3(0.0, 0.0, 1.0);\n\tconst float AMBIENT_INTENSITY = 0.4;\n\tconst float DIFFUSE_INTENSITY = 0.6;\n\n\tvoid main(void)\n\t{\n\t\tfloat diffuseFactor = dot(normalize(vNormal), LIGHT_DIRECTION);\n\t\tfloat intentsity = AMBIENT_INTENSITY + DIFFUSE_INTENSITY * abs(diffuseFactor);\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord); \n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a); \n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec3 aVertexNormal;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\n\tuniform mat3 uNMatrix;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tvoid main(void)\n\t{\n\t\tgl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0);\n\t\tvTextureCoord = aTextureCoord;\n\t\tvNormal = uNMatrix * normalize(aVertexNormal);\n\t}"}bufferData(){this.zf=pn(this,"/+8MAP/rSADoi0gA6I8MANFLSADRTwwAuitIALovDACi60gAou8MAIurSACLrwwAC6tIAAuvDAAi60gAIu8MADorSAA6LwwAUUtIAFFPDABoi0gAaI8MAH/rSAD/54QA6IeEANFHhAC6J4QAoueEAIunhAALp4QAIueEADonhABRR4QAaIeEAH/nhAD/48AA6IPAANFDwAC6I8AAouPAAIujwAALo8AAIuPAADojwABRQ8AAaIPAAH/jwAD/4AAA6IAAANFAAAC6IAAAouAAAIugAAALoAAAIuAAADogAABRQAAAaIAAAH/gAAD/88AA6JPAANFTwAC6M8AAovPAAIuzwAALs8AAIvPAADozwABRU8AAaJPAAH/zwAD/94QA6JeEANFXhAC6N4QAoveEAIu3hAALt4QAIveEADo3hABRV4QAaJeEAH/3hAD/+0gA6JtIANFbSAC6O0gAovtIAIu7SAALu0gAIvtIADo7SABRW0gAaJtIAH/7SAD//wwA6J8MANFfDAC6PwwAov8MAIu/DAALvwwAIv8MADo/DABRXwwAaJ8MAH//DAB/7wwA",!1),this.bufferContainer=new I;var t=T(this.webGLContext,F(this.zf),3);this.bufferContainer.vertexPosition=t,t=T(this.webGLContext,G(this.zf),2),this.bufferContainer.textureCoord=t,t=A(this.webGLContext,An),this.bufferContainer.elementIndecies=t,t=T(this.webGLContext,D(this.zf),3),this.bufferContainer.vertexNormal=t}Zi(t,e,i){return 3*(t+4*e+16*i)}cI(t){for(var e=0;e<t.length;e++){var i=t[e];i.n=it(i.Hq.position.remove(i.gx.position),i.Hq.position.remove(i.hx.position)),i.n.normalize()}}completed(){super.completed()}}function pn(t,e,i){var n=function(t){var e=[];return function(t,e){function i(e){for(;n<t.length;){var i=t.charAt(n++),r=Sn[i];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(i))throw Error("Unknown base64 encoding at char: "+i)}return e}!function(){if(!Cn){Cn={},Sn={};for(var t=0;65>t;t++)Cn[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Sn[Cn[t]]=t,62<=t&&(Sn["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var n=0;;){var r=i(-1),a=i(0),s=i(64),o=i(64);if(64===o&&-1===r)break;e(r<<2|a>>4),64!=s&&(e(a<<4&240|s>>2),64!=o&&e(s<<6&192|o))}}(t,(function(t){e.push(t)})),e}(e);e=new E;var r,a=[];for(r=0;r<n.length;r+=4){var s=0;s|=n[r+0]<<24,s|=n[r+1]<<16,s|=n[r+2]<<8,s|=n[r+3],s>>>=0,a.push(new y(Tn((0==(s>>31&1)?1:-1)*((2145386496&s)>>21),460.8,11),Tn((0==(s>>20&1)?1:-1)*((1047552&s)>>10),275.3,11),Tn((0==(s>>9&1)?1:-1)*(511&s),211.2,10)))}for(r=0;r<a.length;r++)n=i?0:(a[r].x+460.8)/921.6,s=i?0:(a[r].y+259.2)/518.4,R(e,new L(new y(a[r].x,-1*a[r].y,-1*a[r].z),new M(n,s),new y(0,0,0)));for(i=[],r=0;r<An.length;r+=3)i.push(new ht(e.container[An[r]],e.container[An[r+1]],e.container[An[r+2]]));for(t.cI(i),r=0;r<i.length;r++)wn((t=i[r]).Hq,t.Hq.normal.add(t.n)),wn(t.gx,t.gx.normal.add(t.n)),wn(t.hx,t.hx.normal.add(t.n));return e}function mn(t,e){t.position=e.clone()}function wn(t,e){t.normal=e.clone()}var Cn=null,Sn=null;function Tn(t,e,i){return t/((Math.pow(2,i-1)-1)/Math.round(10*e))/10}var An=[0,1,2,3,2,4,5,4,6,7,6,8,9,8,10,11,10,12,13,12,14,15,14,16,17,16,18,19,18,20,21,20,22,1,23,24,2,24,25,4,25,26,6,26,27,8,27,28,10,28,29,12,29,30,14,30,31,16,31,32,18,32,33,20,33,34,23,35,36,24,36,37,25,37,38,26,38,39,27,39,40,28,40,41,29,41,42,30,42,43,31,43,44,32,44,45,33,45,46,35,47,48,36,48,49,37,49,50,38,50,51,39,51,52,40,52,53,41,53,54,42,54,55,43,55,56,44,56,57,45,57,58,47,59,60,48,60,61,49,61,62,50,62,63,51,63,64,52,64,65,53,65,66,54,66,67,55,67,68,56,68,69,57,69,70,59,71,72,60,72,73,61,73,74,62,74,75,63,75,76,64,76,77,65,77,78,66,78,79,67,79,80,68,80,81,69,81,82,71,83,84,72,84,85,73,85,86,74,86,87,75,87,88,76,88,89,77,89,90,78,90,91,79,91,92,80,92,93,81,93,94,83,95,96,84,96,97,85,97,98,86,98,99,87,99,100,88,100,101,89,101,102,90,102,103,91,103,104,92,104,105,93,105,106,0,2,3,3,4,5,5,6,7,7,8,9,9,10,11,11,12,13,13,14,15,15,16,17,17,18,19,19,20,21,21,22,107,1,24,2,2,25,4,4,26,6,6,27,8,8,28,10,10,29,12,12,30,14,14,31,16,16,32,18,18,33,20,20,34,22,23,36,24,24,37,25,25,38,26,26,39,27,27,40,28,28,41,29,29,42,30,30,43,31,31,44,32,32,45,33,33,46,34,35,48,36,36,49,37,37,50,38,38,51,39,39,52,40,40,53,41,41,54,42,42,55,43,43,56,44,44,57,45,45,58,46,47,60,48,48,61,49,49,62,50,50,63,51,51,64,52,52,65,53,53,66,54,54,67,55,55,68,56,56,69,57,57,70,58,59,72,60,60,73,61,61,74,62,62,75,63,63,76,64,64,77,65,65,78,66,66,79,67,67,80,68,68,81,69,69,82,70,71,84,72,72,85,73,73,86,74,74,87,75,75,88,76,76,89,77,77,90,78,78,91,79,79,92,80,80,93,81,81,94,82,83,96,84,84,97,85,85,98,86,86,99,87,87,100,88,88,101,89,89,102,90,90,103,91,91,104,92,92,105,93,93,106,94],In="/+8MAP/rSADoi0gA6I8MANFLSADRTwwAuitIALovDACi60gAou8MAIurSACLrwwAC6tIAAuvDAAi60gAIu8MADorSAA6LwwAUUtIAFFPDABoi0gAaI8MAH/rSAD/54QA6IeEANFHhAC6J4QAoueEAIunhAALp4QAIueEADonhABRR4QAaIeEAH/nhAD/48AA6IPAANFDwAC6I8AAouPAAIujwAALo8AAIuPAADojwABRQ8AAaIPAAH/jwAD/4AAA6IAAANFAAAC6IAAAouAAAIugAAALoAAAIuAAADogAABRQAAAaIAAAH/gAAD/88AA6JPAANFTwAC6M8AAovPAAIuzwAALs8AAIvPAADozwABRU8AAaJPAAH/zwAD/94QA6JeEANFXhAC6N4QAoveEAIu3hAALt4QAIveEADo3hABRV4QAaJeEAH/3hAD/+0gA6JtIANFbSAC6O0gAovtIAIu7SAALu0gAIvtIADo7SABRW0gAaJtIAH/7SAD//wwA6J8MANFfDAC6PwwAov8MAIu/DAALvwwAIv8MADo/DABRXwwAaJ8MAH//DAB/7wwA 8u/+EviMJALjCzwa4S7kSs1rNAHNrw4Gt0s8DLfPDAyhC0wLoa8UC4qrWAuLbyALC6tgCwrvIAsiK1gLIS8QCziLPAs3LuwNTqsQDEzOvgJkiugHYU5gLXpLHAn8aCwJ5WeUC85nZAm3p2gLoQd4C4pnjAsMJ5wLIsecCzlnhAtQB2QLZodIC31HbAv+JDQL5yPgC8/DrAu4o5wLoaOoC4rDwAsMA9ALIuPcCznD0AtQo7QLZ4OUC36DnAv+oEQL56AkC9CQBAu5cBwLonAcC4twDAsLgAQLIoAUCzmAGAtQoAALZ9AoC37QSAv+k5wL55OYC9CzuAu5s9QLotPgC4vz2AsK88QLIdOwCzjTqAtP87QLZzPoC340PAv9N3AL5pdMC8/3aAu5V4gLorecC4v3oAsKt5QLIXeACjgXdA1Ot3AGZZecC3x4PAn6WxwK5HrsB86bFAu4ezwLohtYC4ubZAsK+1wLIZtQCjf7SA9OGz4KY3tEJnh8NAD1frIJ4V5gMMz+wgO3PvANoT8UC4rfJAsLvyQLIj8YCji/DBBPHv4TYb7EY3K/+ht1TrII 4w9GCOysIArfCtim3S6MudHrDgHSzswEu8soObxO6DWk6ywqpU7sKo3rJCyOLuQsCOsYKwjO2C4gCxAuH87IHjcrCBo17oBVTEqAbUsNlBBcKKoNWcrMc3JJkhHziKAA4gc4g9DHUgO653A7pAdwKI1HZCwJZ1gsICdQKzcnTC5OR0QcYyaManbmFAf5JNAP48P0Pc6DrgG5A8A4ooPAKYwjrCwKQ5wsIMOQLDdjkCtOQ4QuZONIHXrCuED6QPAl5ABcKs1gIC+3ABQuoMAQLIqAACsL0BgsIjAoKjhQKDBOcCwtZRBgKnsxBCP58sw849NQIM0zkC22U6Arn7OsLIkzuCsNc8wtJBPUJDqTzEJP07ILZFP0S3k05Ar2tjgI4na0Y80XTB+2F1wtnzdoLIhXeCsOd4QtJVeMJTv3hEBRd2YGYhdQhHNYrADyOb4D3BjqEsvaqGi2OxgenxsoLYf7OCsO+0gsJftMJzz7QD5SuyIFXzr0pWy8LAjlnEIq2LrgccqdzA61XqRRnv7kIYf++C0PPwgsJl8MKD1/BDlTnuQAXN6ouGRffgNlrCov 1W44NeArWEHX6ij31I3c/9EqMDXSDfQ1u+pkhL0OMH+larxUpm6IWo5rFGWPTtxiCItYYAgPJGQfi4RpH49AXTYrSEYzDbi6RmkgtkSr5E1R5mgxVMj8n2eGlg3lB+Qp3WaQ4dCGcDe65pyBpGbwUY1nSGkJh5BhIGfIWjaH2I9KZug7WuS8qmoDBCHoJGAH4kL4wdBCtD66AtB1oyMoVYwDhGUK48xkIcQIZTikZEtNg/ycX+MEKm/gZIPwYToG5BC0lM1QvG63EIwxoVB0g4qQNFoMYBhPIwBMfjoApFpRIPw+ZcCQm3CRigbvMMCB3xNMJcx0XJe2lFxNn9QgZYjz6GAOM5RvJRNITDuzCH1RktQzYTMAxmfUiA/ps3Qf2dUIpcmXQDa09/SBnnfgXYe3qF4PV1xuJhcUSzx20IJR1qAyXTao4mQ38Cvm9woM0RbELcU5YLO0m4BFndukaIbbdF8QWyhpJzrcTT1alIdSemQzWLpM9l/baD3XmOon01lAn8L8IEqxnfi4nb9gXoY/PGMRHvRlKD6oVT5+WIZTPiQ0VT4FAFcelDlX6GIn x+00d9EKJG7PSWU3xSyFPMtpOHHFjOBru2jdC7yMmSipaeCPrC2knZLKzLmU7pCtBCuIoALvQKwZy6TqGm9IyjALKLUsrT0xP+iBFj5rpMFJBjh1UklElFhE1hjXJtBW1uYRI8yFbHS6BTzrpiYkhZBHCMEGh9iqHWh4mzDn6QlBZmiUV6VYyVyh4EDOo7Be3UKxB80BkIq4QZDKowJgiY1DQMEJBCSgH2TgzjXFTJ1I5Bj8VeKgYWLwdK3eQrQz3JC0ysZxGPS00bB1n9EwwYnwbJ8MAGiUISEM0jahfJpMwbCBXwBE0l4yxC7iICym0VJwYsg09Pu0NWSdnbT0xYb0JKgPkzTAJbJYjzpxzOZNEiR0WTKtGE8zxFrYMchC05UI1cC3GIevWFT6m1iEkoRX1KISdvzGKFYkhTtViPdMFdhyVRY5K1d27GLYFQoNyDbAc7041Q+uW6yrl9vY1oG7hJ8VGsDDKxngiTxZLQ9LWZRwTnm5OFD6PG/HtnAP0Pnwhby8FL+qPZkpl5+MxQAfRK0XfoC0Lh2cjT0c5SZEvSxlRBzZN0e9QG9IhZAt sGuEisDqQKa6x8lHsKrJTbYHAImvKmSDsccRV6zq0VOqJyCVq8sEgZyIrTejrEU2iCrlDI3uHUoKqw2QCM5xUB5quSIaa+2sMahtZyyLoSY4RqC1PgokqEPFNBO/ptxswyTRKLhjZIi1wzlSpkNYtJUFQSuCJ2zaEIhlPSXoLYAxpqjcR+Vk8EoCIF27gzRlziKU576wGI+0MMFCoXAQ7Y0h4SQFhBTTFKThZChl2QQ9ZL0zRIK0hFKQZMLL4mgzzhD8wrqxiSSmMhzalnHBX4ew2L8MwMi7G6FZVzEC+U8+AuClTyBQ5EvzIF3SUBiawVMMfLz1SS2nddDrknWVTYEUJNMSEekkJzA87jhQnWY7MMSaRdHJQzuzxJnFslRWxxV477OXyNajGA1lj3jQ/QZXdNYZNVkwKrO4tDXUhWY4NGCaPtUhUkcWkJ/HdeQjuXd4s7NZeWCee0kgiLrlbgta3QIgGM06LVd4lC54FVw2GASVOjihWT852KG5lhyHuZr8gKqcPReZfCWphz6BSg++QTclfHUoK1swbyf7oUMuO0yELNsxVjCcBJM4xXiO qubgL7knVJmqRcEtryjU3p7jgJeiZsBOpmVhTKvoTQSX5Eypm6e0cKIleVupSNEOjwgBQ5kK8SyCiRHTh8spWhCqEWAHaP3fIidZiBdKPVsnBmjAJQocuDZmoCipJVSmtQMFQq0A+JGxonVOn2DIz5diZY2GBVlQAsVt/hbG8a4f5gTzN4XE9j4DaFKrQrBXwCK0wrhx2LuvkOGDnbHdMYmgCXcCAxkKC0IF1BjEHVovhck9NkPIfkPgULS6wogPwRDkmrVxkVOhMpk4kJGNoIeQKNwMQJDEFwBxdyjjFZEtZBy9P2FM4znyaG3EkBxTsxL8YrMU3SCd9a0VipU9lwFTdO8RMNFZJGHtEjKQYYYvAMi0NzAlZS4TTNW7U1QiurTg4aaXKOibNs2gh1jBWApWmP4cE9VKItFIqCazjWInkfCnL1OFXz7T8LC1tuQGrldww6XXLYOSub1nAFip3RN2fYgktt0MJZSEXCjWzRgsFOxiMlbVGjEVFGCvNdiSoVm8lZn55VuKeMnmBrr5aRmZqWIgGbi3H5eUDyW5/Mkn+BAbKdng4TF4sCcpZXiK".split(" ");class Pn extends ct{isLeft;uDirectionIsLeft;opts=["RIGHT","LEFT"];constructor(t,e,i,n){super(t,i,e,n.revert),this.isLeft=this.opts.indexOf(n.dir),this.M=this.opts.indexOf(n.dir)}setProgress(t){t=super.checkRevert(t),this.webGLContext.uniform1f(this.uPhase,t),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLE_STRIP),function(t,e){var i=H(.1,0,.4,1),n=H(.2,0,.9,1),r=H(.4,0,.6,1),a=H(.6,0,1,1),s=mat4.create(),o=Math.min(1,Math.max(0,i(e))),h=t.canvasSource.width,c=t.canvasSource.height;i=0==t.M?3:0;var u=0==t.M?-1:1;mat4.identity(s),mat4.translate(s,[.02*u*h*Math.sin(2*Math.PI*o),0,0]),yn(t,i,0,s),mat4.identity(s),mat4.translate(s,[.015*u*h*Math.sin(4*Math.PI*o),0,0]),yn(t,i,2,s),mat4.identity(s),mat4.translate(s,[.2*u*h*Math.max(0,o-.1),0,-.2*c*Math.max(0,o-.1)]),yn(t,i,3,s),n=Math.min(1,Math.max(0,n(e))),i=0==t.M?1:2,u=0==t.M?1:-1,mat4.identity(s),mat4.translate(s,[.5*u*h*n,0,.5*c*n]),yn(t,i,2,s),yn(t,i,1,s),yn(t,i,0,s),.4<=e&&.6>e&&Fn(t,r,0,.2*c,e),.6<=e&&Fn(t,a,.2*c,-.7*c,e),mat4.identity(s),mat4.translate(s,[0,0,-.3*c*Math.sin(1.5*Math.PI*n)]),i=0==t.M?0:3,yn(t,i,0,s)}(this,t),function(t,e){let i=t.canvasSource.width;for(var n=0;n<t.zf.length();n++){var r=t.zf.container[n],a=0==t.M?r.position.x>.2*i?Ln(t,r,e):0:r.position.x<.8*i?Ln(t,r,e):0;r=t.Np.container[n],a=new y(0,0,a);for(var s,o=t,h=t.aY[n],c=new y(0,0,0),u=0;4>u;u++){for(var l=new y(0,0,0),d=0;4>d;d++){for(var v=new y(0,0,0),x=0;2>x;x++){var f=o.Zi(u,d,x);s=h[2][x],En(v,new y(o.Dg[f+0]*s,o.Dg[f+1]*s,o.Dg[f+2]*s))}s=h[1][d],En(l,new y(v.x*s,v.y*s,v.z*s))}s=h[0][u],En(c,new y(l.x*s,l.y*s,l.z*s))}Rn(r,c.add(a))}for(t.cI(),e=0;e<t.yA.length;e++)Nn((n=t.yA[e]).Hq,n.Hq.normal.add(n.n)),Nn(n.gx,n.gx.normal.add(n.n)),Nn(n.hx,n.hx.normal.add(n.n))}(this,t),function(t,e){let i=t.canvasSource.width,n=t.canvasSource.height;var r=H(.3,0,.9,1),a=H(.05,0,.3,1);mat4.set(t.pA,t.m4PMVMatrix),r=Math.min(1,Math.max(0,r(e))),mat4.translate(t.m4PMVMatrix,[(0==t.M?1:-1)*i*Math.pow(r,2),.7*n*Math.pow(r,2),0]),e=Math.min(1,Math.max(0,a(e))),mat4.translate(t.m4PMVMatrix,[0,-1*e*n*-.02,0])}(this,t),this.setupMatrices(),this.drawTransition(this.bufferContainer,this.webGLContext.TRIANGLES,this.bufferSubPosition,this.bufferSubNormal)}bufferSubPosition(t){let e=new Float32Array(F(t.Np));t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,e)}bufferSubNormal(t){let e=new Float32Array(D(t.Np));t.webGLContext.bufferSubData(t.webGLContext.ARRAY_BUFFER,0,e)}initialize(){let t=this.canvasSource.width,e=this.canvasSource.height;var i=n(t,e);s(i,"position","absolute"),g(this.divContainer,i),i.getContext("2d").drawImage(this.preImage,0,0),this.setupProgram(),this.createMatrices(),this.setupMatrices(),this.drawBackground(),mat4.translate(this.m4PMVMatrix,[-t/2,e/2,0]),this.pA=mat4.create(),mat4.set(this.m4PMVMatrix,this.pA)}getFragmentCode(){return"precision mediump float;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tuniform sampler2D uSampler;\n\n\tconst vec3 LIGHT_DIRECTION = vec3(0.0, 0.0, 1.0);\n\tconst float AMBIENT_INTENSITY = 0.4;\n\tconst float DIFFUSE_INTENSITY = 0.6;\n\n\tvoid main(void)\n\t{\n\t\tfloat diffuseFactor = dot(normalize(vNormal), LIGHT_DIRECTION);\n\t\tfloat intentsity = AMBIENT_INTENSITY + DIFFUSE_INTENSITY * diffuseFactor * diffuseFactor;\n\t\tvec4 textureColor = texture2D(uSampler, vTextureCoord);\n\t\tgl_FragColor = vec4(textureColor.rgb * intentsity, textureColor.a);\n\t}"}getVertexCode(){return"attribute vec3 aVertexPosition;\n\tattribute vec3 aVertexNormal;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uPMVMatrix;\n\n\tuniform mat3 uNMatrix;\n\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tvoid main(void)\n\t{\n\t\tgl_Position = uPMVMatrix * vec4(aVertexPosition, 1.0);\n\t\tvTextureCoord = aTextureCoord;\n\t\tvNormal = uNMatrix * normalize(aVertexNormal);\n\t}"}bufferData(){let t=this.canvasSource.width,e=this.canvasSource.height;this.zf=_(20,20,t,e);for(var i=0==this.dir?function(t,e){for(var i=[],n=0;n<t-1;++n)for(var r=0;r<e;++r)i.push(r+(n+1)*e),i.push(r+n*e),r==e-1&&n!=t-2&&(i.push(r+n*e),i.push((n+2)*e));return i}(20,20):B(20,20),n=[],r=0,a=i.length;r+2<a;){var s=i[r++];if(!(0>s)){var o=i[r++];if(!(0>o))for(var h=!0;r<a;){var c=i[r++];if(0>c)break;s!=o&&s!=c&&o!=c&&n.push(s,o,c),h?s=c:o=c,h=!h}}}for(this.Zd=n,this.Np=new E,i=0;i<this.zf.length();i++)R(this.Np,this.zf.container[i].clone());for(this.yA=[],i=0;i<this.Zd.length;i+=3)this.yA.push(new bn(this.Np.container[this.Zd[i]],this.Np.container[this.Zd[i+1]],this.Np.container[this.Zd[i+2]]));this.bufferContainer=new I,i=T(this.webGLContext,F(this.zf),3),this.bufferContainer.vertexPosition=i,i=T(this.webGLContext,D(this.zf),3),this.bufferContainer.vertexNormal=i,i=T(this.webGLContext,G(this.zf),2),this.bufferContainer.textureCoord=i,i=A(this.webGLContext,this.Zd),this.bufferContainer.elementIndecies=i,i=[0,-1*e,0],n=[t,0,1e-11],this.xH=Q(K(),n[0]-i[0],0,0),this.yH=Q(K(),0,n[1]-i[1],0),this.zH=Q(K(),0,0,n[2]-i[2]),this.aY=[],r=et(this.yH,this.zH,K()),a=et(this.xH,this.zH,K()),s=et(this.xH,this.yH,K()),o=$(r,this.xH),h=$(a,this.yH),c=$(s,this.zH);for(var u=0;u<this.zf.length();u++){var l=this.zf.container[u],d=Q(K(),l.position.x,l.position.y,l.position.z);q(d,Q(K(),i[0],i[1],i[2]),d),l=$(r,tt(d,1/o));var v=$(a,tt(d,1/h));d=$(s,tt(d,1/c));var x=[];x.push([],[],[]);for(var f=0;4>f;f++)x[0].push(Mn(3,f,l));for(f=0;4>f;f++)x[1].push(Mn(3,f,v));for(f=0;2>f;f++)x[2].push(Mn(1,f,d));this.aY.push(x)}for(this.Dg=[],r=0;4>r;r++)for(a=0;4>a;a++)for(s=0;2>s;s++)o=this.Zi(r,a,s),h=a,c=s,(u=[0,0,0])[0]=i[0]+r/3*(n[0]-i[0]),u[1]=i[1]+h/3*(n[1]-i[1]),u[2]=i[2]+c/1*(n[2]-i[2]),h=u,this.Dg[o]=h[0],this.Dg[o+1]=h[1],this.Dg[o+2]=h[2];this.uz={}}Zi(t,e,i){return 3*(t+4*e+16*i)}cI(){for(var t=0;t<this.yA.length;t++){var e=this.yA[t];e.n=it(e.Hq.position.remove(e.gx.position),e.Hq.position.remove(e.hx.position)),e.n.normalize()}}completed(){super.completed()}}function bn(t,e,i){var n=new y(0,0,0);this.Hq=t,this.gx=e,this.hx=i,this.n=n}function Mn(t,e,i){for(var n=1,r=1;r<=e;r++)n*=(t-(e-r))/r;return n*Math.pow(i,e)*Math.pow(1-i,t-e)}function yn(t,e,i,n){var r=t.Zi(e,i,0),a=e.toString()+i.toString();if(function(t){return void 0!==t}(t.uz[a]))var s=[t.uz[a][0],t.uz[a][1],t.uz[a][2]];else s=[t.Dg[r+0],t.Dg[r+1],t.Dg[r+2]],t.uz[a]=[s[0],s[1],s[2]];mat4.multiplyVec3(n,s,s),t.Dg[r+0]=s[0],t.Dg[r+1]=s[1],t.Dg[r+2]=s[2],r=t.Zi(e,i,1),t.Dg[r+0]=s[0],t.Dg[r+1]=s[1],t.Dg[r+2]=s[2]}function Ln(t,e,i){let n=t.canvasSource.width,r=t.canvasSource.height;var a=Math.sqrt(n*n+r*r),s=0==t.M?new y(n,r,0):new y(-n,r,0);return s.normalize(),a=2*Math.PI/(.25*a),s.x*=a,s.y*=a,s.z*=a,a=e.position.x/n,0!=t.M&&(a=1-a),t=25*a,e=e.position,a=10*Math.PI,t*Math.cos(function(t,e){return t=Q(Z(),t.x,t.y,t.z),e=Q(Z(),e.x,e.y,e.z),$(t,e)}(s,e)-a*i)}function En(t,e){t.x+=e.x,t.y+=e.y,t.z+=e.z}function Rn(t,e){t.position=e.clone()}function Nn(t,e){t.normal=e.clone()}function Fn(t,e,i,n,r){var a=mat4.create();e=Math.min(1,Math.max(0,e(r))),i=H(0,i,1,n),mat4.identity(a),mat4.translate(a,[0,0,i(e)]),yn(t,0==t.M?0:3,0,a)}return e})()));